2025-04-18 19:31:03,592 - root - INFO - Logger initialized with level: INFO. Logging to console and file: D:\cursor开发工程\BI\logs\app.log
2025-04-18 19:31:03,594 - root - INFO - Starting sync process with type: incremental
2025-04-18 19:31:03,594 - root - INFO - Starting Xiaoe incremental order sync...
2025-04-18 19:31:05,852 - root - ERROR - Failed to get last sync timestamp for xiaoe/order/incremental: (pymysql.err.OperationalError) (2003, "Can't connect to MySQL server on '47.120.36.202' ([WinError 10061] 由于目标计算机积极拒绝，无法连接。)")
(Background on this error at: https://sqlalche.me/e/14/e3q8)
Traceback (most recent call last):
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python312\Lib\site-packages\pymysql\connections.py", line 644, in connect
    sock = socket.create_connection(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python312\Lib\socket.py", line 865, in create_connection
    raise exceptions[0]
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python312\Lib\socket.py", line 850, in create_connection
    sock.connect(sa)
ConnectionRefusedError: [WinError 10061] 由于目标计算机积极拒绝，无法连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python312\Lib\site-packages\sqlalchemy\engine\base.py", line 3371, in _wrap_pool_connect
    return fn()
           ^^^^
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python312\Lib\site-packages\sqlalchemy\pool\base.py", line 327, in connect
    return _ConnectionFairy._checkout(self)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python312\Lib\site-packages\sqlalchemy\pool\base.py", line 894, in _checkout
    fairy = _ConnectionRecord.checkout(pool)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python312\Lib\site-packages\sqlalchemy\pool\base.py", line 493, in checkout
    rec = pool._do_get()
          ^^^^^^^^^^^^^^
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python312\Lib\site-packages\sqlalchemy\pool\impl.py", line 145, in _do_get
    with util.safe_reraise():
         ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python312\Lib\site-packages\sqlalchemy\util\langhelpers.py", line 70, in __exit__
    compat.raise_(
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python312\Lib\site-packages\sqlalchemy\util\compat.py", line 211, in raise_
    raise exception
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python312\Lib\site-packages\sqlalchemy\pool\impl.py", line 143, in _do_get
    return self._create_connection()
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python312\Lib\site-packages\sqlalchemy\pool\base.py", line 273, in _create_connection
    return _ConnectionRecord(self)
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python312\Lib\site-packages\sqlalchemy\pool\base.py", line 388, in __init__
    self.__connect()
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python312\Lib\site-packages\sqlalchemy\pool\base.py", line 690, in __connect
    with util.safe_reraise():
         ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python312\Lib\site-packages\sqlalchemy\util\langhelpers.py", line 70, in __exit__
    compat.raise_(
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python312\Lib\site-packages\sqlalchemy\util\compat.py", line 211, in raise_
    raise exception
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python312\Lib\site-packages\sqlalchemy\pool\base.py", line 686, in __connect
    self.dbapi_connection = connection = pool._invoke_creator(self)
                                         ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python312\Lib\site-packages\sqlalchemy\engine\create.py", line 574, in connect
    return dialect.connect(*cargs, **cparams)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python312\Lib\site-packages\sqlalchemy\engine\default.py", line 598, in connect
    return self.dbapi.connect(*cargs, **cparams)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python312\Lib\site-packages\pymysql\connections.py", line 358, in __init__
    self.connect()
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python312\Lib\site-packages\pymysql\connections.py", line 711, in connect
    raise exc
pymysql.err.OperationalError: (2003, "Can't connect to MySQL server on '47.120.36.202' ([WinError 10061] 由于目标计算机积极拒绝，无法连接。)")

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "D:\cursor开发工程\BI\scripts\sync_xiaoe.py", line 71, in get_last_sync_timestamp
    ).order_by(SyncStatus.last_sync_timestamp.desc()).first()
                                                      ^^^^^^^
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python312\Lib\site-packages\sqlalchemy\orm\query.py", line 2824, in first
    return self.limit(1)._iter().first()
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python312\Lib\site-packages\sqlalchemy\orm\query.py", line 2916, in _iter
    result = self.session.execute(
             ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python312\Lib\site-packages\sqlalchemy\orm\session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python312\Lib\site-packages\sqlalchemy\orm\session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python312\Lib\site-packages\sqlalchemy\orm\session.py", line 750, in _connection_for_bind
    conn = bind.connect()
           ^^^^^^^^^^^^^^
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python312\Lib\site-packages\sqlalchemy\engine\base.py", line 3325, in connect
    return self._connection_cls(self, close_with_result=close_with_result)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python312\Lib\site-packages\sqlalchemy\engine\base.py", line 96, in __init__
    else engine.raw_connection()
         ^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python312\Lib\site-packages\sqlalchemy\engine\base.py", line 3404, in raw_connection
    return self._wrap_pool_connect(self.pool.connect, _connection)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python312\Lib\site-packages\sqlalchemy\engine\base.py", line 3374, in _wrap_pool_connect
    Connection._handle_dbapi_exception_noconnection(
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python312\Lib\site-packages\sqlalchemy\engine\base.py", line 2208, in _handle_dbapi_exception_noconnection
    util.raise_(
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python312\Lib\site-packages\sqlalchemy\util\compat.py", line 211, in raise_
    raise exception
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python312\Lib\site-packages\sqlalchemy\engine\base.py", line 3371, in _wrap_pool_connect
    return fn()
           ^^^^
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python312\Lib\site-packages\sqlalchemy\pool\base.py", line 327, in connect
    return _ConnectionFairy._checkout(self)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python312\Lib\site-packages\sqlalchemy\pool\base.py", line 894, in _checkout
    fairy = _ConnectionRecord.checkout(pool)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python312\Lib\site-packages\sqlalchemy\pool\base.py", line 493, in checkout
    rec = pool._do_get()
          ^^^^^^^^^^^^^^
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python312\Lib\site-packages\sqlalchemy\pool\impl.py", line 145, in _do_get
    with util.safe_reraise():
         ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python312\Lib\site-packages\sqlalchemy\util\langhelpers.py", line 70, in __exit__
    compat.raise_(
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python312\Lib\site-packages\sqlalchemy\util\compat.py", line 211, in raise_
    raise exception
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python312\Lib\site-packages\sqlalchemy\pool\impl.py", line 143, in _do_get
    return self._create_connection()
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python312\Lib\site-packages\sqlalchemy\pool\base.py", line 273, in _create_connection
    return _ConnectionRecord(self)
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python312\Lib\site-packages\sqlalchemy\pool\base.py", line 388, in __init__
    self.__connect()
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python312\Lib\site-packages\sqlalchemy\pool\base.py", line 690, in __connect
    with util.safe_reraise():
         ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python312\Lib\site-packages\sqlalchemy\util\langhelpers.py", line 70, in __exit__
    compat.raise_(
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python312\Lib\site-packages\sqlalchemy\util\compat.py", line 211, in raise_
    raise exception
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python312\Lib\site-packages\sqlalchemy\pool\base.py", line 686, in __connect
    self.dbapi_connection = connection = pool._invoke_creator(self)
                                         ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python312\Lib\site-packages\sqlalchemy\engine\create.py", line 574, in connect
    return dialect.connect(*cargs, **cparams)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python312\Lib\site-packages\sqlalchemy\engine\default.py", line 598, in connect
    return self.dbapi.connect(*cargs, **cparams)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python312\Lib\site-packages\pymysql\connections.py", line 358, in __init__
    self.connect()
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python312\Lib\site-packages\pymysql\connections.py", line 711, in connect
    raise exc
sqlalchemy.exc.OperationalError: (pymysql.err.OperationalError) (2003, "Can't connect to MySQL server on '47.120.36.202' ([WinError 10061] 由于目标计算机积极拒绝，无法连接。)")
(Background on this error at: https://sqlalche.me/e/14/e3q8)
2025-04-18 19:31:05,858 - root - WARNING - No last sync timestamp found. Starting sync from 2025-04-17T11:31:03.594841+00:00
2025-04-18 19:31:05,858 - root - INFO - XiaoeClient initialized.
2025-04-18 19:31:05,858 - root - INFO - Fetching page 1 of orders (state=2, size=50) from 2025-04-17 11:31:04 to 2025-04-18 11:31:03
2025-04-18 19:31:05,858 - root - INFO - Fetching orders: page=1, size=50, start=2025-04-17 11:31:04, end=2025-04-18 11:31:03, state=2
2025-04-18 19:31:05,858 - root - INFO - Attempting to get new Xiaoe access token...
2025-04-18 19:31:06,335 - root - ERROR - Error getting Xiaoe token: 404 Client Error: Not Found for url: https://api.xiaoe-tech.com/token
Traceback (most recent call last):
  File "D:\cursor开发工程\BI\platforms\xiaoe\client.py", line 68, in _get_access_token
    response.raise_for_status() # Raises HTTPError for bad responses (4xx or 5xx)
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python312\Lib\site-packages\requests\models.py", line 1021, in raise_for_status
    raise HTTPError(http_error_msg, response=self)
requests.exceptions.HTTPError: 404 Client Error: Not Found for url: https://api.xiaoe-tech.com/token
2025-04-18 19:31:06,336 - root - WARNING - Function _make_request failed with XiaoeRequestError, retrying in 5s... (2 retries left). Error: Network or request error getting token: 404 Client Error: Not Found for url: https://api.xiaoe-tech.com/token
2025-04-18 19:31:11,337 - root - INFO - Attempting to get new Xiaoe access token...
2025-04-18 19:31:11,788 - root - ERROR - Error getting Xiaoe token: 404 Client Error: Not Found for url: https://api.xiaoe-tech.com/token
Traceback (most recent call last):
  File "D:\cursor开发工程\BI\platforms\xiaoe\client.py", line 68, in _get_access_token
    response.raise_for_status() # Raises HTTPError for bad responses (4xx or 5xx)
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python312\Lib\site-packages\requests\models.py", line 1021, in raise_for_status
    raise HTTPError(http_error_msg, response=self)
requests.exceptions.HTTPError: 404 Client Error: Not Found for url: https://api.xiaoe-tech.com/token
2025-04-18 19:31:11,789 - root - WARNING - Function _make_request failed with XiaoeRequestError, retrying in 10s... (1 retries left). Error: Network or request error getting token: 404 Client Error: Not Found for url: https://api.xiaoe-tech.com/token
2025-04-18 19:31:21,791 - root - INFO - Attempting to get new Xiaoe access token...
2025-04-18 19:31:22,240 - root - ERROR - Error getting Xiaoe token: 404 Client Error: Not Found for url: https://api.xiaoe-tech.com/token
Traceback (most recent call last):
  File "D:\cursor开发工程\BI\platforms\xiaoe\client.py", line 68, in _get_access_token
    response.raise_for_status() # Raises HTTPError for bad responses (4xx or 5xx)
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python312\Lib\site-packages\requests\models.py", line 1021, in raise_for_status
    raise HTTPError(http_error_msg, response=self)
requests.exceptions.HTTPError: 404 Client Error: Not Found for url: https://api.xiaoe-tech.com/token
2025-04-18 19:31:22,245 - root - ERROR - Function _make_request reached max retries (3) with error: Network or request error getting token: 404 Client Error: Not Found for url: https://api.xiaoe-tech.com/token
Traceback (most recent call last):
  File "D:\cursor开发工程\BI\platforms\xiaoe\client.py", line 68, in _get_access_token
    response.raise_for_status() # Raises HTTPError for bad responses (4xx or 5xx)
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python312\Lib\site-packages\requests\models.py", line 1021, in raise_for_status
    raise HTTPError(http_error_msg, response=self)
requests.exceptions.HTTPError: 404 Client Error: Not Found for url: https://api.xiaoe-tech.com/token

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "D:\cursor开发工程\BI\utils\retry.py", line 33, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "D:\cursor开发工程\BI\platforms\xiaoe\client.py", line 98, in _make_request
    token = self._get_access_token()
            ^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\cursor开发工程\BI\platforms\xiaoe\client.py", line 90, in _get_access_token
    raise XiaoeRequestError(f"Network or request error getting token: {e}") from e
platforms.xiaoe.client.XiaoeRequestError: Network or request error getting token: 404 Client Error: Not Found for url: https://api.xiaoe-tech.com/token
2025-04-18 19:31:22,247 - root - ERROR - API error fetching page 1: Network or request error getting token: 404 Client Error: Not Found for url: https://api.xiaoe-tech.com/token
Traceback (most recent call last):
  File "D:\cursor开发工程\BI\platforms\xiaoe\client.py", line 68, in _get_access_token
    response.raise_for_status() # Raises HTTPError for bad responses (4xx or 5xx)
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python312\Lib\site-packages\requests\models.py", line 1021, in raise_for_status
    raise HTTPError(http_error_msg, response=self)
requests.exceptions.HTTPError: 404 Client Error: Not Found for url: https://api.xiaoe-tech.com/token

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "D:\cursor开发工程\BI\scripts\sync_xiaoe.py", line 138, in run_incremental_sync
    response_data = client.get_orders(page=page, page_size=page_size, start_time=start_time_str, end_time=end_time_str, order_state=2)
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\cursor开发工程\BI\platforms\xiaoe\client.py", line 195, in get_orders
    return self._make_request('orders', method='POST', data=data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\cursor开发工程\BI\utils\retry.py", line 33, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "D:\cursor开发工程\BI\platforms\xiaoe\client.py", line 98, in _make_request
    token = self._get_access_token()
            ^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\cursor开发工程\BI\platforms\xiaoe\client.py", line 90, in _get_access_token
    raise XiaoeRequestError(f"Network or request error getting token: {e}") from e
platforms.xiaoe.client.XiaoeRequestError: Network or request error getting token: 404 Client Error: Not Found for url: https://api.xiaoe-tech.com/token
2025-04-18 19:31:22,247 - root - ERROR - Xiaoe incremental order sync failed: API error fetching page 1: Network or request error getting token: 404 Client Error: Not Found for url: https://api.xiaoe-tech.com/token
Traceback (most recent call last):
  File "D:\cursor开发工程\BI\platforms\xiaoe\client.py", line 68, in _get_access_token
    response.raise_for_status() # Raises HTTPError for bad responses (4xx or 5xx)
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python312\Lib\site-packages\requests\models.py", line 1021, in raise_for_status
    raise HTTPError(http_error_msg, response=self)
requests.exceptions.HTTPError: 404 Client Error: Not Found for url: https://api.xiaoe-tech.com/token

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "D:\cursor开发工程\BI\scripts\sync_xiaoe.py", line 138, in run_incremental_sync
    response_data = client.get_orders(page=page, page_size=page_size, start_time=start_time_str, end_time=end_time_str, order_state=2)
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\cursor开发工程\BI\platforms\xiaoe\client.py", line 195, in get_orders
    return self._make_request('orders', method='POST', data=data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\cursor开发工程\BI\utils\retry.py", line 33, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "D:\cursor开发工程\BI\platforms\xiaoe\client.py", line 98, in _make_request
    token = self._get_access_token()
            ^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\cursor开发工程\BI\platforms\xiaoe\client.py", line 90, in _get_access_token
    raise XiaoeRequestError(f"Network or request error getting token: {e}") from e
platforms.xiaoe.client.XiaoeRequestError: Network or request error getting token: 404 Client Error: Not Found for url: https://api.xiaoe-tech.com/token
2025-04-18 19:31:24,474 - root - ERROR - Failed to update sync status for xiaoe/order/incremental: (pymysql.err.OperationalError) (2003, "Can't connect to MySQL server on '47.120.36.202' ([WinError 10061] 由于目标计算机积极拒绝，无法连接。)")
(Background on this error at: https://sqlalche.me/e/14/e3q8)
Traceback (most recent call last):
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python312\Lib\site-packages\pymysql\connections.py", line 644, in connect
    sock = socket.create_connection(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python312\Lib\socket.py", line 865, in create_connection
    raise exceptions[0]
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python312\Lib\socket.py", line 850, in create_connection
    sock.connect(sa)
ConnectionRefusedError: [WinError 10061] 由于目标计算机积极拒绝，无法连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python312\Lib\site-packages\sqlalchemy\engine\base.py", line 3371, in _wrap_pool_connect
    return fn()
           ^^^^
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python312\Lib\site-packages\sqlalchemy\pool\base.py", line 327, in connect
    return _ConnectionFairy._checkout(self)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python312\Lib\site-packages\sqlalchemy\pool\base.py", line 894, in _checkout
    fairy = _ConnectionRecord.checkout(pool)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python312\Lib\site-packages\sqlalchemy\pool\base.py", line 493, in checkout
    rec = pool._do_get()
          ^^^^^^^^^^^^^^
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python312\Lib\site-packages\sqlalchemy\pool\impl.py", line 145, in _do_get
    with util.safe_reraise():
         ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python312\Lib\site-packages\sqlalchemy\util\langhelpers.py", line 70, in __exit__
    compat.raise_(
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python312\Lib\site-packages\sqlalchemy\util\compat.py", line 211, in raise_
    raise exception
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python312\Lib\site-packages\sqlalchemy\pool\impl.py", line 143, in _do_get
    return self._create_connection()
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python312\Lib\site-packages\sqlalchemy\pool\base.py", line 273, in _create_connection
    return _ConnectionRecord(self)
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python312\Lib\site-packages\sqlalchemy\pool\base.py", line 388, in __init__
    self.__connect()
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python312\Lib\site-packages\sqlalchemy\pool\base.py", line 690, in __connect
    with util.safe_reraise():
         ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python312\Lib\site-packages\sqlalchemy\util\langhelpers.py", line 70, in __exit__
    compat.raise_(
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python312\Lib\site-packages\sqlalchemy\util\compat.py", line 211, in raise_
    raise exception
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python312\Lib\site-packages\sqlalchemy\pool\base.py", line 686, in __connect
    self.dbapi_connection = connection = pool._invoke_creator(self)
                                         ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python312\Lib\site-packages\sqlalchemy\engine\create.py", line 574, in connect
    return dialect.connect(*cargs, **cparams)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python312\Lib\site-packages\sqlalchemy\engine\default.py", line 598, in connect
    return self.dbapi.connect(*cargs, **cparams)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python312\Lib\site-packages\pymysql\connections.py", line 358, in __init__
    self.connect()
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python312\Lib\site-packages\pymysql\connections.py", line 711, in connect
    raise exc
pymysql.err.OperationalError: (2003, "Can't connect to MySQL server on '47.120.36.202' ([WinError 10061] 由于目标计算机积极拒绝，无法连接。)")

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "D:\cursor开发工程\BI\scripts\sync_xiaoe.py", line 43, in update_sync_status
    ).first()
      ^^^^^^^
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python312\Lib\site-packages\sqlalchemy\orm\query.py", line 2824, in first
    return self.limit(1)._iter().first()
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python312\Lib\site-packages\sqlalchemy\orm\query.py", line 2916, in _iter
    result = self.session.execute(
             ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python312\Lib\site-packages\sqlalchemy\orm\session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python312\Lib\site-packages\sqlalchemy\orm\session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python312\Lib\site-packages\sqlalchemy\orm\session.py", line 750, in _connection_for_bind
    conn = bind.connect()
           ^^^^^^^^^^^^^^
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python312\Lib\site-packages\sqlalchemy\engine\base.py", line 3325, in connect
    return self._connection_cls(self, close_with_result=close_with_result)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python312\Lib\site-packages\sqlalchemy\engine\base.py", line 96, in __init__
    else engine.raw_connection()
         ^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python312\Lib\site-packages\sqlalchemy\engine\base.py", line 3404, in raw_connection
    return self._wrap_pool_connect(self.pool.connect, _connection)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python312\Lib\site-packages\sqlalchemy\engine\base.py", line 3374, in _wrap_pool_connect
    Connection._handle_dbapi_exception_noconnection(
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python312\Lib\site-packages\sqlalchemy\engine\base.py", line 2208, in _handle_dbapi_exception_noconnection
    util.raise_(
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python312\Lib\site-packages\sqlalchemy\util\compat.py", line 211, in raise_
    raise exception
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python312\Lib\site-packages\sqlalchemy\engine\base.py", line 3371, in _wrap_pool_connect
    return fn()
           ^^^^
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python312\Lib\site-packages\sqlalchemy\pool\base.py", line 327, in connect
    return _ConnectionFairy._checkout(self)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python312\Lib\site-packages\sqlalchemy\pool\base.py", line 894, in _checkout
    fairy = _ConnectionRecord.checkout(pool)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python312\Lib\site-packages\sqlalchemy\pool\base.py", line 493, in checkout
    rec = pool._do_get()
          ^^^^^^^^^^^^^^
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python312\Lib\site-packages\sqlalchemy\pool\impl.py", line 145, in _do_get
    with util.safe_reraise():
         ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python312\Lib\site-packages\sqlalchemy\util\langhelpers.py", line 70, in __exit__
    compat.raise_(
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python312\Lib\site-packages\sqlalchemy\util\compat.py", line 211, in raise_
    raise exception
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python312\Lib\site-packages\sqlalchemy\pool\impl.py", line 143, in _do_get
    return self._create_connection()
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python312\Lib\site-packages\sqlalchemy\pool\base.py", line 273, in _create_connection
    return _ConnectionRecord(self)
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python312\Lib\site-packages\sqlalchemy\pool\base.py", line 388, in __init__
    self.__connect()
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python312\Lib\site-packages\sqlalchemy\pool\base.py", line 690, in __connect
    with util.safe_reraise():
         ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python312\Lib\site-packages\sqlalchemy\util\langhelpers.py", line 70, in __exit__
    compat.raise_(
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python312\Lib\site-packages\sqlalchemy\util\compat.py", line 211, in raise_
    raise exception
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python312\Lib\site-packages\sqlalchemy\pool\base.py", line 686, in __connect
    self.dbapi_connection = connection = pool._invoke_creator(self)
                                         ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python312\Lib\site-packages\sqlalchemy\engine\create.py", line 574, in connect
    return dialect.connect(*cargs, **cparams)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python312\Lib\site-packages\sqlalchemy\engine\default.py", line 598, in connect
    return self.dbapi.connect(*cargs, **cparams)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python312\Lib\site-packages\pymysql\connections.py", line 358, in __init__
    self.connect()
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python312\Lib\site-packages\pymysql\connections.py", line 711, in connect
    raise exc
sqlalchemy.exc.OperationalError: (pymysql.err.OperationalError) (2003, "Can't connect to MySQL server on '47.120.36.202' ([WinError 10061] 由于目标计算机积极拒绝，无法连接。)")
(Background on this error at: https://sqlalche.me/e/14/e3q8)
2025-04-18 19:31:24,479 - root - INFO - Database session closed for incremental sync.
2025-04-18 19:31:24,479 - root - INFO - Sync process finished for type: incremental
2025-04-18 19:33:50,623 - root - INFO - Logger initialized with level: INFO. Logging to console and file: D:\cursor开发工程\BI\logs\app.log
2025-04-18 19:33:50,623 - root - INFO - Starting sync process with type: incremental
2025-04-18 19:33:50,623 - root - INFO - Starting Xiaoe incremental order sync...
2025-04-18 19:33:50,980 - root - ERROR - Failed to get last sync timestamp for xiaoe/order/incremental: (pymysql.err.OperationalError) (1130, "222.211.250.210' is not allowed to connect to this MySQL server")
(Background on this error at: https://sqlalche.me/e/14/e3q8)
Traceback (most recent call last):
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python312\Lib\site-packages\sqlalchemy\engine\base.py", line 3371, in _wrap_pool_connect
    return fn()
           ^^^^
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python312\Lib\site-packages\sqlalchemy\pool\base.py", line 327, in connect
    return _ConnectionFairy._checkout(self)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python312\Lib\site-packages\sqlalchemy\pool\base.py", line 894, in _checkout
    fairy = _ConnectionRecord.checkout(pool)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python312\Lib\site-packages\sqlalchemy\pool\base.py", line 493, in checkout
    rec = pool._do_get()
          ^^^^^^^^^^^^^^
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python312\Lib\site-packages\sqlalchemy\pool\impl.py", line 145, in _do_get
    with util.safe_reraise():
         ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python312\Lib\site-packages\sqlalchemy\util\langhelpers.py", line 70, in __exit__
    compat.raise_(
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python312\Lib\site-packages\sqlalchemy\util\compat.py", line 211, in raise_
    raise exception
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python312\Lib\site-packages\sqlalchemy\pool\impl.py", line 143, in _do_get
    return self._create_connection()
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python312\Lib\site-packages\sqlalchemy\pool\base.py", line 273, in _create_connection
    return _ConnectionRecord(self)
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python312\Lib\site-packages\sqlalchemy\pool\base.py", line 388, in __init__
    self.__connect()
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python312\Lib\site-packages\sqlalchemy\pool\base.py", line 690, in __connect
    with util.safe_reraise():
         ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python312\Lib\site-packages\sqlalchemy\util\langhelpers.py", line 70, in __exit__
    compat.raise_(
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python312\Lib\site-packages\sqlalchemy\util\compat.py", line 211, in raise_
    raise exception
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python312\Lib\site-packages\sqlalchemy\pool\base.py", line 686, in __connect
    self.dbapi_connection = connection = pool._invoke_creator(self)
                                         ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python312\Lib\site-packages\sqlalchemy\engine\create.py", line 574, in connect
    return dialect.connect(*cargs, **cparams)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python312\Lib\site-packages\sqlalchemy\engine\default.py", line 598, in connect
    return self.dbapi.connect(*cargs, **cparams)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python312\Lib\site-packages\pymysql\connections.py", line 358, in __init__
    self.connect()
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python312\Lib\site-packages\pymysql\connections.py", line 663, in connect
    self._get_server_information()
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python312\Lib\site-packages\pymysql\connections.py", line 1099, in _get_server_information
    packet = self._read_packet()
             ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python312\Lib\site-packages\pymysql\connections.py", line 772, in _read_packet
    packet.raise_for_error()
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python312\Lib\site-packages\pymysql\protocol.py", line 221, in raise_for_error
    err.raise_mysql_exception(self._data)
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python312\Lib\site-packages\pymysql\err.py", line 143, in raise_mysql_exception
    raise errorclass(errno, errval)
pymysql.err.OperationalError: (1130, "222.211.250.210' is not allowed to connect to this MySQL server")

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "D:\cursor开发工程\BI\scripts\sync_xiaoe.py", line 71, in get_last_sync_timestamp
    ).order_by(SyncStatus.last_sync_timestamp.desc()).first()
                                                      ^^^^^^^
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python312\Lib\site-packages\sqlalchemy\orm\query.py", line 2824, in first
    return self.limit(1)._iter().first()
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python312\Lib\site-packages\sqlalchemy\orm\query.py", line 2916, in _iter
    result = self.session.execute(
             ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python312\Lib\site-packages\sqlalchemy\orm\session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python312\Lib\site-packages\sqlalchemy\orm\session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python312\Lib\site-packages\sqlalchemy\orm\session.py", line 750, in _connection_for_bind
    conn = bind.connect()
           ^^^^^^^^^^^^^^
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python312\Lib\site-packages\sqlalchemy\engine\base.py", line 3325, in connect
    return self._connection_cls(self, close_with_result=close_with_result)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python312\Lib\site-packages\sqlalchemy\engine\base.py", line 96, in __init__
    else engine.raw_connection()
         ^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python312\Lib\site-packages\sqlalchemy\engine\base.py", line 3404, in raw_connection
    return self._wrap_pool_connect(self.pool.connect, _connection)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python312\Lib\site-packages\sqlalchemy\engine\base.py", line 3374, in _wrap_pool_connect
    Connection._handle_dbapi_exception_noconnection(
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python312\Lib\site-packages\sqlalchemy\engine\base.py", line 2208, in _handle_dbapi_exception_noconnection
    util.raise_(
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python312\Lib\site-packages\sqlalchemy\util\compat.py", line 211, in raise_
    raise exception
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python312\Lib\site-packages\sqlalchemy\engine\base.py", line 3371, in _wrap_pool_connect
    return fn()
           ^^^^
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python312\Lib\site-packages\sqlalchemy\pool\base.py", line 327, in connect
    return _ConnectionFairy._checkout(self)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python312\Lib\site-packages\sqlalchemy\pool\base.py", line 894, in _checkout
    fairy = _ConnectionRecord.checkout(pool)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python312\Lib\site-packages\sqlalchemy\pool\base.py", line 493, in checkout
    rec = pool._do_get()
          ^^^^^^^^^^^^^^
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python312\Lib\site-packages\sqlalchemy\pool\impl.py", line 145, in _do_get
    with util.safe_reraise():
         ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python312\Lib\site-packages\sqlalchemy\util\langhelpers.py", line 70, in __exit__
    compat.raise_(
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python312\Lib\site-packages\sqlalchemy\util\compat.py", line 211, in raise_
    raise exception
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python312\Lib\site-packages\sqlalchemy\pool\impl.py", line 143, in _do_get
    return self._create_connection()
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python312\Lib\site-packages\sqlalchemy\pool\base.py", line 273, in _create_connection
    return _ConnectionRecord(self)
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python312\Lib\site-packages\sqlalchemy\pool\base.py", line 388, in __init__
    self.__connect()
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python312\Lib\site-packages\sqlalchemy\pool\base.py", line 690, in __connect
    with util.safe_reraise():
         ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python312\Lib\site-packages\sqlalchemy\util\langhelpers.py", line 70, in __exit__
    compat.raise_(
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python312\Lib\site-packages\sqlalchemy\util\compat.py", line 211, in raise_
    raise exception
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python312\Lib\site-packages\sqlalchemy\pool\base.py", line 686, in __connect
    self.dbapi_connection = connection = pool._invoke_creator(self)
                                         ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python312\Lib\site-packages\sqlalchemy\engine\create.py", line 574, in connect
    return dialect.connect(*cargs, **cparams)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python312\Lib\site-packages\sqlalchemy\engine\default.py", line 598, in connect
    return self.dbapi.connect(*cargs, **cparams)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python312\Lib\site-packages\pymysql\connections.py", line 358, in __init__
    self.connect()
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python312\Lib\site-packages\pymysql\connections.py", line 663, in connect
    self._get_server_information()
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python312\Lib\site-packages\pymysql\connections.py", line 1099, in _get_server_information
    packet = self._read_packet()
             ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python312\Lib\site-packages\pymysql\connections.py", line 772, in _read_packet
    packet.raise_for_error()
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python312\Lib\site-packages\pymysql\protocol.py", line 221, in raise_for_error
    err.raise_mysql_exception(self._data)
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python312\Lib\site-packages\pymysql\err.py", line 143, in raise_mysql_exception
    raise errorclass(errno, errval)
sqlalchemy.exc.OperationalError: (pymysql.err.OperationalError) (1130, "222.211.250.210' is not allowed to connect to this MySQL server")
(Background on this error at: https://sqlalche.me/e/14/e3q8)
2025-04-18 19:33:50,991 - root - WARNING - No last sync timestamp found. Starting sync from 2025-04-17T11:33:50.623794+00:00
2025-04-18 19:33:50,991 - root - INFO - XiaoeClient initialized.
2025-04-18 19:33:50,991 - root - INFO - Fetching page 1 of orders (state=2, size=50) from 2025-04-17 11:33:51 to 2025-04-18 11:33:50
2025-04-18 19:33:50,991 - root - INFO - Fetching orders: page=1, size=50, start=2025-04-17 11:33:51, end=2025-04-18 11:33:50, state=2
2025-04-18 19:33:50,993 - root - INFO - Attempting to get new Xiaoe access token...
2025-04-18 19:33:51,455 - root - ERROR - Error getting Xiaoe token: 404 Client Error: Not Found for url: https://api.xiaoe-tech.com/token
Traceback (most recent call last):
  File "D:\cursor开发工程\BI\platforms\xiaoe\client.py", line 68, in _get_access_token
    response.raise_for_status() # Raises HTTPError for bad responses (4xx or 5xx)
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python312\Lib\site-packages\requests\models.py", line 1021, in raise_for_status
    raise HTTPError(http_error_msg, response=self)
requests.exceptions.HTTPError: 404 Client Error: Not Found for url: https://api.xiaoe-tech.com/token
2025-04-18 19:33:51,456 - root - WARNING - Function _make_request failed with XiaoeRequestError, retrying in 5s... (2 retries left). Error: Network or request error getting token: 404 Client Error: Not Found for url: https://api.xiaoe-tech.com/token
2025-04-18 19:33:56,458 - root - INFO - Attempting to get new Xiaoe access token...
2025-04-18 19:33:56,895 - root - ERROR - Error getting Xiaoe token: 404 Client Error: Not Found for url: https://api.xiaoe-tech.com/token
Traceback (most recent call last):
  File "D:\cursor开发工程\BI\platforms\xiaoe\client.py", line 68, in _get_access_token
    response.raise_for_status() # Raises HTTPError for bad responses (4xx or 5xx)
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python312\Lib\site-packages\requests\models.py", line 1021, in raise_for_status
    raise HTTPError(http_error_msg, response=self)
requests.exceptions.HTTPError: 404 Client Error: Not Found for url: https://api.xiaoe-tech.com/token
2025-04-18 19:33:56,896 - root - WARNING - Function _make_request failed with XiaoeRequestError, retrying in 10s... (1 retries left). Error: Network or request error getting token: 404 Client Error: Not Found for url: https://api.xiaoe-tech.com/token
2025-04-18 19:34:06,898 - root - INFO - Attempting to get new Xiaoe access token...
2025-04-18 19:34:07,327 - root - ERROR - Error getting Xiaoe token: 404 Client Error: Not Found for url: https://api.xiaoe-tech.com/token
Traceback (most recent call last):
  File "D:\cursor开发工程\BI\platforms\xiaoe\client.py", line 68, in _get_access_token
    response.raise_for_status() # Raises HTTPError for bad responses (4xx or 5xx)
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python312\Lib\site-packages\requests\models.py", line 1021, in raise_for_status
    raise HTTPError(http_error_msg, response=self)
requests.exceptions.HTTPError: 404 Client Error: Not Found for url: https://api.xiaoe-tech.com/token
2025-04-18 19:34:07,328 - root - ERROR - Function _make_request reached max retries (3) with error: Network or request error getting token: 404 Client Error: Not Found for url: https://api.xiaoe-tech.com/token
Traceback (most recent call last):
  File "D:\cursor开发工程\BI\platforms\xiaoe\client.py", line 68, in _get_access_token
    response.raise_for_status() # Raises HTTPError for bad responses (4xx or 5xx)
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python312\Lib\site-packages\requests\models.py", line 1021, in raise_for_status
    raise HTTPError(http_error_msg, response=self)
requests.exceptions.HTTPError: 404 Client Error: Not Found for url: https://api.xiaoe-tech.com/token

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "D:\cursor开发工程\BI\utils\retry.py", line 33, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "D:\cursor开发工程\BI\platforms\xiaoe\client.py", line 98, in _make_request
    token = self._get_access_token()
            ^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\cursor开发工程\BI\platforms\xiaoe\client.py", line 90, in _get_access_token
    raise XiaoeRequestError(f"Network or request error getting token: {e}") from e
platforms.xiaoe.client.XiaoeRequestError: Network or request error getting token: 404 Client Error: Not Found for url: https://api.xiaoe-tech.com/token
2025-04-18 19:34:07,329 - root - ERROR - API error fetching page 1: Network or request error getting token: 404 Client Error: Not Found for url: https://api.xiaoe-tech.com/token
Traceback (most recent call last):
  File "D:\cursor开发工程\BI\platforms\xiaoe\client.py", line 68, in _get_access_token
    response.raise_for_status() # Raises HTTPError for bad responses (4xx or 5xx)
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python312\Lib\site-packages\requests\models.py", line 1021, in raise_for_status
    raise HTTPError(http_error_msg, response=self)
requests.exceptions.HTTPError: 404 Client Error: Not Found for url: https://api.xiaoe-tech.com/token

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "D:\cursor开发工程\BI\scripts\sync_xiaoe.py", line 138, in run_incremental_sync
    response_data = client.get_orders(page=page, page_size=page_size, start_time=start_time_str, end_time=end_time_str, order_state=2)
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\cursor开发工程\BI\platforms\xiaoe\client.py", line 195, in get_orders
    return self._make_request('orders', method='POST', data=data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\cursor开发工程\BI\utils\retry.py", line 33, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "D:\cursor开发工程\BI\platforms\xiaoe\client.py", line 98, in _make_request
    token = self._get_access_token()
            ^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\cursor开发工程\BI\platforms\xiaoe\client.py", line 90, in _get_access_token
    raise XiaoeRequestError(f"Network or request error getting token: {e}") from e
platforms.xiaoe.client.XiaoeRequestError: Network or request error getting token: 404 Client Error: Not Found for url: https://api.xiaoe-tech.com/token
2025-04-18 19:34:07,331 - root - ERROR - Xiaoe incremental order sync failed: API error fetching page 1: Network or request error getting token: 404 Client Error: Not Found for url: https://api.xiaoe-tech.com/token
Traceback (most recent call last):
  File "D:\cursor开发工程\BI\platforms\xiaoe\client.py", line 68, in _get_access_token
    response.raise_for_status() # Raises HTTPError for bad responses (4xx or 5xx)
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python312\Lib\site-packages\requests\models.py", line 1021, in raise_for_status
    raise HTTPError(http_error_msg, response=self)
requests.exceptions.HTTPError: 404 Client Error: Not Found for url: https://api.xiaoe-tech.com/token

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "D:\cursor开发工程\BI\scripts\sync_xiaoe.py", line 138, in run_incremental_sync
    response_data = client.get_orders(page=page, page_size=page_size, start_time=start_time_str, end_time=end_time_str, order_state=2)
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\cursor开发工程\BI\platforms\xiaoe\client.py", line 195, in get_orders
    return self._make_request('orders', method='POST', data=data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\cursor开发工程\BI\utils\retry.py", line 33, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "D:\cursor开发工程\BI\platforms\xiaoe\client.py", line 98, in _make_request
    token = self._get_access_token()
            ^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\cursor开发工程\BI\platforms\xiaoe\client.py", line 90, in _get_access_token
    raise XiaoeRequestError(f"Network or request error getting token: {e}") from e
platforms.xiaoe.client.XiaoeRequestError: Network or request error getting token: 404 Client Error: Not Found for url: https://api.xiaoe-tech.com/token
2025-04-18 19:34:07,456 - root - ERROR - Failed to update sync status for xiaoe/order/incremental: (pymysql.err.OperationalError) (1130, "222.211.250.210' is not allowed to connect to this MySQL server")
(Background on this error at: https://sqlalche.me/e/14/e3q8)
Traceback (most recent call last):
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python312\Lib\site-packages\sqlalchemy\engine\base.py", line 3371, in _wrap_pool_connect
    return fn()
           ^^^^
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python312\Lib\site-packages\sqlalchemy\pool\base.py", line 327, in connect
    return _ConnectionFairy._checkout(self)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python312\Lib\site-packages\sqlalchemy\pool\base.py", line 894, in _checkout
    fairy = _ConnectionRecord.checkout(pool)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python312\Lib\site-packages\sqlalchemy\pool\base.py", line 493, in checkout
    rec = pool._do_get()
          ^^^^^^^^^^^^^^
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python312\Lib\site-packages\sqlalchemy\pool\impl.py", line 145, in _do_get
    with util.safe_reraise():
         ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python312\Lib\site-packages\sqlalchemy\util\langhelpers.py", line 70, in __exit__
    compat.raise_(
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python312\Lib\site-packages\sqlalchemy\util\compat.py", line 211, in raise_
    raise exception
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python312\Lib\site-packages\sqlalchemy\pool\impl.py", line 143, in _do_get
    return self._create_connection()
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python312\Lib\site-packages\sqlalchemy\pool\base.py", line 273, in _create_connection
    return _ConnectionRecord(self)
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python312\Lib\site-packages\sqlalchemy\pool\base.py", line 388, in __init__
    self.__connect()
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python312\Lib\site-packages\sqlalchemy\pool\base.py", line 690, in __connect
    with util.safe_reraise():
         ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python312\Lib\site-packages\sqlalchemy\util\langhelpers.py", line 70, in __exit__
    compat.raise_(
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python312\Lib\site-packages\sqlalchemy\util\compat.py", line 211, in raise_
    raise exception
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python312\Lib\site-packages\sqlalchemy\pool\base.py", line 686, in __connect
    self.dbapi_connection = connection = pool._invoke_creator(self)
                                         ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python312\Lib\site-packages\sqlalchemy\engine\create.py", line 574, in connect
    return dialect.connect(*cargs, **cparams)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python312\Lib\site-packages\sqlalchemy\engine\default.py", line 598, in connect
    return self.dbapi.connect(*cargs, **cparams)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python312\Lib\site-packages\pymysql\connections.py", line 358, in __init__
    self.connect()
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python312\Lib\site-packages\pymysql\connections.py", line 663, in connect
    self._get_server_information()
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python312\Lib\site-packages\pymysql\connections.py", line 1099, in _get_server_information
    packet = self._read_packet()
             ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python312\Lib\site-packages\pymysql\connections.py", line 772, in _read_packet
    packet.raise_for_error()
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python312\Lib\site-packages\pymysql\protocol.py", line 221, in raise_for_error
    err.raise_mysql_exception(self._data)
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python312\Lib\site-packages\pymysql\err.py", line 143, in raise_mysql_exception
    raise errorclass(errno, errval)
pymysql.err.OperationalError: (1130, "222.211.250.210' is not allowed to connect to this MySQL server")

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "D:\cursor开发工程\BI\scripts\sync_xiaoe.py", line 43, in update_sync_status
    ).first()
      ^^^^^^^
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python312\Lib\site-packages\sqlalchemy\orm\query.py", line 2824, in first
    return self.limit(1)._iter().first()
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python312\Lib\site-packages\sqlalchemy\orm\query.py", line 2916, in _iter
    result = self.session.execute(
             ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python312\Lib\site-packages\sqlalchemy\orm\session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python312\Lib\site-packages\sqlalchemy\orm\session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python312\Lib\site-packages\sqlalchemy\orm\session.py", line 750, in _connection_for_bind
    conn = bind.connect()
           ^^^^^^^^^^^^^^
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python312\Lib\site-packages\sqlalchemy\engine\base.py", line 3325, in connect
    return self._connection_cls(self, close_with_result=close_with_result)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python312\Lib\site-packages\sqlalchemy\engine\base.py", line 96, in __init__
    else engine.raw_connection()
         ^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python312\Lib\site-packages\sqlalchemy\engine\base.py", line 3404, in raw_connection
    return self._wrap_pool_connect(self.pool.connect, _connection)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python312\Lib\site-packages\sqlalchemy\engine\base.py", line 3374, in _wrap_pool_connect
    Connection._handle_dbapi_exception_noconnection(
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python312\Lib\site-packages\sqlalchemy\engine\base.py", line 2208, in _handle_dbapi_exception_noconnection
    util.raise_(
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python312\Lib\site-packages\sqlalchemy\util\compat.py", line 211, in raise_
    raise exception
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python312\Lib\site-packages\sqlalchemy\engine\base.py", line 3371, in _wrap_pool_connect
    return fn()
           ^^^^
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python312\Lib\site-packages\sqlalchemy\pool\base.py", line 327, in connect
    return _ConnectionFairy._checkout(self)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python312\Lib\site-packages\sqlalchemy\pool\base.py", line 894, in _checkout
    fairy = _ConnectionRecord.checkout(pool)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python312\Lib\site-packages\sqlalchemy\pool\base.py", line 493, in checkout
    rec = pool._do_get()
          ^^^^^^^^^^^^^^
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python312\Lib\site-packages\sqlalchemy\pool\impl.py", line 145, in _do_get
    with util.safe_reraise():
         ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python312\Lib\site-packages\sqlalchemy\util\langhelpers.py", line 70, in __exit__
    compat.raise_(
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python312\Lib\site-packages\sqlalchemy\util\compat.py", line 211, in raise_
    raise exception
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python312\Lib\site-packages\sqlalchemy\pool\impl.py", line 143, in _do_get
    return self._create_connection()
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python312\Lib\site-packages\sqlalchemy\pool\base.py", line 273, in _create_connection
    return _ConnectionRecord(self)
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python312\Lib\site-packages\sqlalchemy\pool\base.py", line 388, in __init__
    self.__connect()
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python312\Lib\site-packages\sqlalchemy\pool\base.py", line 690, in __connect
    with util.safe_reraise():
         ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python312\Lib\site-packages\sqlalchemy\util\langhelpers.py", line 70, in __exit__
    compat.raise_(
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python312\Lib\site-packages\sqlalchemy\util\compat.py", line 211, in raise_
    raise exception
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python312\Lib\site-packages\sqlalchemy\pool\base.py", line 686, in __connect
    self.dbapi_connection = connection = pool._invoke_creator(self)
                                         ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python312\Lib\site-packages\sqlalchemy\engine\create.py", line 574, in connect
    return dialect.connect(*cargs, **cparams)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python312\Lib\site-packages\sqlalchemy\engine\default.py", line 598, in connect
    return self.dbapi.connect(*cargs, **cparams)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python312\Lib\site-packages\pymysql\connections.py", line 358, in __init__
    self.connect()
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python312\Lib\site-packages\pymysql\connections.py", line 663, in connect
    self._get_server_information()
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python312\Lib\site-packages\pymysql\connections.py", line 1099, in _get_server_information
    packet = self._read_packet()
             ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python312\Lib\site-packages\pymysql\connections.py", line 772, in _read_packet
    packet.raise_for_error()
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python312\Lib\site-packages\pymysql\protocol.py", line 221, in raise_for_error
    err.raise_mysql_exception(self._data)
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python312\Lib\site-packages\pymysql\err.py", line 143, in raise_mysql_exception
    raise errorclass(errno, errval)
sqlalchemy.exc.OperationalError: (pymysql.err.OperationalError) (1130, "222.211.250.210' is not allowed to connect to this MySQL server")
(Background on this error at: https://sqlalche.me/e/14/e3q8)
2025-04-18 19:34:07,464 - root - INFO - Database session closed for incremental sync.
2025-04-18 19:34:07,464 - root - INFO - Sync process finished for type: incremental
2025-04-18 19:37:42,674 - root - INFO - Logger initialized with level: INFO. Logging to console and file: D:\cursor开发工程\BI\logs\app.log
2025-04-18 19:37:42,674 - root - INFO - Starting sync process with type: incremental
2025-04-18 19:37:42,674 - root - INFO - Starting Xiaoe incremental order sync...
2025-04-18 19:37:42,798 - root - ERROR - Failed to get last sync timestamp for xiaoe/order/incremental: (pymysql.err.OperationalError) (1130, "171.221.65.43' is not allowed to connect to this MySQL server")
(Background on this error at: https://sqlalche.me/e/14/e3q8)
Traceback (most recent call last):
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python312\Lib\site-packages\sqlalchemy\engine\base.py", line 3371, in _wrap_pool_connect
    return fn()
           ^^^^
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python312\Lib\site-packages\sqlalchemy\pool\base.py", line 327, in connect
    return _ConnectionFairy._checkout(self)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python312\Lib\site-packages\sqlalchemy\pool\base.py", line 894, in _checkout
    fairy = _ConnectionRecord.checkout(pool)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python312\Lib\site-packages\sqlalchemy\pool\base.py", line 493, in checkout
    rec = pool._do_get()
          ^^^^^^^^^^^^^^
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python312\Lib\site-packages\sqlalchemy\pool\impl.py", line 145, in _do_get
    with util.safe_reraise():
         ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python312\Lib\site-packages\sqlalchemy\util\langhelpers.py", line 70, in __exit__
    compat.raise_(
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python312\Lib\site-packages\sqlalchemy\util\compat.py", line 211, in raise_
    raise exception
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python312\Lib\site-packages\sqlalchemy\pool\impl.py", line 143, in _do_get
    return self._create_connection()
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python312\Lib\site-packages\sqlalchemy\pool\base.py", line 273, in _create_connection
    return _ConnectionRecord(self)
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python312\Lib\site-packages\sqlalchemy\pool\base.py", line 388, in __init__
    self.__connect()
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python312\Lib\site-packages\sqlalchemy\pool\base.py", line 690, in __connect
    with util.safe_reraise():
         ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python312\Lib\site-packages\sqlalchemy\util\langhelpers.py", line 70, in __exit__
    compat.raise_(
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python312\Lib\site-packages\sqlalchemy\util\compat.py", line 211, in raise_
    raise exception
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python312\Lib\site-packages\sqlalchemy\pool\base.py", line 686, in __connect
    self.dbapi_connection = connection = pool._invoke_creator(self)
                                         ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python312\Lib\site-packages\sqlalchemy\engine\create.py", line 574, in connect
    return dialect.connect(*cargs, **cparams)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python312\Lib\site-packages\sqlalchemy\engine\default.py", line 598, in connect
    return self.dbapi.connect(*cargs, **cparams)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python312\Lib\site-packages\pymysql\connections.py", line 358, in __init__
    self.connect()
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python312\Lib\site-packages\pymysql\connections.py", line 663, in connect
    self._get_server_information()
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python312\Lib\site-packages\pymysql\connections.py", line 1099, in _get_server_information
    packet = self._read_packet()
             ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python312\Lib\site-packages\pymysql\connections.py", line 772, in _read_packet
    packet.raise_for_error()
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python312\Lib\site-packages\pymysql\protocol.py", line 221, in raise_for_error
    err.raise_mysql_exception(self._data)
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python312\Lib\site-packages\pymysql\err.py", line 143, in raise_mysql_exception
    raise errorclass(errno, errval)
pymysql.err.OperationalError: (1130, "171.221.65.43' is not allowed to connect to this MySQL server")

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "D:\cursor开发工程\BI\scripts\sync_xiaoe.py", line 71, in get_last_sync_timestamp
    ).order_by(SyncStatus.last_sync_timestamp.desc()).first()
                                                      ^^^^^^^
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python312\Lib\site-packages\sqlalchemy\orm\query.py", line 2824, in first
    return self.limit(1)._iter().first()
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python312\Lib\site-packages\sqlalchemy\orm\query.py", line 2916, in _iter
    result = self.session.execute(
             ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python312\Lib\site-packages\sqlalchemy\orm\session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python312\Lib\site-packages\sqlalchemy\orm\session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python312\Lib\site-packages\sqlalchemy\orm\session.py", line 750, in _connection_for_bind
    conn = bind.connect()
           ^^^^^^^^^^^^^^
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python312\Lib\site-packages\sqlalchemy\engine\base.py", line 3325, in connect
    return self._connection_cls(self, close_with_result=close_with_result)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python312\Lib\site-packages\sqlalchemy\engine\base.py", line 96, in __init__
    else engine.raw_connection()
         ^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python312\Lib\site-packages\sqlalchemy\engine\base.py", line 3404, in raw_connection
    return self._wrap_pool_connect(self.pool.connect, _connection)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python312\Lib\site-packages\sqlalchemy\engine\base.py", line 3374, in _wrap_pool_connect
    Connection._handle_dbapi_exception_noconnection(
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python312\Lib\site-packages\sqlalchemy\engine\base.py", line 2208, in _handle_dbapi_exception_noconnection
    util.raise_(
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python312\Lib\site-packages\sqlalchemy\util\compat.py", line 211, in raise_
    raise exception
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python312\Lib\site-packages\sqlalchemy\engine\base.py", line 3371, in _wrap_pool_connect
    return fn()
           ^^^^
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python312\Lib\site-packages\sqlalchemy\pool\base.py", line 327, in connect
    return _ConnectionFairy._checkout(self)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python312\Lib\site-packages\sqlalchemy\pool\base.py", line 894, in _checkout
    fairy = _ConnectionRecord.checkout(pool)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python312\Lib\site-packages\sqlalchemy\pool\base.py", line 493, in checkout
    rec = pool._do_get()
          ^^^^^^^^^^^^^^
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python312\Lib\site-packages\sqlalchemy\pool\impl.py", line 145, in _do_get
    with util.safe_reraise():
         ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python312\Lib\site-packages\sqlalchemy\util\langhelpers.py", line 70, in __exit__
    compat.raise_(
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python312\Lib\site-packages\sqlalchemy\util\compat.py", line 211, in raise_
    raise exception
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python312\Lib\site-packages\sqlalchemy\pool\impl.py", line 143, in _do_get
    return self._create_connection()
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python312\Lib\site-packages\sqlalchemy\pool\base.py", line 273, in _create_connection
    return _ConnectionRecord(self)
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python312\Lib\site-packages\sqlalchemy\pool\base.py", line 388, in __init__
    self.__connect()
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python312\Lib\site-packages\sqlalchemy\pool\base.py", line 690, in __connect
    with util.safe_reraise():
         ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python312\Lib\site-packages\sqlalchemy\util\langhelpers.py", line 70, in __exit__
    compat.raise_(
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python312\Lib\site-packages\sqlalchemy\util\compat.py", line 211, in raise_
    raise exception
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python312\Lib\site-packages\sqlalchemy\pool\base.py", line 686, in __connect
    self.dbapi_connection = connection = pool._invoke_creator(self)
                                         ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python312\Lib\site-packages\sqlalchemy\engine\create.py", line 574, in connect
    return dialect.connect(*cargs, **cparams)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python312\Lib\site-packages\sqlalchemy\engine\default.py", line 598, in connect
    return self.dbapi.connect(*cargs, **cparams)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python312\Lib\site-packages\pymysql\connections.py", line 358, in __init__
    self.connect()
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python312\Lib\site-packages\pymysql\connections.py", line 663, in connect
    self._get_server_information()
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python312\Lib\site-packages\pymysql\connections.py", line 1099, in _get_server_information
    packet = self._read_packet()
             ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python312\Lib\site-packages\pymysql\connections.py", line 772, in _read_packet
    packet.raise_for_error()
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python312\Lib\site-packages\pymysql\protocol.py", line 221, in raise_for_error
    err.raise_mysql_exception(self._data)
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python312\Lib\site-packages\pymysql\err.py", line 143, in raise_mysql_exception
    raise errorclass(errno, errval)
sqlalchemy.exc.OperationalError: (pymysql.err.OperationalError) (1130, "171.221.65.43' is not allowed to connect to this MySQL server")
(Background on this error at: https://sqlalche.me/e/14/e3q8)
2025-04-18 19:37:42,812 - root - WARNING - No last sync timestamp found. Starting sync from 2025-04-17T11:37:42.674654+00:00
2025-04-18 19:37:42,813 - root - INFO - XiaoeClient initialized.
2025-04-18 19:37:42,813 - root - INFO - Fetching page 1 of orders (state=2, size=50) from 2025-04-17 11:37:43 to 2025-04-18 11:37:42
2025-04-18 19:37:42,813 - root - INFO - Fetching orders: page=1, size=50, start=2025-04-17 11:37:43, end=2025-04-18 11:37:42, state=2
2025-04-18 19:37:42,813 - root - INFO - Attempting to get new Xiaoe access token...
2025-04-18 19:37:43,332 - root - INFO - Successfully obtained Xiaoe access token. Expires around: 2025-04-18 21:37:43
2025-04-18 19:37:43,800 - root - ERROR - Xiaoe API returned error. Endpoint: orders, Code: 40004, Msg: 不存在的 order_state_state 类型
2025-04-18 19:37:43,801 - root - ERROR - Unexpected error during Xiaoe API request for orders: Xiaoe API returned error. Endpoint: orders, Code: 40004, Msg: 不存在的 order_state_state 类型
Traceback (most recent call last):
  File "D:\cursor开发工程\BI\platforms\xiaoe\client.py", line 134, in _make_request
    raise XiaoeRequestError(error_msg)
platforms.xiaoe.client.XiaoeRequestError: Xiaoe API returned error. Endpoint: orders, Code: 40004, Msg: 不存在的 order_state_state 类型
2025-04-18 19:37:43,801 - root - ERROR - API error fetching page 1: Unexpected error for endpoint orders: Xiaoe API returned error. Endpoint: orders, Code: 40004, Msg: 不存在的 order_state_state 类型
Traceback (most recent call last):
  File "D:\cursor开发工程\BI\platforms\xiaoe\client.py", line 134, in _make_request
    raise XiaoeRequestError(error_msg)
platforms.xiaoe.client.XiaoeRequestError: Xiaoe API returned error. Endpoint: orders, Code: 40004, Msg: 不存在的 order_state_state 类型

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "D:\cursor开发工程\BI\scripts\sync_xiaoe.py", line 138, in run_incremental_sync
    response_data = client.get_orders(page=page, page_size=page_size, start_time=start_time_str, end_time=end_time_str, order_state=2)
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\cursor开发工程\BI\platforms\xiaoe\client.py", line 163, in get_orders
    return self._make_request('orders', method='POST', user_params=user_params)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\cursor开发工程\BI\platforms\xiaoe\client.py", line 144, in _make_request
    raise XiaoeRequestError(f"Unexpected error for endpoint {endpoint_key}: {e}") from e
platforms.xiaoe.client.XiaoeRequestError: Unexpected error for endpoint orders: Xiaoe API returned error. Endpoint: orders, Code: 40004, Msg: 不存在的 order_state_state 类型
2025-04-18 19:37:43,802 - root - ERROR - Xiaoe incremental order sync failed: API error fetching page 1: Unexpected error for endpoint orders: Xiaoe API returned error. Endpoint: orders, Code: 40004, Msg: 不存在的 order_state_state 类型
Traceback (most recent call last):
  File "D:\cursor开发工程\BI\platforms\xiaoe\client.py", line 134, in _make_request
    raise XiaoeRequestError(error_msg)
platforms.xiaoe.client.XiaoeRequestError: Xiaoe API returned error. Endpoint: orders, Code: 40004, Msg: 不存在的 order_state_state 类型

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "D:\cursor开发工程\BI\scripts\sync_xiaoe.py", line 138, in run_incremental_sync
    response_data = client.get_orders(page=page, page_size=page_size, start_time=start_time_str, end_time=end_time_str, order_state=2)
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\cursor开发工程\BI\platforms\xiaoe\client.py", line 163, in get_orders
    return self._make_request('orders', method='POST', user_params=user_params)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\cursor开发工程\BI\platforms\xiaoe\client.py", line 144, in _make_request
    raise XiaoeRequestError(f"Unexpected error for endpoint {endpoint_key}: {e}") from e
platforms.xiaoe.client.XiaoeRequestError: Unexpected error for endpoint orders: Xiaoe API returned error. Endpoint: orders, Code: 40004, Msg: 不存在的 order_state_state 类型
2025-04-18 19:37:43,882 - root - ERROR - Failed to update sync status for xiaoe/order/incremental: (pymysql.err.OperationalError) (1130, "171.221.65.43' is not allowed to connect to this MySQL server")
(Background on this error at: https://sqlalche.me/e/14/e3q8)
Traceback (most recent call last):
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python312\Lib\site-packages\sqlalchemy\engine\base.py", line 3371, in _wrap_pool_connect
    return fn()
           ^^^^
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python312\Lib\site-packages\sqlalchemy\pool\base.py", line 327, in connect
    return _ConnectionFairy._checkout(self)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python312\Lib\site-packages\sqlalchemy\pool\base.py", line 894, in _checkout
    fairy = _ConnectionRecord.checkout(pool)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python312\Lib\site-packages\sqlalchemy\pool\base.py", line 493, in checkout
    rec = pool._do_get()
          ^^^^^^^^^^^^^^
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python312\Lib\site-packages\sqlalchemy\pool\impl.py", line 145, in _do_get
    with util.safe_reraise():
         ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python312\Lib\site-packages\sqlalchemy\util\langhelpers.py", line 70, in __exit__
    compat.raise_(
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python312\Lib\site-packages\sqlalchemy\util\compat.py", line 211, in raise_
    raise exception
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python312\Lib\site-packages\sqlalchemy\pool\impl.py", line 143, in _do_get
    return self._create_connection()
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python312\Lib\site-packages\sqlalchemy\pool\base.py", line 273, in _create_connection
    return _ConnectionRecord(self)
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python312\Lib\site-packages\sqlalchemy\pool\base.py", line 388, in __init__
    self.__connect()
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python312\Lib\site-packages\sqlalchemy\pool\base.py", line 690, in __connect
    with util.safe_reraise():
         ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python312\Lib\site-packages\sqlalchemy\util\langhelpers.py", line 70, in __exit__
    compat.raise_(
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python312\Lib\site-packages\sqlalchemy\util\compat.py", line 211, in raise_
    raise exception
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python312\Lib\site-packages\sqlalchemy\pool\base.py", line 686, in __connect
    self.dbapi_connection = connection = pool._invoke_creator(self)
                                         ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python312\Lib\site-packages\sqlalchemy\engine\create.py", line 574, in connect
    return dialect.connect(*cargs, **cparams)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python312\Lib\site-packages\sqlalchemy\engine\default.py", line 598, in connect
    return self.dbapi.connect(*cargs, **cparams)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python312\Lib\site-packages\pymysql\connections.py", line 358, in __init__
    self.connect()
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python312\Lib\site-packages\pymysql\connections.py", line 663, in connect
    self._get_server_information()
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python312\Lib\site-packages\pymysql\connections.py", line 1099, in _get_server_information
    packet = self._read_packet()
             ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python312\Lib\site-packages\pymysql\connections.py", line 772, in _read_packet
    packet.raise_for_error()
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python312\Lib\site-packages\pymysql\protocol.py", line 221, in raise_for_error
    err.raise_mysql_exception(self._data)
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python312\Lib\site-packages\pymysql\err.py", line 143, in raise_mysql_exception
    raise errorclass(errno, errval)
pymysql.err.OperationalError: (1130, "171.221.65.43' is not allowed to connect to this MySQL server")

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "D:\cursor开发工程\BI\scripts\sync_xiaoe.py", line 43, in update_sync_status
    ).first()
      ^^^^^^^
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python312\Lib\site-packages\sqlalchemy\orm\query.py", line 2824, in first
    return self.limit(1)._iter().first()
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python312\Lib\site-packages\sqlalchemy\orm\query.py", line 2916, in _iter
    result = self.session.execute(
             ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python312\Lib\site-packages\sqlalchemy\orm\session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python312\Lib\site-packages\sqlalchemy\orm\session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python312\Lib\site-packages\sqlalchemy\orm\session.py", line 750, in _connection_for_bind
    conn = bind.connect()
           ^^^^^^^^^^^^^^
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python312\Lib\site-packages\sqlalchemy\engine\base.py", line 3325, in connect
    return self._connection_cls(self, close_with_result=close_with_result)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python312\Lib\site-packages\sqlalchemy\engine\base.py", line 96, in __init__
    else engine.raw_connection()
         ^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python312\Lib\site-packages\sqlalchemy\engine\base.py", line 3404, in raw_connection
    return self._wrap_pool_connect(self.pool.connect, _connection)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python312\Lib\site-packages\sqlalchemy\engine\base.py", line 3374, in _wrap_pool_connect
    Connection._handle_dbapi_exception_noconnection(
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python312\Lib\site-packages\sqlalchemy\engine\base.py", line 2208, in _handle_dbapi_exception_noconnection
    util.raise_(
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python312\Lib\site-packages\sqlalchemy\util\compat.py", line 211, in raise_
    raise exception
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python312\Lib\site-packages\sqlalchemy\engine\base.py", line 3371, in _wrap_pool_connect
    return fn()
           ^^^^
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python312\Lib\site-packages\sqlalchemy\pool\base.py", line 327, in connect
    return _ConnectionFairy._checkout(self)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python312\Lib\site-packages\sqlalchemy\pool\base.py", line 894, in _checkout
    fairy = _ConnectionRecord.checkout(pool)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python312\Lib\site-packages\sqlalchemy\pool\base.py", line 493, in checkout
    rec = pool._do_get()
          ^^^^^^^^^^^^^^
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python312\Lib\site-packages\sqlalchemy\pool\impl.py", line 145, in _do_get
    with util.safe_reraise():
         ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python312\Lib\site-packages\sqlalchemy\util\langhelpers.py", line 70, in __exit__
    compat.raise_(
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python312\Lib\site-packages\sqlalchemy\util\compat.py", line 211, in raise_
    raise exception
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python312\Lib\site-packages\sqlalchemy\pool\impl.py", line 143, in _do_get
    return self._create_connection()
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python312\Lib\site-packages\sqlalchemy\pool\base.py", line 273, in _create_connection
    return _ConnectionRecord(self)
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python312\Lib\site-packages\sqlalchemy\pool\base.py", line 388, in __init__
    self.__connect()
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python312\Lib\site-packages\sqlalchemy\pool\base.py", line 690, in __connect
    with util.safe_reraise():
         ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python312\Lib\site-packages\sqlalchemy\util\langhelpers.py", line 70, in __exit__
    compat.raise_(
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python312\Lib\site-packages\sqlalchemy\util\compat.py", line 211, in raise_
    raise exception
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python312\Lib\site-packages\sqlalchemy\pool\base.py", line 686, in __connect
    self.dbapi_connection = connection = pool._invoke_creator(self)
                                         ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python312\Lib\site-packages\sqlalchemy\engine\create.py", line 574, in connect
    return dialect.connect(*cargs, **cparams)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python312\Lib\site-packages\sqlalchemy\engine\default.py", line 598, in connect
    return self.dbapi.connect(*cargs, **cparams)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python312\Lib\site-packages\pymysql\connections.py", line 358, in __init__
    self.connect()
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python312\Lib\site-packages\pymysql\connections.py", line 663, in connect
    self._get_server_information()
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python312\Lib\site-packages\pymysql\connections.py", line 1099, in _get_server_information
    packet = self._read_packet()
             ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python312\Lib\site-packages\pymysql\connections.py", line 772, in _read_packet
    packet.raise_for_error()
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python312\Lib\site-packages\pymysql\protocol.py", line 221, in raise_for_error
    err.raise_mysql_exception(self._data)
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python312\Lib\site-packages\pymysql\err.py", line 143, in raise_mysql_exception
    raise errorclass(errno, errval)
sqlalchemy.exc.OperationalError: (pymysql.err.OperationalError) (1130, "171.221.65.43' is not allowed to connect to this MySQL server")
(Background on this error at: https://sqlalche.me/e/14/e3q8)
2025-04-18 19:37:43,888 - root - INFO - Database session closed for incremental sync.
2025-04-18 19:37:43,888 - root - INFO - Sync process finished for type: incremental
2025-04-21 10:35:52,118 - root - INFO - Logger initialized with level: INFO. Logging to console and file: D:\cursor开发工程\BI\logs\app.log
2025-04-21 10:35:52,118 - root - INFO - Starting sync process with type: incremental
2025-04-21 10:35:52,118 - root - INFO - Starting Xiaoe incremental order sync...
2025-04-21 10:35:52,127 - root - ERROR - Failed to get last sync timestamp for xiaoe/order/incremental: (pymysql.err.OperationalError) (2003, "Can't connect to MySQL server on '$$wOrd_L0c@l_MySql_2O24!@127.0.0.1' ([Errno 11003] getaddrinfo failed)")
(Background on this error at: https://sqlalche.me/e/14/e3q8)
Traceback (most recent call last):
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python312\Lib\site-packages\pymysql\connections.py", line 644, in connect
    sock = socket.create_connection(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python312\Lib\socket.py", line 841, in create_connection
    for res in getaddrinfo(host, port, 0, SOCK_STREAM):
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python312\Lib\socket.py", line 978, in getaddrinfo
    for res in _socket.getaddrinfo(host, port, family, type, proto, flags):
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
socket.gaierror: [Errno 11003] getaddrinfo failed

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python312\Lib\site-packages\sqlalchemy\engine\base.py", line 3371, in _wrap_pool_connect
    return fn()
           ^^^^
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python312\Lib\site-packages\sqlalchemy\pool\base.py", line 327, in connect
    return _ConnectionFairy._checkout(self)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python312\Lib\site-packages\sqlalchemy\pool\base.py", line 894, in _checkout
    fairy = _ConnectionRecord.checkout(pool)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python312\Lib\site-packages\sqlalchemy\pool\base.py", line 493, in checkout
    rec = pool._do_get()
          ^^^^^^^^^^^^^^
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python312\Lib\site-packages\sqlalchemy\pool\impl.py", line 145, in _do_get
    with util.safe_reraise():
         ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python312\Lib\site-packages\sqlalchemy\util\langhelpers.py", line 70, in __exit__
    compat.raise_(
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python312\Lib\site-packages\sqlalchemy\util\compat.py", line 211, in raise_
    raise exception
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python312\Lib\site-packages\sqlalchemy\pool\impl.py", line 143, in _do_get
    return self._create_connection()
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python312\Lib\site-packages\sqlalchemy\pool\base.py", line 273, in _create_connection
    return _ConnectionRecord(self)
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python312\Lib\site-packages\sqlalchemy\pool\base.py", line 388, in __init__
    self.__connect()
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python312\Lib\site-packages\sqlalchemy\pool\base.py", line 690, in __connect
    with util.safe_reraise():
         ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python312\Lib\site-packages\sqlalchemy\util\langhelpers.py", line 70, in __exit__
    compat.raise_(
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python312\Lib\site-packages\sqlalchemy\util\compat.py", line 211, in raise_
    raise exception
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python312\Lib\site-packages\sqlalchemy\pool\base.py", line 686, in __connect
    self.dbapi_connection = connection = pool._invoke_creator(self)
                                         ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python312\Lib\site-packages\sqlalchemy\engine\create.py", line 574, in connect
    return dialect.connect(*cargs, **cparams)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python312\Lib\site-packages\sqlalchemy\engine\default.py", line 598, in connect
    return self.dbapi.connect(*cargs, **cparams)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python312\Lib\site-packages\pymysql\connections.py", line 358, in __init__
    self.connect()
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python312\Lib\site-packages\pymysql\connections.py", line 711, in connect
    raise exc
pymysql.err.OperationalError: (2003, "Can't connect to MySQL server on '$$wOrd_L0c@l_MySql_2O24!@127.0.0.1' ([Errno 11003] getaddrinfo failed)")

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "D:\cursor开发工程\BI\scripts\sync_xiaoe.py", line 71, in get_last_sync_timestamp
    ).order_by(SyncStatus.last_sync_timestamp.desc()).first()
                                                      ^^^^^^^
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python312\Lib\site-packages\sqlalchemy\orm\query.py", line 2824, in first
    return self.limit(1)._iter().first()
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python312\Lib\site-packages\sqlalchemy\orm\query.py", line 2916, in _iter
    result = self.session.execute(
             ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python312\Lib\site-packages\sqlalchemy\orm\session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python312\Lib\site-packages\sqlalchemy\orm\session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python312\Lib\site-packages\sqlalchemy\orm\session.py", line 750, in _connection_for_bind
    conn = bind.connect()
           ^^^^^^^^^^^^^^
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python312\Lib\site-packages\sqlalchemy\engine\base.py", line 3325, in connect
    return self._connection_cls(self, close_with_result=close_with_result)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python312\Lib\site-packages\sqlalchemy\engine\base.py", line 96, in __init__
    else engine.raw_connection()
         ^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python312\Lib\site-packages\sqlalchemy\engine\base.py", line 3404, in raw_connection
    return self._wrap_pool_connect(self.pool.connect, _connection)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python312\Lib\site-packages\sqlalchemy\engine\base.py", line 3374, in _wrap_pool_connect
    Connection._handle_dbapi_exception_noconnection(
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python312\Lib\site-packages\sqlalchemy\engine\base.py", line 2208, in _handle_dbapi_exception_noconnection
    util.raise_(
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python312\Lib\site-packages\sqlalchemy\util\compat.py", line 211, in raise_
    raise exception
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python312\Lib\site-packages\sqlalchemy\engine\base.py", line 3371, in _wrap_pool_connect
    return fn()
           ^^^^
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python312\Lib\site-packages\sqlalchemy\pool\base.py", line 327, in connect
    return _ConnectionFairy._checkout(self)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python312\Lib\site-packages\sqlalchemy\pool\base.py", line 894, in _checkout
    fairy = _ConnectionRecord.checkout(pool)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python312\Lib\site-packages\sqlalchemy\pool\base.py", line 493, in checkout
    rec = pool._do_get()
          ^^^^^^^^^^^^^^
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python312\Lib\site-packages\sqlalchemy\pool\impl.py", line 145, in _do_get
    with util.safe_reraise():
         ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python312\Lib\site-packages\sqlalchemy\util\langhelpers.py", line 70, in __exit__
    compat.raise_(
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python312\Lib\site-packages\sqlalchemy\util\compat.py", line 211, in raise_
    raise exception
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python312\Lib\site-packages\sqlalchemy\pool\impl.py", line 143, in _do_get
    return self._create_connection()
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python312\Lib\site-packages\sqlalchemy\pool\base.py", line 273, in _create_connection
    return _ConnectionRecord(self)
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python312\Lib\site-packages\sqlalchemy\pool\base.py", line 388, in __init__
    self.__connect()
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python312\Lib\site-packages\sqlalchemy\pool\base.py", line 690, in __connect
    with util.safe_reraise():
         ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python312\Lib\site-packages\sqlalchemy\util\langhelpers.py", line 70, in __exit__
    compat.raise_(
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python312\Lib\site-packages\sqlalchemy\util\compat.py", line 211, in raise_
    raise exception
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python312\Lib\site-packages\sqlalchemy\pool\base.py", line 686, in __connect
    self.dbapi_connection = connection = pool._invoke_creator(self)
                                         ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python312\Lib\site-packages\sqlalchemy\engine\create.py", line 574, in connect
    return dialect.connect(*cargs, **cparams)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python312\Lib\site-packages\sqlalchemy\engine\default.py", line 598, in connect
    return self.dbapi.connect(*cargs, **cparams)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python312\Lib\site-packages\pymysql\connections.py", line 358, in __init__
    self.connect()
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python312\Lib\site-packages\pymysql\connections.py", line 711, in connect
    raise exc
sqlalchemy.exc.OperationalError: (pymysql.err.OperationalError) (2003, "Can't connect to MySQL server on '$$wOrd_L0c@l_MySql_2O24!@127.0.0.1' ([Errno 11003] getaddrinfo failed)")
(Background on this error at: https://sqlalche.me/e/14/e3q8)
2025-04-21 10:35:52,138 - root - WARNING - No last sync timestamp found. Starting sync from 2025-04-20T02:35:52.118081+00:00
2025-04-21 10:35:52,138 - root - INFO - XiaoeClient initialized.
2025-04-21 10:35:52,138 - root - INFO - Fetching page 1 of orders (state=2, size=50) from 2025-04-20 02:35:53 to 2025-04-21 02:35:52
2025-04-21 10:35:52,138 - root - INFO - Temporarily fetching ALL order states for page 1 to bypass API error 40004.
2025-04-21 10:35:52,138 - root - INFO - Fetching orders: page=1, size=50, start=2025-04-20 02:35:53, end=2025-04-21 02:35:52, state=None
2025-04-21 10:35:52,138 - root - INFO - Attempting to get new Xiaoe access token...
2025-04-21 10:35:52,601 - root - INFO - Successfully obtained Xiaoe access token. Expires around: 2025-04-21 12:35:52
2025-04-21 10:35:55,023 - root - ERROR - Xiaoe API returned error. Endpoint: orders, Code: 1002, Msg: api sick
2025-04-21 10:35:55,028 - root - ERROR - Unexpected error during Xiaoe API request for orders: Xiaoe API returned error. Endpoint: orders, Code: 1002, Msg: api sick
Traceback (most recent call last):
  File "D:\cursor开发工程\BI\platforms\xiaoe\client.py", line 134, in _make_request
    raise XiaoeRequestError(error_msg)
platforms.xiaoe.client.XiaoeRequestError: Xiaoe API returned error. Endpoint: orders, Code: 1002, Msg: api sick
2025-04-21 10:35:55,028 - root - ERROR - API error fetching page 1: Unexpected error for endpoint orders: Xiaoe API returned error. Endpoint: orders, Code: 1002, Msg: api sick
Traceback (most recent call last):
  File "D:\cursor开发工程\BI\platforms\xiaoe\client.py", line 134, in _make_request
    raise XiaoeRequestError(error_msg)
platforms.xiaoe.client.XiaoeRequestError: Xiaoe API returned error. Endpoint: orders, Code: 1002, Msg: api sick

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "D:\cursor开发工程\BI\scripts\sync_xiaoe.py", line 141, in run_incremental_sync
    response_data = client.get_orders(page=page, page_size=page_size, start_time=start_time_str, end_time=end_time_str)
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\cursor开发工程\BI\platforms\xiaoe\client.py", line 163, in get_orders
    return self._make_request('orders', method='POST', user_params=user_params)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\cursor开发工程\BI\platforms\xiaoe\client.py", line 144, in _make_request
    raise XiaoeRequestError(f"Unexpected error for endpoint {endpoint_key}: {e}") from e
platforms.xiaoe.client.XiaoeRequestError: Unexpected error for endpoint orders: Xiaoe API returned error. Endpoint: orders, Code: 1002, Msg: api sick
2025-04-21 10:35:55,028 - root - ERROR - Xiaoe incremental order sync failed: API error fetching page 1: Unexpected error for endpoint orders: Xiaoe API returned error. Endpoint: orders, Code: 1002, Msg: api sick
Traceback (most recent call last):
  File "D:\cursor开发工程\BI\platforms\xiaoe\client.py", line 134, in _make_request
    raise XiaoeRequestError(error_msg)
platforms.xiaoe.client.XiaoeRequestError: Xiaoe API returned error. Endpoint: orders, Code: 1002, Msg: api sick

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "D:\cursor开发工程\BI\scripts\sync_xiaoe.py", line 141, in run_incremental_sync
    response_data = client.get_orders(page=page, page_size=page_size, start_time=start_time_str, end_time=end_time_str)
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\cursor开发工程\BI\platforms\xiaoe\client.py", line 163, in get_orders
    return self._make_request('orders', method='POST', user_params=user_params)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\cursor开发工程\BI\platforms\xiaoe\client.py", line 144, in _make_request
    raise XiaoeRequestError(f"Unexpected error for endpoint {endpoint_key}: {e}") from e
platforms.xiaoe.client.XiaoeRequestError: Unexpected error for endpoint orders: Xiaoe API returned error. Endpoint: orders, Code: 1002, Msg: api sick
2025-04-21 10:35:55,032 - root - ERROR - Failed to update sync status for xiaoe/order/incremental: (pymysql.err.OperationalError) (2003, "Can't connect to MySQL server on '$$wOrd_L0c@l_MySql_2O24!@127.0.0.1' ([Errno 11003] getaddrinfo failed)")
(Background on this error at: https://sqlalche.me/e/14/e3q8)
Traceback (most recent call last):
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python312\Lib\site-packages\pymysql\connections.py", line 644, in connect
    sock = socket.create_connection(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python312\Lib\socket.py", line 841, in create_connection
    for res in getaddrinfo(host, port, 0, SOCK_STREAM):
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python312\Lib\socket.py", line 978, in getaddrinfo
    for res in _socket.getaddrinfo(host, port, family, type, proto, flags):
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
socket.gaierror: [Errno 11003] getaddrinfo failed

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python312\Lib\site-packages\sqlalchemy\engine\base.py", line 3371, in _wrap_pool_connect
    return fn()
           ^^^^
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python312\Lib\site-packages\sqlalchemy\pool\base.py", line 327, in connect
    return _ConnectionFairy._checkout(self)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python312\Lib\site-packages\sqlalchemy\pool\base.py", line 894, in _checkout
    fairy = _ConnectionRecord.checkout(pool)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python312\Lib\site-packages\sqlalchemy\pool\base.py", line 493, in checkout
    rec = pool._do_get()
          ^^^^^^^^^^^^^^
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python312\Lib\site-packages\sqlalchemy\pool\impl.py", line 145, in _do_get
    with util.safe_reraise():
         ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python312\Lib\site-packages\sqlalchemy\util\langhelpers.py", line 70, in __exit__
    compat.raise_(
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python312\Lib\site-packages\sqlalchemy\util\compat.py", line 211, in raise_
    raise exception
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python312\Lib\site-packages\sqlalchemy\pool\impl.py", line 143, in _do_get
    return self._create_connection()
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python312\Lib\site-packages\sqlalchemy\pool\base.py", line 273, in _create_connection
    return _ConnectionRecord(self)
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python312\Lib\site-packages\sqlalchemy\pool\base.py", line 388, in __init__
    self.__connect()
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python312\Lib\site-packages\sqlalchemy\pool\base.py", line 690, in __connect
    with util.safe_reraise():
         ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python312\Lib\site-packages\sqlalchemy\util\langhelpers.py", line 70, in __exit__
    compat.raise_(
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python312\Lib\site-packages\sqlalchemy\util\compat.py", line 211, in raise_
    raise exception
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python312\Lib\site-packages\sqlalchemy\pool\base.py", line 686, in __connect
    self.dbapi_connection = connection = pool._invoke_creator(self)
                                         ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python312\Lib\site-packages\sqlalchemy\engine\create.py", line 574, in connect
    return dialect.connect(*cargs, **cparams)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python312\Lib\site-packages\sqlalchemy\engine\default.py", line 598, in connect
    return self.dbapi.connect(*cargs, **cparams)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python312\Lib\site-packages\pymysql\connections.py", line 358, in __init__
    self.connect()
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python312\Lib\site-packages\pymysql\connections.py", line 711, in connect
    raise exc
pymysql.err.OperationalError: (2003, "Can't connect to MySQL server on '$$wOrd_L0c@l_MySql_2O24!@127.0.0.1' ([Errno 11003] getaddrinfo failed)")

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "D:\cursor开发工程\BI\scripts\sync_xiaoe.py", line 43, in update_sync_status
    ).first()
      ^^^^^^^
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python312\Lib\site-packages\sqlalchemy\orm\query.py", line 2824, in first
    return self.limit(1)._iter().first()
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python312\Lib\site-packages\sqlalchemy\orm\query.py", line 2916, in _iter
    result = self.session.execute(
             ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python312\Lib\site-packages\sqlalchemy\orm\session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python312\Lib\site-packages\sqlalchemy\orm\session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python312\Lib\site-packages\sqlalchemy\orm\session.py", line 750, in _connection_for_bind
    conn = bind.connect()
           ^^^^^^^^^^^^^^
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python312\Lib\site-packages\sqlalchemy\engine\base.py", line 3325, in connect
    return self._connection_cls(self, close_with_result=close_with_result)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python312\Lib\site-packages\sqlalchemy\engine\base.py", line 96, in __init__
    else engine.raw_connection()
         ^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python312\Lib\site-packages\sqlalchemy\engine\base.py", line 3404, in raw_connection
    return self._wrap_pool_connect(self.pool.connect, _connection)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python312\Lib\site-packages\sqlalchemy\engine\base.py", line 3374, in _wrap_pool_connect
    Connection._handle_dbapi_exception_noconnection(
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python312\Lib\site-packages\sqlalchemy\engine\base.py", line 2208, in _handle_dbapi_exception_noconnection
    util.raise_(
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python312\Lib\site-packages\sqlalchemy\util\compat.py", line 211, in raise_
    raise exception
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python312\Lib\site-packages\sqlalchemy\engine\base.py", line 3371, in _wrap_pool_connect
    return fn()
           ^^^^
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python312\Lib\site-packages\sqlalchemy\pool\base.py", line 327, in connect
    return _ConnectionFairy._checkout(self)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python312\Lib\site-packages\sqlalchemy\pool\base.py", line 894, in _checkout
    fairy = _ConnectionRecord.checkout(pool)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python312\Lib\site-packages\sqlalchemy\pool\base.py", line 493, in checkout
    rec = pool._do_get()
          ^^^^^^^^^^^^^^
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python312\Lib\site-packages\sqlalchemy\pool\impl.py", line 145, in _do_get
    with util.safe_reraise():
         ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python312\Lib\site-packages\sqlalchemy\util\langhelpers.py", line 70, in __exit__
    compat.raise_(
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python312\Lib\site-packages\sqlalchemy\util\compat.py", line 211, in raise_
    raise exception
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python312\Lib\site-packages\sqlalchemy\pool\impl.py", line 143, in _do_get
    return self._create_connection()
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python312\Lib\site-packages\sqlalchemy\pool\base.py", line 273, in _create_connection
    return _ConnectionRecord(self)
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python312\Lib\site-packages\sqlalchemy\pool\base.py", line 388, in __init__
    self.__connect()
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python312\Lib\site-packages\sqlalchemy\pool\base.py", line 690, in __connect
    with util.safe_reraise():
         ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python312\Lib\site-packages\sqlalchemy\util\langhelpers.py", line 70, in __exit__
    compat.raise_(
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python312\Lib\site-packages\sqlalchemy\util\compat.py", line 211, in raise_
    raise exception
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python312\Lib\site-packages\sqlalchemy\pool\base.py", line 686, in __connect
    self.dbapi_connection = connection = pool._invoke_creator(self)
                                         ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python312\Lib\site-packages\sqlalchemy\engine\create.py", line 574, in connect
    return dialect.connect(*cargs, **cparams)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python312\Lib\site-packages\sqlalchemy\engine\default.py", line 598, in connect
    return self.dbapi.connect(*cargs, **cparams)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python312\Lib\site-packages\pymysql\connections.py", line 358, in __init__
    self.connect()
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python312\Lib\site-packages\pymysql\connections.py", line 711, in connect
    raise exc
sqlalchemy.exc.OperationalError: (pymysql.err.OperationalError) (2003, "Can't connect to MySQL server on '$$wOrd_L0c@l_MySql_2O24!@127.0.0.1' ([Errno 11003] getaddrinfo failed)")
(Background on this error at: https://sqlalche.me/e/14/e3q8)
2025-04-21 10:35:55,040 - root - INFO - Database session closed for incremental sync.
2025-04-21 10:35:55,041 - root - INFO - Sync process finished for type: incremental
2025-04-21 10:36:46,082 - root - INFO - Logger initialized with level: INFO. Logging to console and file: D:\cursor开发工程\BI\logs\app.log
2025-04-21 10:36:46,084 - root - INFO - Starting sync process with type: incremental
2025-04-21 10:36:46,084 - root - INFO - Starting Xiaoe incremental order sync...
2025-04-21 10:36:46,091 - root - ERROR - Failed to get last sync timestamp for xiaoe/order/incremental: (pymysql.err.OperationalError) (2003, "Can't connect to MySQL server on '$$wOrd_L0c@l_MySql_2O24!@127.0.0.1' ([Errno 11003] getaddrinfo failed)")
(Background on this error at: https://sqlalche.me/e/14/e3q8)
Traceback (most recent call last):
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python312\Lib\site-packages\pymysql\connections.py", line 644, in connect
    sock = socket.create_connection(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python312\Lib\socket.py", line 841, in create_connection
    for res in getaddrinfo(host, port, 0, SOCK_STREAM):
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python312\Lib\socket.py", line 978, in getaddrinfo
    for res in _socket.getaddrinfo(host, port, family, type, proto, flags):
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
socket.gaierror: [Errno 11003] getaddrinfo failed

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python312\Lib\site-packages\sqlalchemy\engine\base.py", line 3371, in _wrap_pool_connect
    return fn()
           ^^^^
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python312\Lib\site-packages\sqlalchemy\pool\base.py", line 327, in connect
    return _ConnectionFairy._checkout(self)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python312\Lib\site-packages\sqlalchemy\pool\base.py", line 894, in _checkout
    fairy = _ConnectionRecord.checkout(pool)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python312\Lib\site-packages\sqlalchemy\pool\base.py", line 493, in checkout
    rec = pool._do_get()
          ^^^^^^^^^^^^^^
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python312\Lib\site-packages\sqlalchemy\pool\impl.py", line 145, in _do_get
    with util.safe_reraise():
         ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python312\Lib\site-packages\sqlalchemy\util\langhelpers.py", line 70, in __exit__
    compat.raise_(
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python312\Lib\site-packages\sqlalchemy\util\compat.py", line 211, in raise_
    raise exception
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python312\Lib\site-packages\sqlalchemy\pool\impl.py", line 143, in _do_get
    return self._create_connection()
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python312\Lib\site-packages\sqlalchemy\pool\base.py", line 273, in _create_connection
    return _ConnectionRecord(self)
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python312\Lib\site-packages\sqlalchemy\pool\base.py", line 388, in __init__
    self.__connect()
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python312\Lib\site-packages\sqlalchemy\pool\base.py", line 690, in __connect
    with util.safe_reraise():
         ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python312\Lib\site-packages\sqlalchemy\util\langhelpers.py", line 70, in __exit__
    compat.raise_(
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python312\Lib\site-packages\sqlalchemy\util\compat.py", line 211, in raise_
    raise exception
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python312\Lib\site-packages\sqlalchemy\pool\base.py", line 686, in __connect
    self.dbapi_connection = connection = pool._invoke_creator(self)
                                         ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python312\Lib\site-packages\sqlalchemy\engine\create.py", line 574, in connect
    return dialect.connect(*cargs, **cparams)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python312\Lib\site-packages\sqlalchemy\engine\default.py", line 598, in connect
    return self.dbapi.connect(*cargs, **cparams)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python312\Lib\site-packages\pymysql\connections.py", line 358, in __init__
    self.connect()
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python312\Lib\site-packages\pymysql\connections.py", line 711, in connect
    raise exc
pymysql.err.OperationalError: (2003, "Can't connect to MySQL server on '$$wOrd_L0c@l_MySql_2O24!@127.0.0.1' ([Errno 11003] getaddrinfo failed)")

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "D:\cursor开发工程\BI\scripts\sync_xiaoe.py", line 71, in get_last_sync_timestamp
    ).order_by(SyncStatus.last_sync_timestamp.desc()).first()
                                                      ^^^^^^^
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python312\Lib\site-packages\sqlalchemy\orm\query.py", line 2824, in first
    return self.limit(1)._iter().first()
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python312\Lib\site-packages\sqlalchemy\orm\query.py", line 2916, in _iter
    result = self.session.execute(
             ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python312\Lib\site-packages\sqlalchemy\orm\session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python312\Lib\site-packages\sqlalchemy\orm\session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python312\Lib\site-packages\sqlalchemy\orm\session.py", line 750, in _connection_for_bind
    conn = bind.connect()
           ^^^^^^^^^^^^^^
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python312\Lib\site-packages\sqlalchemy\engine\base.py", line 3325, in connect
    return self._connection_cls(self, close_with_result=close_with_result)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python312\Lib\site-packages\sqlalchemy\engine\base.py", line 96, in __init__
    else engine.raw_connection()
         ^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python312\Lib\site-packages\sqlalchemy\engine\base.py", line 3404, in raw_connection
    return self._wrap_pool_connect(self.pool.connect, _connection)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python312\Lib\site-packages\sqlalchemy\engine\base.py", line 3374, in _wrap_pool_connect
    Connection._handle_dbapi_exception_noconnection(
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python312\Lib\site-packages\sqlalchemy\engine\base.py", line 2208, in _handle_dbapi_exception_noconnection
    util.raise_(
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python312\Lib\site-packages\sqlalchemy\util\compat.py", line 211, in raise_
    raise exception
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python312\Lib\site-packages\sqlalchemy\engine\base.py", line 3371, in _wrap_pool_connect
    return fn()
           ^^^^
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python312\Lib\site-packages\sqlalchemy\pool\base.py", line 327, in connect
    return _ConnectionFairy._checkout(self)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python312\Lib\site-packages\sqlalchemy\pool\base.py", line 894, in _checkout
    fairy = _ConnectionRecord.checkout(pool)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python312\Lib\site-packages\sqlalchemy\pool\base.py", line 493, in checkout
    rec = pool._do_get()
          ^^^^^^^^^^^^^^
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python312\Lib\site-packages\sqlalchemy\pool\impl.py", line 145, in _do_get
    with util.safe_reraise():
         ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python312\Lib\site-packages\sqlalchemy\util\langhelpers.py", line 70, in __exit__
    compat.raise_(
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python312\Lib\site-packages\sqlalchemy\util\compat.py", line 211, in raise_
    raise exception
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python312\Lib\site-packages\sqlalchemy\pool\impl.py", line 143, in _do_get
    return self._create_connection()
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python312\Lib\site-packages\sqlalchemy\pool\base.py", line 273, in _create_connection
    return _ConnectionRecord(self)
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python312\Lib\site-packages\sqlalchemy\pool\base.py", line 388, in __init__
    self.__connect()
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python312\Lib\site-packages\sqlalchemy\pool\base.py", line 690, in __connect
    with util.safe_reraise():
         ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python312\Lib\site-packages\sqlalchemy\util\langhelpers.py", line 70, in __exit__
    compat.raise_(
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python312\Lib\site-packages\sqlalchemy\util\compat.py", line 211, in raise_
    raise exception
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python312\Lib\site-packages\sqlalchemy\pool\base.py", line 686, in __connect
    self.dbapi_connection = connection = pool._invoke_creator(self)
                                         ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python312\Lib\site-packages\sqlalchemy\engine\create.py", line 574, in connect
    return dialect.connect(*cargs, **cparams)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python312\Lib\site-packages\sqlalchemy\engine\default.py", line 598, in connect
    return self.dbapi.connect(*cargs, **cparams)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python312\Lib\site-packages\pymysql\connections.py", line 358, in __init__
    self.connect()
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python312\Lib\site-packages\pymysql\connections.py", line 711, in connect
    raise exc
sqlalchemy.exc.OperationalError: (pymysql.err.OperationalError) (2003, "Can't connect to MySQL server on '$$wOrd_L0c@l_MySql_2O24!@127.0.0.1' ([Errno 11003] getaddrinfo failed)")
(Background on this error at: https://sqlalche.me/e/14/e3q8)
2025-04-21 10:36:46,101 - root - WARNING - No last sync timestamp found. Starting sync from 2025-04-20T02:36:46.084438+00:00
2025-04-21 10:36:46,101 - root - INFO - XiaoeClient initialized.
2025-04-21 10:36:46,101 - root - INFO - Fetching page 1 of orders (state=2, size=50) from 2025-04-20 02:36:47 to 2025-04-21 02:36:46
2025-04-21 10:36:46,101 - root - INFO - Temporarily fetching ALL order states for page 1 to bypass API error 40004.
2025-04-21 10:36:46,102 - root - INFO - Fetching orders: page=1, size=50, start=2025-04-20 02:36:47, end=2025-04-21 02:36:46, state=None
2025-04-21 10:36:46,102 - root - INFO - Attempting to get new Xiaoe access token...
2025-04-21 10:36:46,572 - root - INFO - Successfully obtained Xiaoe access token. Expires around: 2025-04-21 12:36:46
2025-04-21 10:36:48,760 - root - ERROR - Xiaoe API returned error. Endpoint: orders, Code: 1002, Msg: api sick
2025-04-21 10:36:48,760 - root - ERROR - Unexpected error during Xiaoe API request for orders: Xiaoe API returned error. Endpoint: orders, Code: 1002, Msg: api sick
Traceback (most recent call last):
  File "D:\cursor开发工程\BI\platforms\xiaoe\client.py", line 134, in _make_request
    raise XiaoeRequestError(error_msg)
platforms.xiaoe.client.XiaoeRequestError: Xiaoe API returned error. Endpoint: orders, Code: 1002, Msg: api sick
2025-04-21 10:36:48,760 - root - ERROR - API error fetching page 1: Unexpected error for endpoint orders: Xiaoe API returned error. Endpoint: orders, Code: 1002, Msg: api sick
Traceback (most recent call last):
  File "D:\cursor开发工程\BI\platforms\xiaoe\client.py", line 134, in _make_request
    raise XiaoeRequestError(error_msg)
platforms.xiaoe.client.XiaoeRequestError: Xiaoe API returned error. Endpoint: orders, Code: 1002, Msg: api sick

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "D:\cursor开发工程\BI\scripts\sync_xiaoe.py", line 141, in run_incremental_sync
    response_data = client.get_orders(page=page, page_size=page_size, start_time=start_time_str, end_time=end_time_str)
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\cursor开发工程\BI\platforms\xiaoe\client.py", line 163, in get_orders
    return self._make_request('orders', method='POST', user_params=user_params)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\cursor开发工程\BI\platforms\xiaoe\client.py", line 144, in _make_request
    raise XiaoeRequestError(f"Unexpected error for endpoint {endpoint_key}: {e}") from e
platforms.xiaoe.client.XiaoeRequestError: Unexpected error for endpoint orders: Xiaoe API returned error. Endpoint: orders, Code: 1002, Msg: api sick
2025-04-21 10:36:48,761 - root - ERROR - Xiaoe incremental order sync failed: API error fetching page 1: Unexpected error for endpoint orders: Xiaoe API returned error. Endpoint: orders, Code: 1002, Msg: api sick
Traceback (most recent call last):
  File "D:\cursor开发工程\BI\platforms\xiaoe\client.py", line 134, in _make_request
    raise XiaoeRequestError(error_msg)
platforms.xiaoe.client.XiaoeRequestError: Xiaoe API returned error. Endpoint: orders, Code: 1002, Msg: api sick

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "D:\cursor开发工程\BI\scripts\sync_xiaoe.py", line 141, in run_incremental_sync
    response_data = client.get_orders(page=page, page_size=page_size, start_time=start_time_str, end_time=end_time_str)
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\cursor开发工程\BI\platforms\xiaoe\client.py", line 163, in get_orders
    return self._make_request('orders', method='POST', user_params=user_params)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\cursor开发工程\BI\platforms\xiaoe\client.py", line 144, in _make_request
    raise XiaoeRequestError(f"Unexpected error for endpoint {endpoint_key}: {e}") from e
platforms.xiaoe.client.XiaoeRequestError: Unexpected error for endpoint orders: Xiaoe API returned error. Endpoint: orders, Code: 1002, Msg: api sick
2025-04-21 10:36:48,763 - root - ERROR - Failed to update sync status for xiaoe/order/incremental: (pymysql.err.OperationalError) (2003, "Can't connect to MySQL server on '$$wOrd_L0c@l_MySql_2O24!@127.0.0.1' ([Errno 11003] getaddrinfo failed)")
(Background on this error at: https://sqlalche.me/e/14/e3q8)
Traceback (most recent call last):
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python312\Lib\site-packages\pymysql\connections.py", line 644, in connect
    sock = socket.create_connection(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python312\Lib\socket.py", line 841, in create_connection
    for res in getaddrinfo(host, port, 0, SOCK_STREAM):
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python312\Lib\socket.py", line 978, in getaddrinfo
    for res in _socket.getaddrinfo(host, port, family, type, proto, flags):
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
socket.gaierror: [Errno 11003] getaddrinfo failed

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python312\Lib\site-packages\sqlalchemy\engine\base.py", line 3371, in _wrap_pool_connect
    return fn()
           ^^^^
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python312\Lib\site-packages\sqlalchemy\pool\base.py", line 327, in connect
    return _ConnectionFairy._checkout(self)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python312\Lib\site-packages\sqlalchemy\pool\base.py", line 894, in _checkout
    fairy = _ConnectionRecord.checkout(pool)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python312\Lib\site-packages\sqlalchemy\pool\base.py", line 493, in checkout
    rec = pool._do_get()
          ^^^^^^^^^^^^^^
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python312\Lib\site-packages\sqlalchemy\pool\impl.py", line 145, in _do_get
    with util.safe_reraise():
         ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python312\Lib\site-packages\sqlalchemy\util\langhelpers.py", line 70, in __exit__
    compat.raise_(
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python312\Lib\site-packages\sqlalchemy\util\compat.py", line 211, in raise_
    raise exception
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python312\Lib\site-packages\sqlalchemy\pool\impl.py", line 143, in _do_get
    return self._create_connection()
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python312\Lib\site-packages\sqlalchemy\pool\base.py", line 273, in _create_connection
    return _ConnectionRecord(self)
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python312\Lib\site-packages\sqlalchemy\pool\base.py", line 388, in __init__
    self.__connect()
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python312\Lib\site-packages\sqlalchemy\pool\base.py", line 690, in __connect
    with util.safe_reraise():
         ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python312\Lib\site-packages\sqlalchemy\util\langhelpers.py", line 70, in __exit__
    compat.raise_(
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python312\Lib\site-packages\sqlalchemy\util\compat.py", line 211, in raise_
    raise exception
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python312\Lib\site-packages\sqlalchemy\pool\base.py", line 686, in __connect
    self.dbapi_connection = connection = pool._invoke_creator(self)
                                         ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python312\Lib\site-packages\sqlalchemy\engine\create.py", line 574, in connect
    return dialect.connect(*cargs, **cparams)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python312\Lib\site-packages\sqlalchemy\engine\default.py", line 598, in connect
    return self.dbapi.connect(*cargs, **cparams)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python312\Lib\site-packages\pymysql\connections.py", line 358, in __init__
    self.connect()
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python312\Lib\site-packages\pymysql\connections.py", line 711, in connect
    raise exc
pymysql.err.OperationalError: (2003, "Can't connect to MySQL server on '$$wOrd_L0c@l_MySql_2O24!@127.0.0.1' ([Errno 11003] getaddrinfo failed)")

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "D:\cursor开发工程\BI\scripts\sync_xiaoe.py", line 43, in update_sync_status
    ).first()
      ^^^^^^^
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python312\Lib\site-packages\sqlalchemy\orm\query.py", line 2824, in first
    return self.limit(1)._iter().first()
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python312\Lib\site-packages\sqlalchemy\orm\query.py", line 2916, in _iter
    result = self.session.execute(
             ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python312\Lib\site-packages\sqlalchemy\orm\session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python312\Lib\site-packages\sqlalchemy\orm\session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python312\Lib\site-packages\sqlalchemy\orm\session.py", line 750, in _connection_for_bind
    conn = bind.connect()
           ^^^^^^^^^^^^^^
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python312\Lib\site-packages\sqlalchemy\engine\base.py", line 3325, in connect
    return self._connection_cls(self, close_with_result=close_with_result)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python312\Lib\site-packages\sqlalchemy\engine\base.py", line 96, in __init__
    else engine.raw_connection()
         ^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python312\Lib\site-packages\sqlalchemy\engine\base.py", line 3404, in raw_connection
    return self._wrap_pool_connect(self.pool.connect, _connection)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python312\Lib\site-packages\sqlalchemy\engine\base.py", line 3374, in _wrap_pool_connect
    Connection._handle_dbapi_exception_noconnection(
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python312\Lib\site-packages\sqlalchemy\engine\base.py", line 2208, in _handle_dbapi_exception_noconnection
    util.raise_(
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python312\Lib\site-packages\sqlalchemy\util\compat.py", line 211, in raise_
    raise exception
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python312\Lib\site-packages\sqlalchemy\engine\base.py", line 3371, in _wrap_pool_connect
    return fn()
           ^^^^
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python312\Lib\site-packages\sqlalchemy\pool\base.py", line 327, in connect
    return _ConnectionFairy._checkout(self)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python312\Lib\site-packages\sqlalchemy\pool\base.py", line 894, in _checkout
    fairy = _ConnectionRecord.checkout(pool)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python312\Lib\site-packages\sqlalchemy\pool\base.py", line 493, in checkout
    rec = pool._do_get()
          ^^^^^^^^^^^^^^
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python312\Lib\site-packages\sqlalchemy\pool\impl.py", line 145, in _do_get
    with util.safe_reraise():
         ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python312\Lib\site-packages\sqlalchemy\util\langhelpers.py", line 70, in __exit__
    compat.raise_(
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python312\Lib\site-packages\sqlalchemy\util\compat.py", line 211, in raise_
    raise exception
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python312\Lib\site-packages\sqlalchemy\pool\impl.py", line 143, in _do_get
    return self._create_connection()
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python312\Lib\site-packages\sqlalchemy\pool\base.py", line 273, in _create_connection
    return _ConnectionRecord(self)
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python312\Lib\site-packages\sqlalchemy\pool\base.py", line 388, in __init__
    self.__connect()
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python312\Lib\site-packages\sqlalchemy\pool\base.py", line 690, in __connect
    with util.safe_reraise():
         ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python312\Lib\site-packages\sqlalchemy\util\langhelpers.py", line 70, in __exit__
    compat.raise_(
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python312\Lib\site-packages\sqlalchemy\util\compat.py", line 211, in raise_
    raise exception
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python312\Lib\site-packages\sqlalchemy\pool\base.py", line 686, in __connect
    self.dbapi_connection = connection = pool._invoke_creator(self)
                                         ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python312\Lib\site-packages\sqlalchemy\engine\create.py", line 574, in connect
    return dialect.connect(*cargs, **cparams)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python312\Lib\site-packages\sqlalchemy\engine\default.py", line 598, in connect
    return self.dbapi.connect(*cargs, **cparams)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python312\Lib\site-packages\pymysql\connections.py", line 358, in __init__
    self.connect()
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python312\Lib\site-packages\pymysql\connections.py", line 711, in connect
    raise exc
sqlalchemy.exc.OperationalError: (pymysql.err.OperationalError) (2003, "Can't connect to MySQL server on '$$wOrd_L0c@l_MySql_2O24!@127.0.0.1' ([Errno 11003] getaddrinfo failed)")
(Background on this error at: https://sqlalche.me/e/14/e3q8)
2025-04-21 10:36:48,771 - root - INFO - Database session closed for incremental sync.
2025-04-21 10:36:48,771 - root - INFO - Sync process finished for type: incremental
2025-04-21 10:43:07,802 - root - INFO - Logger initialized with level: INFO. Logging to console and file: D:\cursor开发工程\BI\logs\app.log
2025-04-21 10:43:07,803 - root - INFO - Starting sync process with type: incremental
2025-04-21 10:43:07,803 - root - INFO - Starting Xiaoe incremental order sync...
2025-04-21 10:43:07,810 - root - INFO - No previous successful sync timestamp found for xiaoe/order/incremental. Will sync from beginning or default.
2025-04-21 10:43:07,810 - root - WARNING - No last sync timestamp found. Starting sync from 2025-04-20T02:43:07.803679+00:00
2025-04-21 10:43:07,810 - root - INFO - XiaoeClient initialized.
2025-04-21 10:43:07,810 - root - INFO - Fetching page 1 of orders (state=2, size=50) from 2025-04-20 02:43:08 to 2025-04-21 02:43:07
2025-04-21 10:43:07,810 - root - INFO - Temporarily fetching ALL order states for page 1 to bypass API error 40004.
2025-04-21 10:43:07,810 - root - INFO - Fetching orders: page=1, size=50, start=2025-04-20 02:43:08, end=2025-04-21 02:43:07, state=None
2025-04-21 10:43:07,810 - root - INFO - Attempting to get new Xiaoe access token...
2025-04-21 10:43:08,281 - root - INFO - Successfully obtained Xiaoe access token. Expires around: 2025-04-21 12:43:08
2025-04-21 10:43:10,580 - root - ERROR - Xiaoe API returned error. Endpoint: orders, Code: 1002, Msg: api sick
2025-04-21 10:43:10,580 - root - ERROR - Unexpected error during Xiaoe API request for orders: Xiaoe API returned error. Endpoint: orders, Code: 1002, Msg: api sick
Traceback (most recent call last):
  File "D:\cursor开发工程\BI\platforms\xiaoe\client.py", line 134, in _make_request
    raise XiaoeRequestError(error_msg)
platforms.xiaoe.client.XiaoeRequestError: Xiaoe API returned error. Endpoint: orders, Code: 1002, Msg: api sick
2025-04-21 10:43:10,581 - root - ERROR - API error fetching page 1: Unexpected error for endpoint orders: Xiaoe API returned error. Endpoint: orders, Code: 1002, Msg: api sick
Traceback (most recent call last):
  File "D:\cursor开发工程\BI\platforms\xiaoe\client.py", line 134, in _make_request
    raise XiaoeRequestError(error_msg)
platforms.xiaoe.client.XiaoeRequestError: Xiaoe API returned error. Endpoint: orders, Code: 1002, Msg: api sick

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "D:\cursor开发工程\BI\scripts\sync_xiaoe.py", line 141, in run_incremental_sync
    response_data = client.get_orders(page=page, page_size=page_size, start_time=start_time_str, end_time=end_time_str)
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\cursor开发工程\BI\platforms\xiaoe\client.py", line 163, in get_orders
    return self._make_request('orders', method='POST', user_params=user_params)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\cursor开发工程\BI\platforms\xiaoe\client.py", line 144, in _make_request
    raise XiaoeRequestError(f"Unexpected error for endpoint {endpoint_key}: {e}") from e
platforms.xiaoe.client.XiaoeRequestError: Unexpected error for endpoint orders: Xiaoe API returned error. Endpoint: orders, Code: 1002, Msg: api sick
2025-04-21 10:43:10,584 - root - ERROR - Xiaoe incremental order sync failed: API error fetching page 1: Unexpected error for endpoint orders: Xiaoe API returned error. Endpoint: orders, Code: 1002, Msg: api sick
Traceback (most recent call last):
  File "D:\cursor开发工程\BI\platforms\xiaoe\client.py", line 134, in _make_request
    raise XiaoeRequestError(error_msg)
platforms.xiaoe.client.XiaoeRequestError: Xiaoe API returned error. Endpoint: orders, Code: 1002, Msg: api sick

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "D:\cursor开发工程\BI\scripts\sync_xiaoe.py", line 141, in run_incremental_sync
    response_data = client.get_orders(page=page, page_size=page_size, start_time=start_time_str, end_time=end_time_str)
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\cursor开发工程\BI\platforms\xiaoe\client.py", line 163, in get_orders
    return self._make_request('orders', method='POST', user_params=user_params)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\cursor开发工程\BI\platforms\xiaoe\client.py", line 144, in _make_request
    raise XiaoeRequestError(f"Unexpected error for endpoint {endpoint_key}: {e}") from e
platforms.xiaoe.client.XiaoeRequestError: Unexpected error for endpoint orders: Xiaoe API returned error. Endpoint: orders, Code: 1002, Msg: api sick
2025-04-21 10:43:10,592 - root - INFO - Sync status updated for xiaoe/order/incremental: failed
2025-04-21 10:43:10,593 - root - INFO - Database session closed for incremental sync.
2025-04-21 10:43:10,594 - root - INFO - Sync process finished for type: incremental
2025-04-21 10:51:52,190 - root - INFO - Logger initialized with level: INFO. Logging to console and file: D:\cursor开发工程\BI\logs\app.log
2025-04-21 10:51:52,192 - root - INFO - Starting sync process with type: incremental
2025-04-21 10:51:52,192 - root - INFO - Starting Xiaoe incremental order sync...
2025-04-21 10:51:52,201 - root - INFO - No previous successful sync timestamp found for xiaoe/order/incremental. Will sync from beginning or default.
2025-04-21 10:51:52,201 - root - WARNING - No last sync timestamp found. Starting sync from 2025-04-20T02:51:52.193244+00:00
2025-04-21 10:51:52,201 - root - INFO - XiaoeClient initialized.
2025-04-21 10:51:52,202 - root - INFO - Fetching page 1 of PAID orders (state=2, size=50) from 2025-04-20 02:51:53 to 2025-04-21 02:51:52
2025-04-21 10:51:52,202 - root - INFO - Fetching orders: page=1, size=50, start=2025-04-20 02:51:53, end=2025-04-21 02:51:52, state=2
2025-04-21 10:51:52,202 - root - INFO - Attempting to get new Xiaoe access token...
2025-04-21 10:51:52,779 - root - INFO - Successfully obtained Xiaoe access token. Expires around: 2025-04-21 12:51:52
2025-04-21 10:51:53,250 - root - ERROR - Xiaoe API returned error. Endpoint: orders, Code: 2052, Msg: invalid path
2025-04-21 10:51:53,250 - root - ERROR - Unexpected error during Xiaoe API request for orders: Xiaoe API returned error. Endpoint: orders, Code: 2052, Msg: invalid path
Traceback (most recent call last):
  File "D:\cursor开发工程\BI\platforms\xiaoe\client.py", line 134, in _make_request
    raise XiaoeRequestError(error_msg)
platforms.xiaoe.client.XiaoeRequestError: Xiaoe API returned error. Endpoint: orders, Code: 2052, Msg: invalid path
2025-04-21 10:51:53,251 - root - ERROR - API error fetching page 1: Unexpected error for endpoint orders: Xiaoe API returned error. Endpoint: orders, Code: 2052, Msg: invalid path
Traceback (most recent call last):
  File "D:\cursor开发工程\BI\platforms\xiaoe\client.py", line 134, in _make_request
    raise XiaoeRequestError(error_msg)
platforms.xiaoe.client.XiaoeRequestError: Xiaoe API returned error. Endpoint: orders, Code: 2052, Msg: invalid path

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "D:\cursor开发工程\BI\scripts\sync_xiaoe.py", line 139, in run_incremental_sync
    response_data = client.get_orders(page=page, page_size=page_size, start_time=start_time_str, end_time=end_time_str, order_state=2)
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\cursor开发工程\BI\platforms\xiaoe\client.py", line 163, in get_orders
    return self._make_request('orders', method='POST', user_params=user_params)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\cursor开发工程\BI\platforms\xiaoe\client.py", line 144, in _make_request
    raise XiaoeRequestError(f"Unexpected error for endpoint {endpoint_key}: {e}") from e
platforms.xiaoe.client.XiaoeRequestError: Unexpected error for endpoint orders: Xiaoe API returned error. Endpoint: orders, Code: 2052, Msg: invalid path
2025-04-21 10:51:53,252 - root - ERROR - Xiaoe incremental order sync failed: API error fetching page 1: Unexpected error for endpoint orders: Xiaoe API returned error. Endpoint: orders, Code: 2052, Msg: invalid path
Traceback (most recent call last):
  File "D:\cursor开发工程\BI\platforms\xiaoe\client.py", line 134, in _make_request
    raise XiaoeRequestError(error_msg)
platforms.xiaoe.client.XiaoeRequestError: Xiaoe API returned error. Endpoint: orders, Code: 2052, Msg: invalid path

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "D:\cursor开发工程\BI\scripts\sync_xiaoe.py", line 139, in run_incremental_sync
    response_data = client.get_orders(page=page, page_size=page_size, start_time=start_time_str, end_time=end_time_str, order_state=2)
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\cursor开发工程\BI\platforms\xiaoe\client.py", line 163, in get_orders
    return self._make_request('orders', method='POST', user_params=user_params)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\cursor开发工程\BI\platforms\xiaoe\client.py", line 144, in _make_request
    raise XiaoeRequestError(f"Unexpected error for endpoint {endpoint_key}: {e}") from e
platforms.xiaoe.client.XiaoeRequestError: Unexpected error for endpoint orders: Xiaoe API returned error. Endpoint: orders, Code: 2052, Msg: invalid path
2025-04-21 10:51:53,262 - root - INFO - Sync status updated for xiaoe/order/incremental: failed
2025-04-21 10:51:53,263 - root - INFO - Database session closed for incremental sync.
2025-04-21 10:51:53,263 - root - INFO - Sync process finished for type: incremental
2025-04-21 10:55:48,423 - root - INFO - Logger initialized with level: INFO. Logging to console and file: D:\cursor开发工程\BI\logs\app.log
2025-04-21 10:55:48,423 - root - INFO - Starting sync process with type: incremental
2025-04-21 10:55:48,424 - root - INFO - Starting Xiaoe incremental order sync...
2025-04-21 10:55:48,429 - root - INFO - No previous successful sync timestamp found for xiaoe/order/incremental. Will sync from beginning or default.
2025-04-21 10:55:48,429 - root - WARNING - No last sync timestamp found. Starting sync from 2025-04-20T02:55:48.424381+00:00
2025-04-21 10:55:48,429 - root - INFO - XiaoeClient initialized.
2025-04-21 10:55:48,429 - root - INFO - Fetching page 1 of PAID orders (state=2, size=50) from 2025-04-20 02:55:49 to 2025-04-21 02:55:48
2025-04-21 10:55:48,429 - root - INFO - Fetching orders: page=1, size=50, start=2025-04-20 02:55:49, end=2025-04-21 02:55:48, state=2
2025-04-21 10:55:48,429 - root - INFO - Attempting to get new Xiaoe access token...
2025-04-21 10:55:48,918 - root - INFO - Successfully obtained Xiaoe access token. Expires around: 2025-04-21 12:55:48
2025-04-21 10:55:49,376 - root - ERROR - Xiaoe API returned error. Endpoint: orders, Code: 2052, Msg: invalid path
2025-04-21 10:55:49,377 - root - ERROR - Unexpected error during Xiaoe API request for orders: Xiaoe API returned error. Endpoint: orders, Code: 2052, Msg: invalid path
Traceback (most recent call last):
  File "D:\cursor开发工程\BI\platforms\xiaoe\client.py", line 134, in _make_request
    raise XiaoeRequestError(error_msg)
platforms.xiaoe.client.XiaoeRequestError: Xiaoe API returned error. Endpoint: orders, Code: 2052, Msg: invalid path
2025-04-21 10:55:49,377 - root - ERROR - API error fetching page 1: Unexpected error for endpoint orders: Xiaoe API returned error. Endpoint: orders, Code: 2052, Msg: invalid path
Traceback (most recent call last):
  File "D:\cursor开发工程\BI\platforms\xiaoe\client.py", line 134, in _make_request
    raise XiaoeRequestError(error_msg)
platforms.xiaoe.client.XiaoeRequestError: Xiaoe API returned error. Endpoint: orders, Code: 2052, Msg: invalid path

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "D:\cursor开发工程\BI\scripts\sync_xiaoe.py", line 139, in run_incremental_sync
    response_data = client.get_orders(page=page, page_size=page_size, start_time=start_time_str, end_time=end_time_str, order_state=2)
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\cursor开发工程\BI\platforms\xiaoe\client.py", line 163, in get_orders
    return self._make_request('orders', method='POST', user_params=user_params)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\cursor开发工程\BI\platforms\xiaoe\client.py", line 144, in _make_request
    raise XiaoeRequestError(f"Unexpected error for endpoint {endpoint_key}: {e}") from e
platforms.xiaoe.client.XiaoeRequestError: Unexpected error for endpoint orders: Xiaoe API returned error. Endpoint: orders, Code: 2052, Msg: invalid path
2025-04-21 10:55:49,377 - root - ERROR - Xiaoe incremental order sync failed: API error fetching page 1: Unexpected error for endpoint orders: Xiaoe API returned error. Endpoint: orders, Code: 2052, Msg: invalid path
Traceback (most recent call last):
  File "D:\cursor开发工程\BI\platforms\xiaoe\client.py", line 134, in _make_request
    raise XiaoeRequestError(error_msg)
platforms.xiaoe.client.XiaoeRequestError: Xiaoe API returned error. Endpoint: orders, Code: 2052, Msg: invalid path

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "D:\cursor开发工程\BI\scripts\sync_xiaoe.py", line 139, in run_incremental_sync
    response_data = client.get_orders(page=page, page_size=page_size, start_time=start_time_str, end_time=end_time_str, order_state=2)
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\cursor开发工程\BI\platforms\xiaoe\client.py", line 163, in get_orders
    return self._make_request('orders', method='POST', user_params=user_params)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\cursor开发工程\BI\platforms\xiaoe\client.py", line 144, in _make_request
    raise XiaoeRequestError(f"Unexpected error for endpoint {endpoint_key}: {e}") from e
platforms.xiaoe.client.XiaoeRequestError: Unexpected error for endpoint orders: Xiaoe API returned error. Endpoint: orders, Code: 2052, Msg: invalid path
2025-04-21 10:55:49,388 - root - INFO - Sync status updated for xiaoe/order/incremental: failed
2025-04-21 10:55:49,388 - root - INFO - Database session closed for incremental sync.
2025-04-21 10:55:49,388 - root - INFO - Sync process finished for type: incremental
2025-04-21 10:56:17,450 - root - INFO - Logger initialized with level: INFO. Logging to console and file: D:\cursor开发工程\BI\logs\app.log
2025-04-21 10:56:17,451 - root - INFO - Starting sync process with type: incremental
2025-04-21 10:56:17,451 - root - INFO - Starting Xiaoe incremental order sync...
2025-04-21 10:56:17,457 - root - INFO - No previous successful sync timestamp found for xiaoe/order/incremental. Will sync from beginning or default.
2025-04-21 10:56:17,458 - root - WARNING - No last sync timestamp found. Starting sync from 2025-04-20T02:56:17.451034+00:00
2025-04-21 10:56:17,458 - root - INFO - XiaoeClient initialized.
2025-04-21 10:56:17,458 - root - INFO - Fetching page 1 of PAID orders (state=2, size=50) from 2025-04-20 02:56:18 to 2025-04-21 02:56:17
2025-04-21 10:56:17,458 - root - INFO - Fetching orders: page=1, size=50, start=2025-04-20 02:56:18, end=2025-04-21 02:56:17, state=2
2025-04-21 10:56:17,458 - root - INFO - Attempting to get new Xiaoe access token...
2025-04-21 10:56:17,939 - root - INFO - Successfully obtained Xiaoe access token. Expires around: 2025-04-21 12:56:17
2025-04-21 10:56:18,722 - root - INFO - Fetched 18 orders on page 1. Total fetched so far: 18
2025-04-21 10:56:18,722 - root - WARNING - Skipping order transformation due to missing key fields: {'buyer_info': {'avatar_url': 'http://commonresource-1252524126.cdn.xiaoeknow.com/image/default.svg', 'comment': '', 'nickname': '', 'phone_number': '', 'union_id': ''}, 'good_list': [{'buy_num': 2, 'check_state': 0, 'discounts_info': {'discount_amount_total': 0, 'discount_count': 0, 'discount_detail': []}, 'expire_desc': '长期有效', 'expire_end': '--', 'expire_start': '2025-04-11 22:23:14', 'goods_desc': '', 'goods_image': 'https://wechatapppro-1252524126.cos.ap-shanghai.myqcloud.com/app0vuxiwxw3082_727a0224-418b-467b-a874-87b97eb6ed2f.png', 'goods_name': '[绿色食品]山西黄小米 养胃油糯小米粥五谷杂粮月子米小黄米5斤', 'goods_sn': '--', 'goods_spec_desc': '净含量:2.5kg', 'period_type': 0, 'refund_state': 0, 'refund_state_desc': '--', 'relation_goods_id': '', 'relation_goods_type': 0, 'relation_goods_type_desc': '', 'resource_id': 'g_6736a6768694a_6EwELOsx27', 'resource_type': 21, 'ship_state': 1, 'ship_state_desc': '已发货', 'sku_id': 'SKU_ENT_17316348063VhT7qg6x0', 'sku_spec_code': 'ys-xm-5斤-sxth', 'spu_id': 'SPU_ENT_1731634806BHH8333E65uqn', 'spu_type': 'ENT', 'total_price': 11160, 'unit_price': 5580}], 'order_info': {'activity_type_bitmap': [], 'actual_fee': 11160, 'aftersale_show_state': 0, 'aftersale_show_state_time': '0000-00-00 00:00:00', 'app_id': 'app0vuxiwxw3082', 'channel_bus_id': '', 'channel_type': 0, 'check_state': 0, 'created_time': '2025-04-11 22:23:14', 'deduct_amount': 0, 'discount_amount': 0, 'distribute_type_bitmap': [], 'freight_actual_price': 0, 'freight_original_price': 0, 'goods_buy_num': 2, 'goods_name': '[绿色食品]山西黄小米 养胃油糯小米粥五谷杂粮月子米小黄米5斤', 'goods_original_total_price': 11160, 'goods_spu_sub_type': 'ENT', 'goods_spu_type': 1, 'modified_amount': 0, 'order_close_type': 0, 'order_id': 'E20250411222314a3h7k3V2', 'order_state': 2, 'order_state_time': '2025-04-12 10:31:28', 'order_type': 1, 'pay_state': 1, 'pay_state_time': '2025-04-11 22:23:21', 'pay_type': 1, 'refund_fee': 0, 'refund_time': '0000-00-00 00:00:00', 'relation_order_appid': '', 'relation_order_id': '', 'relation_order_type': 0, 'settle_state': 0, 'settle_state_time': '0000-00-00 00:00:00', 'share_type': 1, 'share_user_id': '', 'ship_way_choose_type': 1, 'sub_order_type': 0, 'trade_id': 't_ffd055a3ed1e41f7bb6f7006b4e52731', 'update_time': '2025-04-12 10:31:28', 'use_collection': 6, 'user_id': 'u_67f925d238fb7_cYOHdSeC8s3', 'wx_app_type': 40}, 'payment_info': {'out_order_id': '3727365556057810176', 'third_order_id': ''}, 'price_info': {'actual_price': 11160, 'freight_modified_price': 0, 'freight_price': 0, 'origin_price': 11160, 'total_modified_amount': 0, 'total_price': 11160}, 'promoter_info': {'nick_name': '', 'user_id': ''}, 'ship_info': {'city': '德阳市', 'company': '申通快递', 'confirm_time': '0001-01-01 00:00:00', 'county': '旌阳区', 'detail': '****', 'express_id': '772039913308524', 'invalid_time': '0001-01-01 00:00:00', 'phone': '138****5058', 'province': '四川省', 'receiver': '胡**', 'remark': '', 'ship_time': '2025-04-12 10:31:26', 'user_id': 'u_67f925d238fb7_cYOHdSeC8s3'}}
2025-04-21 10:56:18,724 - root - WARNING - Skipping order transformation due to missing key fields: {'buyer_info': {'avatar_url': 'http://commonresource-1252524126.cdn.xiaoeknow.com/image/default.svg', 'comment': '', 'nickname': '', 'phone_number': '', 'union_id': ''}, 'good_list': [{'buy_num': 3, 'check_state': 0, 'discounts_info': {'discount_amount_total': 0, 'discount_count': 0, 'discount_detail': []}, 'expire_desc': '长期有效', 'expire_end': '--', 'expire_start': '2025-04-12 06:53:26', 'goods_desc': '', 'goods_image': 'https://wechatapppro-1252524126.cos.ap-shanghai.myqcloud.com/app0vuxiwxw3082_727a0224-418b-467b-a874-87b97eb6ed2f.png', 'goods_name': '[绿色食品]山西黄小米 养胃油糯小米粥五谷杂粮月子米小黄米5斤', 'goods_sn': '--', 'goods_spec_desc': '净含量:2.5kg', 'period_type': 0, 'refund_state': 0, 'refund_state_desc': '--', 'relation_goods_id': '', 'relation_goods_type': 0, 'relation_goods_type_desc': '', 'resource_id': 'g_6736a6768694a_6EwELOsx27', 'resource_type': 21, 'ship_state': 1, 'ship_state_desc': '已发货', 'sku_id': 'SKU_ENT_17316348063VhT7qg6x0', 'sku_spec_code': 'ys-xm-5斤-sxth', 'spu_id': 'SPU_ENT_1731634806BHH8333E65uqn', 'spu_type': 'ENT', 'total_price': 16740, 'unit_price': 5580}, {'buy_num': 1, 'check_state': 0, 'discounts_info': {'discount_amount_total': 0, 'discount_count': 0, 'discount_detail': []}, 'expire_desc': '长期有效', 'expire_end': '--', 'expire_start': '2025-04-12 06:53:26', 'goods_desc': '', 'goods_image': 'https://wechatapppro-1252524126.cos.ap-shanghai.myqcloud.com/app0vuxiwxw3082_99046b85-e78e-4f1b-baed-9130d6c7b8a9.png', 'goods_name': '山人仙汤十六味足浴套装一月三盒组合', 'goods_sn': '--', 'goods_spec_desc': '', 'period_type': 0, 'refund_state': 0, 'refund_state_desc': '--', 'relation_goods_id': '', 'relation_goods_type': 0, 'relation_goods_type_desc': '', 'resource_id': 'g_67ee22288de06_78sBHHZT50', 'resource_type': 21, 'ship_state': 1, 'ship_state_desc': '已发货', 'sku_id': 'SKU_ENT_17436595606cnFLkL2sf', 'sku_spec_code': '--', 'spu_id': 'SPU_ENT_1743659560MvoUattn7s8Te', 'spu_type': 'ENT', 'total_price': 14880, 'unit_price': 14880}], 'order_info': {'activity_type_bitmap': [], 'actual_fee': 31620, 'aftersale_show_state': 0, 'aftersale_show_state_time': '0000-00-00 00:00:00', 'app_id': 'app0vuxiwxw3082', 'channel_bus_id': '', 'channel_type': 0, 'check_state': 0, 'created_time': '2025-04-12 06:53:27', 'deduct_amount': 0, 'discount_amount': 0, 'distribute_type_bitmap': [], 'freight_actual_price': 0, 'freight_original_price': 0, 'goods_buy_num': 4, 'goods_name': '[绿色食品]山西黄小米 养胃油糯小米粥五谷杂粮月子米小黄米5斤|山人仙汤十六味足浴套装一月三盒组合', 'goods_original_total_price': 31620, 'goods_spu_sub_type': 'ENT', 'goods_spu_type': 1, 'modified_amount': 0, 'order_close_type': 0, 'order_id': 'E20250412065326a0n4a8V2', 'order_state': 2, 'order_state_time': '2025-04-12 10:31:21', 'order_type': 1, 'pay_state': 1, 'pay_state_time': '2025-04-12 06:53:35', 'pay_type': 1, 'refund_fee': 0, 'refund_time': '0000-00-00 00:00:00', 'relation_order_appid': '', 'relation_order_id': '', 'relation_order_type': 0, 'settle_state': 0, 'settle_state_time': '0000-00-00 00:00:00', 'share_type': 1, 'share_user_id': '', 'ship_way_choose_type': 1, 'sub_order_type': 0, 'trade_id': 't_9d042350303c40768117e726cde6b771', 'update_time': '2025-04-12 10:31:21', 'use_collection': 6, 'user_id': 'u_67f99d665fb7f_DWyw2QdOfPL', 'wx_app_type': 40}, 'payment_info': {'out_order_id': '3727373578597971200', 'third_order_id': ''}, 'price_info': {'actual_price': 31620, 'freight_modified_price': 0, 'freight_price': 0, 'origin_price': 31620, 'total_modified_amount': 0, 'total_price': 31620}, 'promoter_info': {'nick_name': '', 'user_id': ''}, 'ship_info': {'city': '广州市', 'company': '申通快递', 'confirm_time': '0001-01-01 00:00:00', 'county': '番禺区', 'detail': '****', 'express_id': '772039909976977', 'invalid_time': '0001-01-01 00:00:00', 'phone': '139****2011', 'province': '广东省', 'receiver': '无*', 'remark': '', 'ship_time': '2025-04-12 10:31:19', 'user_id': 'u_67f99d665fb7f_DWyw2QdOfPL'}}
2025-04-21 10:56:18,725 - root - WARNING - Skipping order transformation due to missing key fields: {'buyer_info': {'avatar_url': 'http://commonresource-1252524126.cdn.xiaoeknow.com/image/default.svg', 'comment': '', 'nickname': '', 'phone_number': '', 'union_id': ''}, 'good_list': [{'buy_num': 2, 'check_state': 0, 'discounts_info': {'discount_amount_total': 0, 'discount_count': 0, 'discount_detail': []}, 'expire_desc': '长期有效', 'expire_end': '--', 'expire_start': '2025-04-14 16:26:27', 'goods_desc': '', 'goods_image': 'https://wechatapppro-1252524126.cos.ap-shanghai.myqcloud.com/app0vuxiwxw3082_727a0224-418b-467b-a874-87b97eb6ed2f.png', 'goods_name': '[绿色食品]山西黄小米 养胃油糯小米粥五谷杂粮月子米小黄米5斤', 'goods_sn': '--', 'goods_spec_desc': '净含量:2.5kg', 'period_type': 0, 'refund_state': 0, 'refund_state_desc': '--', 'relation_goods_id': '', 'relation_goods_type': 0, 'relation_goods_type_desc': '', 'resource_id': 'g_6736a6768694a_6EwELOsx27', 'resource_type': 21, 'ship_state': 1, 'ship_state_desc': '已发货', 'sku_id': 'SKU_ENT_17316348063VhT7qg6x0', 'sku_spec_code': 'ys-xm-5斤-sxth', 'spu_id': 'SPU_ENT_1731634806BHH8333E65uqn', 'spu_type': 'ENT', 'total_price': 11160, 'unit_price': 5580}], 'order_info': {'activity_type_bitmap': [], 'actual_fee': 11160, 'aftersale_show_state': 0, 'aftersale_show_state_time': '0000-00-00 00:00:00', 'app_id': 'app0vuxiwxw3082', 'channel_bus_id': '', 'channel_type': 0, 'check_state': 0, 'created_time': '2025-04-14 16:26:27', 'deduct_amount': 0, 'discount_amount': 0, 'distribute_type_bitmap': [], 'freight_actual_price': 0, 'freight_original_price': 0, 'goods_buy_num': 2, 'goods_name': '[绿色食品]山西黄小米 养胃油糯小米粥五谷杂粮月子米小黄米5斤', 'goods_original_total_price': 11160, 'goods_spu_sub_type': 'ENT', 'goods_spu_type': 1, 'modified_amount': 0, 'order_close_type': 0, 'order_id': 'E20250414162627a3c0xxV2', 'order_state': 2, 'order_state_time': '2025-04-14 17:24:01', 'order_type': 1, 'pay_state': 1, 'pay_state_time': '2025-04-14 16:26:33', 'pay_type': 1, 'refund_fee': 0, 'refund_time': '0000-00-00 00:00:00', 'relation_order_appid': '', 'relation_order_id': '', 'relation_order_type': 0, 'settle_state': 0, 'settle_state_time': '0000-00-00 00:00:00', 'share_type': 1, 'share_user_id': '', 'ship_way_choose_type': 1, 'sub_order_type': 0, 'trade_id': 't_48b012e227d8436d85ffff9ed7e97ef9', 'update_time': '2025-04-14 17:24:01', 'use_collection': 6, 'user_id': 'u_67fcc6b303fab_iRn3ionNBZw', 'wx_app_type': 40}, 'payment_info': {'out_order_id': '3727427891563214080', 'third_order_id': ''}, 'price_info': {'actual_price': 11160, 'freight_modified_price': 0, 'freight_price': 0, 'origin_price': 11160, 'total_modified_amount': 0, 'total_price': 11160}, 'promoter_info': {'nick_name': '', 'user_id': ''}, 'ship_info': {'city': '衡水市', 'company': '申通快递', 'confirm_time': '0001-01-01 00:00:00', 'county': '枣强县', 'detail': '****', 'express_id': '772040036833886', 'invalid_time': '0001-01-01 00:00:00', 'phone': '187****8328', 'province': '河北省', 'receiver': '吕*', 'remark': '', 'ship_time': '2025-04-14 17:08:17', 'user_id': 'u_67fcc6b303fab_iRn3ionNBZw'}}
2025-04-21 10:56:18,727 - root - WARNING - Skipping order transformation due to missing key fields: {'buyer_info': {'avatar_url': 'http://commonresource-1252524126.cdn.xiaoeknow.com/image/default.svg', 'comment': '', 'nickname': '', 'phone_number': '', 'union_id': ''}, 'good_list': [{'buy_num': 2, 'check_state': 0, 'discounts_info': {'discount_amount_total': 0, 'discount_count': 0, 'discount_detail': []}, 'expire_desc': '长期有效', 'expire_end': '--', 'expire_start': '2025-04-14 18:12:42', 'goods_desc': '', 'goods_image': 'https://wechatapppro-1252524126.cos.ap-shanghai.myqcloud.com/app0vuxiwxw3082_727a0224-418b-467b-a874-87b97eb6ed2f.png', 'goods_name': '[绿色食品]山西黄小米 养胃油糯小米粥五谷杂粮月子米小黄米5斤', 'goods_sn': '--', 'goods_spec_desc': '净含量:2.5kg', 'period_type': 0, 'refund_state': 0, 'refund_state_desc': '--', 'relation_goods_id': '', 'relation_goods_type': 0, 'relation_goods_type_desc': '', 'resource_id': 'g_6736a6768694a_6EwELOsx27', 'resource_type': 21, 'ship_state': 1, 'ship_state_desc': '已发货', 'sku_id': 'SKU_ENT_17316348063VhT7qg6x0', 'sku_spec_code': 'ys-xm-5斤-sxth', 'spu_id': 'SPU_ENT_1731634806BHH8333E65uqn', 'spu_type': 'ENT', 'total_price': 11160, 'unit_price': 5580}], 'order_info': {'activity_type_bitmap': [], 'actual_fee': 11160, 'aftersale_show_state': 0, 'aftersale_show_state_time': '0000-00-00 00:00:00', 'app_id': 'app0vuxiwxw3082', 'channel_bus_id': '', 'channel_type': 0, 'check_state': 0, 'created_time': '2025-04-14 18:12:42', 'deduct_amount': 0, 'discount_amount': 0, 'distribute_type_bitmap': [], 'freight_actual_price': 0, 'freight_original_price': 0, 'goods_buy_num': 2, 'goods_name': '[绿色食品]山西黄小米 养胃油糯小米粥五谷杂粮月子米小黄米5斤', 'goods_original_total_price': 11160, 'goods_spu_sub_type': 'ENT', 'goods_spu_type': 1, 'modified_amount': 0, 'order_close_type': 0, 'order_id': 'E20250414181242a5ukzpV2', 'order_state': 2, 'order_state_time': '2025-04-15 10:06:27', 'order_type': 1, 'pay_state': 1, 'pay_state_time': '2025-04-14 18:12:48', 'pay_type': 1, 'refund_fee': 0, 'refund_time': '0000-00-00 00:00:00', 'relation_order_appid': '', 'relation_order_id': '', 'relation_order_type': 0, 'settle_state': 0, 'settle_state_time': '0000-00-00 00:00:00', 'share_type': 1, 'share_user_id': '', 'ship_way_choose_type': 1, 'sub_order_type': 0, 'trade_id': 't_460a743e2fde4b3a9385bf332e65e5a9', 'update_time': '2025-04-15 10:06:27', 'use_collection': 6, 'user_id': 'u_67fcdf9a244bd_Rp2TvhHwxek', 'wx_app_type': 40}, 'payment_info': {'out_order_id': '3727429561109061888', 'third_order_id': ''}, 'price_info': {'actual_price': 11160, 'freight_modified_price': 0, 'freight_price': 0, 'origin_price': 11160, 'total_modified_amount': 0, 'total_price': 11160}, 'promoter_info': {'nick_name': '', 'user_id': ''}, 'ship_info': {'city': '连云港市', 'company': '申通快递', 'confirm_time': '0001-01-01 00:00:00', 'county': '海州区', 'detail': '****', 'express_id': '772039994542615', 'invalid_time': '0001-01-01 00:00:00', 'phone': '137****9427', 'province': '江苏省', 'receiver': '李**', 'remark': '', 'ship_time': '2025-04-15 10:06:25', 'user_id': 'u_67fcdf9a244bd_Rp2TvhHwxek'}}
2025-04-21 10:56:18,728 - root - WARNING - Skipping order transformation due to missing key fields: {'buyer_info': {'avatar_url': 'http://commonresource-1252524126.cdn.xiaoeknow.com/image/default.svg', 'comment': '', 'nickname': '', 'phone_number': '', 'union_id': ''}, 'good_list': [{'buy_num': 1, 'check_state': 0, 'discounts_info': {'discount_amount_total': 0, 'discount_count': 0, 'discount_detail': []}, 'expire_desc': '长期有效', 'expire_end': '--', 'expire_start': '2025-04-20 20:08:58', 'goods_desc': '', 'goods_image': 'https://wechatapppro-1252524126.cos.ap-shanghai.myqcloud.com/app0vuxiwxw3082_727a0224-418b-467b-a874-87b97eb6ed2f.png', 'goods_name': '[绿色食品]山西黄小米 养胃油糯小米粥五谷杂粮月子米小黄米5斤', 'goods_sn': '--', 'goods_spec_desc': '净含量:2.5kg', 'period_type': 0, 'refund_state': 0, 'refund_state_desc': '--', 'relation_goods_id': '', 'relation_goods_type': 0, 'relation_goods_type_desc': '', 'resource_id': 'g_6736a6768694a_6EwELOsx27', 'resource_type': 21, 'ship_state': 0, 'ship_state_desc': '待发货', 'sku_id': 'SKU_ENT_17316348063VhT7qg6x0', 'sku_spec_code': 'ys-xm-5斤-sxth', 'spu_id': 'SPU_ENT_1731634806BHH8333E65uqn', 'spu_type': 'ENT', 'total_price': 5580, 'unit_price': 5580}], 'order_info': {'activity_type_bitmap': [], 'actual_fee': 5580, 'aftersale_show_state': 0, 'aftersale_show_state_time': '0000-00-00 00:00:00', 'app_id': 'app0vuxiwxw3082', 'channel_bus_id': '', 'channel_type': 0, 'check_state': 0, 'created_time': '2025-04-20 20:08:58', 'deduct_amount': 0, 'discount_amount': 0, 'distribute_type_bitmap': [], 'freight_actual_price': 0, 'freight_original_price': 0, 'goods_buy_num': 1, 'goods_name': '[绿色食品]山西黄小米 养胃油糯小米粥五谷杂粮月子米小黄米5斤', 'goods_original_total_price': 5580, 'goods_spu_sub_type': 'ENT', 'goods_spu_type': 1, 'modified_amount': 0, 'order_close_type': 0, 'order_id': 'E20250420200858a56katV2', 'order_state': 2, 'order_state_time': '2025-04-20 20:09:09', 'order_type': 1, 'pay_state': 1, 'pay_state_time': '2025-04-20 20:09:06', 'pay_type': 1, 'refund_fee': 0, 'refund_time': '0000-00-00 00:00:00', 'relation_order_appid': '', 'relation_order_id': '', 'relation_order_type': 0, 'settle_state': 0, 'settle_state_time': '0000-00-00 00:00:00', 'share_type': 0, 'share_user_id': '', 'ship_way_choose_type': 1, 'sub_order_type': 0, 'trade_id': 't_6967b554343f49faac5495f0f49f4e94', 'update_time': '2025-04-20 20:09:09', 'use_collection': 6, 'user_id': 'u_678ae7847a4ad_Lh3lkAkcmJt', 'wx_app_type': 40}, 'payment_info': {'out_order_id': '3727567285769608192', 'third_order_id': '4306702288202504201187533224'}, 'price_info': {'actual_price': 5580, 'freight_modified_price': 0, 'freight_price': 0, 'origin_price': 5580, 'total_modified_amount': 0, 'total_price': 5580}, 'promoter_info': {'nick_name': '', 'user_id': ''}, 'ship_info': {'city': '威海市', 'company': '', 'confirm_time': '0001-01-01 00:00:00', 'county': '乳山市', 'detail': '****', 'express_id': '', 'invalid_time': '0001-01-01 00:00:00', 'phone': '134****1656', 'province': '山东省', 'receiver': '唐', 'remark': '', 'ship_time': '0001-01-01 00:00:00', 'user_id': 'u_678ae7847a4ad_Lh3lkAkcmJt'}}
2025-04-21 10:56:18,729 - root - WARNING - Skipping order transformation due to missing key fields: {'buyer_info': {'avatar_url': 'http://commonresource-1252524126.cdn.xiaoeknow.com/image/default.svg', 'comment': '', 'nickname': '', 'phone_number': '', 'union_id': ''}, 'good_list': [{'buy_num': 1, 'check_state': 0, 'discounts_info': {'discount_amount_total': 0, 'discount_count': 0, 'discount_detail': []}, 'expire_desc': '长期有效', 'expire_end': '--', 'expire_start': '2025-04-21 05:26:10', 'goods_desc': '', 'goods_image': 'https://wechatapppro-1252524126.cos.ap-shanghai.myqcloud.com/app0vuxiwxw3082_727a0224-418b-467b-a874-87b97eb6ed2f.png', 'goods_name': '[绿色食品]山西黄小米 养胃油糯小米粥五谷杂粮月子米小黄米5斤', 'goods_sn': '--', 'goods_spec_desc': '净含量:2.5kg', 'period_type': 0, 'refund_state': 0, 'refund_state_desc': '--', 'relation_goods_id': '', 'relation_goods_type': 0, 'relation_goods_type_desc': '', 'resource_id': 'g_6736a6768694a_6EwELOsx27', 'resource_type': 21, 'ship_state': 0, 'ship_state_desc': '待发货', 'sku_id': 'SKU_ENT_17316348063VhT7qg6x0', 'sku_spec_code': 'ys-xm-5斤-sxth', 'spu_id': 'SPU_ENT_1731634806BHH8333E65uqn', 'spu_type': 'ENT', 'total_price': 5580, 'unit_price': 5580}], 'order_info': {'activity_type_bitmap': [], 'actual_fee': 5580, 'aftersale_show_state': 0, 'aftersale_show_state_time': '0000-00-00 00:00:00', 'app_id': 'app0vuxiwxw3082', 'channel_bus_id': '', 'channel_type': 0, 'check_state': 0, 'created_time': '2025-04-21 05:26:10', 'deduct_amount': 0, 'discount_amount': 0, 'distribute_type_bitmap': [], 'freight_actual_price': 0, 'freight_original_price': 0, 'goods_buy_num': 1, 'goods_name': '[绿色食品]山西黄小米 养胃油糯小米粥五谷杂粮月子米小黄米5斤', 'goods_original_total_price': 5580, 'goods_spu_sub_type': 'ENT', 'goods_spu_type': 1, 'modified_amount': 0, 'order_close_type': 0, 'order_id': 'E20250421052610a6d7tdV2', 'order_state': 2, 'order_state_time': '2025-04-21 05:26:29', 'order_type': 1, 'pay_state': 1, 'pay_state_time': '2025-04-21 05:26:25', 'pay_type': 1, 'refund_fee': 0, 'refund_time': '0000-00-00 00:00:00', 'relation_order_appid': '', 'relation_order_id': '', 'relation_order_type': 0, 'settle_state': 0, 'settle_state_time': '0000-00-00 00:00:00', 'share_type': 0, 'share_user_id': '', 'ship_way_choose_type': 1, 'sub_order_type': 0, 'trade_id': 't_30598c263e6a4eeb9797f859c4dee991', 'update_time': '2025-04-21 05:26:29', 'use_collection': 6, 'user_id': 'u_675638130420e_OLUruIgFBwj', 'wx_app_type': 40}, 'payment_info': {'out_order_id': '3727576047586259712', 'third_order_id': '4326302465202504214896766189'}, 'price_info': {'actual_price': 5580, 'freight_modified_price': 0, 'freight_price': 0, 'origin_price': 5580, 'total_modified_amount': 0, 'total_price': 5580}, 'promoter_info': {'nick_name': '', 'user_id': ''}, 'ship_info': {'city': '佛山市', 'company': '', 'confirm_time': '0001-01-01 00:00:00', 'county': '南海区', 'detail': '****', 'express_id': '', 'invalid_time': '0001-01-01 00:00:00', 'phone': '189****9921', 'province': '广东省', 'receiver': 'M*', 'remark': '', 'ship_time': '0001-01-01 00:00:00', 'user_id': 'u_675638130420e_OLUruIgFBwj'}}
2025-04-21 10:56:18,730 - root - WARNING - Skipping order transformation due to missing key fields: {'buyer_info': {'avatar_url': 'http://commonresource-1252524126.cdn.xiaoeknow.com/image/default.svg', 'comment': '', 'nickname': '', 'phone_number': '', 'union_id': ''}, 'good_list': [{'buy_num': 2, 'check_state': 0, 'discounts_info': {'discount_amount_total': 0, 'discount_count': 0, 'discount_detail': []}, 'expire_desc': '长期有效', 'expire_end': '--', 'expire_start': '2025-04-21 05:34:31', 'goods_desc': '', 'goods_image': 'https://wechatapppro-1252524126.cos.ap-shanghai.myqcloud.com/app0vuxiwxw3082_727a0224-418b-467b-a874-87b97eb6ed2f.png', 'goods_name': '[绿色食品]山西黄小米 养胃油糯小米粥五谷杂粮月子米小黄米5斤', 'goods_sn': '--', 'goods_spec_desc': '净含量:2.5kg', 'period_type': 0, 'refund_state': 0, 'refund_state_desc': '--', 'relation_goods_id': '', 'relation_goods_type': 0, 'relation_goods_type_desc': '', 'resource_id': 'g_6736a6768694a_6EwELOsx27', 'resource_type': 21, 'ship_state': 0, 'ship_state_desc': '待发货', 'sku_id': 'SKU_ENT_17316348063VhT7qg6x0', 'sku_spec_code': 'ys-xm-5斤-sxth', 'spu_id': 'SPU_ENT_1731634806BHH8333E65uqn', 'spu_type': 'ENT', 'total_price': 11160, 'unit_price': 5580}], 'order_info': {'activity_type_bitmap': [], 'actual_fee': 11160, 'aftersale_show_state': 0, 'aftersale_show_state_time': '0000-00-00 00:00:00', 'app_id': 'app0vuxiwxw3082', 'channel_bus_id': '', 'channel_type': 0, 'check_state': 0, 'created_time': '2025-04-21 05:34:32', 'deduct_amount': 0, 'discount_amount': 0, 'distribute_type_bitmap': [], 'freight_actual_price': 0, 'freight_original_price': 0, 'goods_buy_num': 2, 'goods_name': '[绿色食品]山西黄小米 养胃油糯小米粥五谷杂粮月子米小黄米5斤', 'goods_original_total_price': 11160, 'goods_spu_sub_type': 'ENT', 'goods_spu_type': 1, 'modified_amount': 0, 'order_close_type': 0, 'order_id': 'E20250421053431a9yjibV2', 'order_state': 2, 'order_state_time': '2025-04-21 05:34:47', 'order_type': 1, 'pay_state': 1, 'pay_state_time': '2025-04-21 05:34:43', 'pay_type': 1, 'refund_fee': 0, 'refund_time': '0000-00-00 00:00:00', 'relation_order_appid': '', 'relation_order_id': '', 'relation_order_type': 0, 'settle_state': 0, 'settle_state_time': '0000-00-00 00:00:00', 'share_type': 0, 'share_user_id': '', 'ship_way_choose_type': 1, 'sub_order_type': 0, 'trade_id': 't_ad7ef3e01dbc4287926cfcb5c854332a', 'update_time': '2025-04-21 05:34:47', 'use_collection': 6, 'user_id': 'u_67dbbd21d4409_VBg3Gzx9wvt', 'wx_app_type': 40}, 'payment_info': {'out_order_id': '3727576174745230336', 'third_order_id': '4321002241202504217738056586'}, 'price_info': {'actual_price': 11160, 'freight_modified_price': 0, 'freight_price': 0, 'origin_price': 11160, 'total_modified_amount': 0, 'total_price': 11160}, 'promoter_info': {'nick_name': '', 'user_id': ''}, 'ship_info': {'city': '甘孜藏族自治州', 'company': '', 'confirm_time': '0001-01-01 00:00:00', 'county': '泸定县', 'detail': '****', 'express_id': '', 'invalid_time': '0001-01-01 00:00:00', 'phone': '180****3868', 'province': '四川省', 'receiver': '帅**', 'remark': '', 'ship_time': '0001-01-01 00:00:00', 'user_id': 'u_67dbbd21d4409_VBg3Gzx9wvt'}}
2025-04-21 10:56:18,732 - root - WARNING - Skipping order transformation due to missing key fields: {'buyer_info': {'avatar_url': 'http://commonresource-1252524126.cdn.xiaoeknow.com/image/default.svg', 'comment': '', 'nickname': '', 'phone_number': '', 'union_id': ''}, 'good_list': [{'buy_num': 1, 'check_state': 0, 'discounts_info': {'discount_amount_total': 0, 'discount_count': 0, 'discount_detail': []}, 'expire_desc': '长期有效', 'expire_end': '--', 'expire_start': '2025-04-21 09:26:19', 'goods_desc': '', 'goods_image': 'https://wechatapppro-1252524126.cos.ap-shanghai.myqcloud.com/app0vuxiwxw3082_727a0224-418b-467b-a874-87b97eb6ed2f.png', 'goods_name': '[绿色食品]山西黄小米 养胃油糯小米粥五谷杂粮月子米小黄米5斤', 'goods_sn': '--', 'goods_spec_desc': '净含量:2.5kg', 'period_type': 0, 'refund_state': 0, 'refund_state_desc': '--', 'relation_goods_id': '', 'relation_goods_type': 0, 'relation_goods_type_desc': '', 'resource_id': 'g_6736a6768694a_6EwELOsx27', 'resource_type': 21, 'ship_state': 0, 'ship_state_desc': '待发货', 'sku_id': 'SKU_ENT_17316348063VhT7qg6x0', 'sku_spec_code': 'ys-xm-5斤-sxth', 'spu_id': 'SPU_ENT_1731634806BHH8333E65uqn', 'spu_type': 'ENT', 'total_price': 5580, 'unit_price': 5580}], 'order_info': {'activity_type_bitmap': [], 'actual_fee': 5580, 'aftersale_show_state': 0, 'aftersale_show_state_time': '0000-00-00 00:00:00', 'app_id': 'app0vuxiwxw3082', 'channel_bus_id': '', 'channel_type': 0, 'check_state': 0, 'created_time': '2025-04-21 09:26:20', 'deduct_amount': 0, 'discount_amount': 0, 'distribute_type_bitmap': [], 'freight_actual_price': 0, 'freight_original_price': 0, 'goods_buy_num': 1, 'goods_name': '[绿色食品]山西黄小米 养胃油糯小米粥五谷杂粮月子米小黄米5斤', 'goods_original_total_price': 5580, 'goods_spu_sub_type': 'ENT', 'goods_spu_type': 1, 'modified_amount': 0, 'order_close_type': 0, 'order_id': 'E20250421092619a9e4roV2', 'order_state': 2, 'order_state_time': '2025-04-21 09:26:30', 'order_type': 1, 'pay_state': 1, 'pay_state_time': '2025-04-21 09:26:27', 'pay_type': 1, 'refund_fee': 0, 'refund_time': '0000-00-00 00:00:00', 'relation_order_appid': '', 'relation_order_id': '', 'relation_order_type': 0, 'settle_state': 0, 'settle_state_time': '0000-00-00 00:00:00', 'share_type': 0, 'share_user_id': '', 'ship_way_choose_type': 1, 'sub_order_type': 0, 'trade_id': 't_98a4e30a6ada4fd3ac07e82b71960488', 'update_time': '2025-04-21 09:26:30', 'use_collection': 6, 'user_id': 'u_68059ebb49de7_HfbyGPQikAE', 'wx_app_type': 40}, 'payment_info': {'out_order_id': '3727579807408595713', 'third_order_id': ''}, 'price_info': {'actual_price': 5580, 'freight_modified_price': 0, 'freight_price': 0, 'origin_price': 5580, 'total_modified_amount': 0, 'total_price': 5580}, 'promoter_info': {'nick_name': '', 'user_id': ''}, 'ship_info': {'city': '长沙市', 'company': '', 'confirm_time': '0001-01-01 00:00:00', 'county': '岳麓区', 'detail': '****', 'express_id': '', 'invalid_time': '0001-01-01 00:00:00', 'phone': '158****2258', 'province': '湖南省', 'receiver': '陈*', 'remark': '', 'ship_time': '0001-01-01 00:00:00', 'user_id': 'u_68059ebb49de7_HfbyGPQikAE'}}
2025-04-21 10:56:18,733 - root - WARNING - Skipping order transformation due to missing key fields: {'buyer_info': {'avatar_url': 'http://commonresource-1252524126.cdn.xiaoeknow.com/image/default.svg', 'comment': '', 'nickname': '', 'phone_number': '', 'union_id': ''}, 'good_list': [{'buy_num': 1, 'check_state': 0, 'discounts_info': {'discount_amount_total': 0, 'discount_count': 0, 'discount_detail': []}, 'expire_desc': '长期有效', 'expire_end': '--', 'expire_start': '2025-04-21 09:49:21', 'goods_desc': '', 'goods_image': 'https://wechatapppro-1252524126.cos.ap-shanghai.myqcloud.com/app0vuxiwxw3082_727a0224-418b-467b-a874-87b97eb6ed2f.png', 'goods_name': '[绿色食品]山西黄小米 养胃油糯小米粥五谷杂粮月子米小黄米5斤', 'goods_sn': '--', 'goods_spec_desc': '净含量:2.5kg', 'period_type': 0, 'refund_state': 0, 'refund_state_desc': '--', 'relation_goods_id': '', 'relation_goods_type': 0, 'relation_goods_type_desc': '', 'resource_id': 'g_6736a6768694a_6EwELOsx27', 'resource_type': 21, 'ship_state': 0, 'ship_state_desc': '待发货', 'sku_id': 'SKU_ENT_17316348063VhT7qg6x0', 'sku_spec_code': 'ys-xm-5斤-sxth', 'spu_id': 'SPU_ENT_1731634806BHH8333E65uqn', 'spu_type': 'ENT', 'total_price': 5580, 'unit_price': 5580}], 'order_info': {'activity_type_bitmap': [], 'actual_fee': 5580, 'aftersale_show_state': 0, 'aftersale_show_state_time': '0000-00-00 00:00:00', 'app_id': 'app0vuxiwxw3082', 'channel_bus_id': '', 'channel_type': 0, 'check_state': 0, 'created_time': '2025-04-21 09:49:22', 'deduct_amount': 0, 'discount_amount': 0, 'distribute_type_bitmap': [], 'freight_actual_price': 0, 'freight_original_price': 0, 'goods_buy_num': 1, 'goods_name': '[绿色食品]山西黄小米 养胃油糯小米粥五谷杂粮月子米小黄米5斤', 'goods_original_total_price': 5580, 'goods_spu_sub_type': 'ENT', 'goods_spu_type': 1, 'modified_amount': 0, 'order_close_type': 0, 'order_id': 'E20250421094921a0hfu9V2', 'order_state': 2, 'order_state_time': '2025-04-21 09:49:34', 'order_type': 1, 'pay_state': 1, 'pay_state_time': '2025-04-21 09:49:30', 'pay_type': 1, 'refund_fee': 0, 'refund_time': '0000-00-00 00:00:00', 'relation_order_appid': '', 'relation_order_id': '', 'relation_order_type': 0, 'settle_state': 0, 'settle_state_time': '0000-00-00 00:00:00', 'share_type': 0, 'share_user_id': '', 'ship_way_choose_type': 1, 'sub_order_type': 0, 'trade_id': 't_1b993d6ba4af468abb7a5832e852325e', 'update_time': '2025-04-21 09:49:34', 'use_collection': 6, 'user_id': 'u_6805a42166f38_d2IuQY9uHKG', 'wx_app_type': 40}, 'payment_info': {'out_order_id': '3727580190355365120', 'third_order_id': '4302402465202504213435831316'}, 'price_info': {'actual_price': 5580, 'freight_modified_price': 0, 'freight_price': 0, 'origin_price': 5580, 'total_modified_amount': 0, 'total_price': 5580}, 'promoter_info': {'nick_name': '', 'user_id': ''}, 'ship_info': {'city': '昆明市', 'company': '', 'confirm_time': '0001-01-01 00:00:00', 'county': '五华区', 'detail': '****', 'express_id': '', 'invalid_time': '0001-01-01 00:00:00', 'phone': '159****4001', 'province': '云南省', 'receiver': '林*', 'remark': '', 'ship_time': '0001-01-01 00:00:00', 'user_id': 'u_6805a42166f38_d2IuQY9uHKG'}}
2025-04-21 10:56:18,735 - root - WARNING - Skipping order transformation due to missing key fields: {'buyer_info': {'avatar_url': 'http://commonresource-1252524126.cdn.xiaoeknow.com/image/default.svg', 'comment': '', 'nickname': '', 'phone_number': '', 'union_id': ''}, 'good_list': [{'buy_num': 1, 'check_state': 0, 'discounts_info': {'discount_amount_total': 0, 'discount_count': 0, 'discount_detail': []}, 'expire_desc': '长期有效', 'expire_end': '--', 'expire_start': '2025-04-21 10:07:22', 'goods_desc': '', 'goods_image': 'https://wechatapppro-1252524126.cos.ap-shanghai.myqcloud.com/app0vuxiwxw3082_727a0224-418b-467b-a874-87b97eb6ed2f.png', 'goods_name': '[绿色食品]山西黄小米 养胃油糯小米粥五谷杂粮月子米小黄米5斤', 'goods_sn': '--', 'goods_spec_desc': '净含量:2.5kg', 'period_type': 0, 'refund_state': 0, 'refund_state_desc': '--', 'relation_goods_id': '', 'relation_goods_type': 0, 'relation_goods_type_desc': '', 'resource_id': 'g_6736a6768694a_6EwELOsx27', 'resource_type': 21, 'ship_state': 0, 'ship_state_desc': '待发货', 'sku_id': 'SKU_ENT_17316348063VhT7qg6x0', 'sku_spec_code': 'ys-xm-5斤-sxth', 'spu_id': 'SPU_ENT_1731634806BHH8333E65uqn', 'spu_type': 'ENT', 'total_price': 5580, 'unit_price': 5580}], 'order_info': {'activity_type_bitmap': [], 'actual_fee': 5580, 'aftersale_show_state': 0, 'aftersale_show_state_time': '0000-00-00 00:00:00', 'app_id': 'app0vuxiwxw3082', 'channel_bus_id': '', 'channel_type': 0, 'check_state': 0, 'created_time': '2025-04-21 10:07:23', 'deduct_amount': 0, 'discount_amount': 0, 'distribute_type_bitmap': [], 'freight_actual_price': 0, 'freight_original_price': 0, 'goods_buy_num': 1, 'goods_name': '[绿色食品]山西黄小米 养胃油糯小米粥五谷杂粮月子米小黄米5斤', 'goods_original_total_price': 5580, 'goods_spu_sub_type': 'ENT', 'goods_spu_type': 1, 'modified_amount': 0, 'order_close_type': 0, 'order_id': 'E20250421100722a4fbzrV2', 'order_state': 2, 'order_state_time': '2025-04-21 10:07:32', 'order_type': 1, 'pay_state': 1, 'pay_state_time': '2025-04-21 10:07:29', 'pay_type': 1, 'refund_fee': 0, 'refund_time': '0000-00-00 00:00:00', 'relation_order_appid': '', 'relation_order_id': '', 'relation_order_type': 0, 'settle_state': 0, 'settle_state_time': '0000-00-00 00:00:00', 'share_type': 0, 'share_user_id': '', 'ship_way_choose_type': 1, 'sub_order_type': 0, 'trade_id': 't_b553d0d6c123490a8fe5fcd5cafdb4d2', 'update_time': '2025-04-21 10:07:32', 'use_collection': 6, 'user_id': 'u_67d8207a887dd_pt72snQ0wMs', 'wx_app_type': 40}, 'payment_info': {'out_order_id': '3727580461210940672', 'third_order_id': '4339902245202504217884097384'}, 'price_info': {'actual_price': 5580, 'freight_modified_price': 0, 'freight_price': 0, 'origin_price': 5580, 'total_modified_amount': 0, 'total_price': 5580}, 'promoter_info': {'nick_name': '', 'user_id': ''}, 'ship_info': {'city': '广州市', 'company': '', 'confirm_time': '0001-01-01 00:00:00', 'county': '海珠区', 'detail': '****', 'express_id': '', 'invalid_time': '0001-01-01 00:00:00', 'phone': '138****7200', 'province': '广东省', 'receiver': '陈', 'remark': '', 'ship_time': '0001-01-01 00:00:00', 'user_id': 'u_67d8207a887dd_pt72snQ0wMs'}}
2025-04-21 10:56:18,736 - root - WARNING - Skipping order transformation due to missing key fields: {'buyer_info': {'avatar_url': 'http://commonresource-1252524126.cdn.xiaoeknow.com/image/default.svg', 'comment': '', 'nickname': '', 'phone_number': '', 'union_id': ''}, 'good_list': [{'buy_num': 1, 'check_state': 0, 'discounts_info': {'discount_amount_total': 0, 'discount_count': 0, 'discount_detail': []}, 'expire_desc': '长期有效', 'expire_end': '--', 'expire_start': '2025-04-21 10:25:38', 'goods_desc': '', 'goods_image': 'https://wechatapppro-1252524126.cos.ap-shanghai.myqcloud.com/app0vuxiwxw3082_727a0224-418b-467b-a874-87b97eb6ed2f.png', 'goods_name': '[绿色食品]山西黄小米 养胃油糯小米粥五谷杂粮月子米小黄米5斤', 'goods_sn': '--', 'goods_spec_desc': '净含量:2.5kg', 'period_type': 0, 'refund_state': 0, 'refund_state_desc': '--', 'relation_goods_id': '', 'relation_goods_type': 0, 'relation_goods_type_desc': '', 'resource_id': 'g_6736a6768694a_6EwELOsx27', 'resource_type': 21, 'ship_state': 0, 'ship_state_desc': '待发货', 'sku_id': 'SKU_ENT_17316348063VhT7qg6x0', 'sku_spec_code': 'ys-xm-5斤-sxth', 'spu_id': 'SPU_ENT_1731634806BHH8333E65uqn', 'spu_type': 'ENT', 'total_price': 5580, 'unit_price': 5580}], 'order_info': {'activity_type_bitmap': [], 'actual_fee': 5580, 'aftersale_show_state': 0, 'aftersale_show_state_time': '0000-00-00 00:00:00', 'app_id': 'app0vuxiwxw3082', 'channel_bus_id': '', 'channel_type': 0, 'check_state': 0, 'created_time': '2025-04-21 10:25:39', 'deduct_amount': 0, 'discount_amount': 0, 'distribute_type_bitmap': [], 'freight_actual_price': 0, 'freight_original_price': 0, 'goods_buy_num': 1, 'goods_name': '[绿色食品]山西黄小米 养胃油糯小米粥五谷杂粮月子米小黄米5斤', 'goods_original_total_price': 5580, 'goods_spu_sub_type': 'ENT', 'goods_spu_type': 1, 'modified_amount': 0, 'order_close_type': 0, 'order_id': 'E20250421102538a2eo9bV2', 'order_state': 2, 'order_state_time': '2025-04-21 10:25:48', 'order_type': 1, 'pay_state': 1, 'pay_state_time': '2025-04-21 10:25:44', 'pay_type': 1, 'refund_fee': 0, 'refund_time': '0000-00-00 00:00:00', 'relation_order_appid': '', 'relation_order_id': '', 'relation_order_type': 0, 'settle_state': 0, 'settle_state_time': '0000-00-00 00:00:00', 'share_type': 0, 'share_user_id': '', 'ship_way_choose_type': 1, 'sub_order_type': 0, 'trade_id': 't_8392da6058bc4b59ab246c04a3b10245', 'update_time': '2025-04-21 10:25:48', 'use_collection': 6, 'user_id': 'u_6805aca28ca68_Lk5C8Zp1Ecv', 'wx_app_type': 40}, 'payment_info': {'out_order_id': '3727580755225883648', 'third_order_id': '4349402462202504213792719721'}, 'price_info': {'actual_price': 5580, 'freight_modified_price': 0, 'freight_price': 0, 'origin_price': 5580, 'total_modified_amount': 0, 'total_price': 5580}, 'promoter_info': {'nick_name': '', 'user_id': ''}, 'ship_info': {'city': '广州市', 'company': '', 'confirm_time': '0001-01-01 00:00:00', 'county': '越秀区', 'detail': '****', 'express_id': '', 'invalid_time': '0001-01-01 00:00:00', 'phone': '136****2127', 'province': '广东省', 'receiver': '黄**', 'remark': '', 'ship_time': '0001-01-01 00:00:00', 'user_id': 'u_6805aca28ca68_Lk5C8Zp1Ecv'}}
2025-04-21 10:56:18,737 - root - WARNING - Skipping order transformation due to missing key fields: {'buyer_info': {'avatar_url': 'http://commonresource-1252524126.cdn.xiaoeknow.com/image/default.svg', 'comment': '', 'nickname': '', 'phone_number': '', 'union_id': ''}, 'good_list': [{'buy_num': 1, 'check_state': 0, 'discounts_info': {'discount_amount_total': 0, 'discount_count': 0, 'discount_detail': []}, 'expire_desc': '长期有效', 'expire_end': '--', 'expire_start': '2025-04-21 10:44:50', 'goods_desc': '', 'goods_image': 'https://wechatapppro-1252524126.cos.ap-shanghai.myqcloud.com/app0vuxiwxw3082_727a0224-418b-467b-a874-87b97eb6ed2f.png', 'goods_name': '[绿色食品]山西黄小米 养胃油糯小米粥五谷杂粮月子米小黄米5斤', 'goods_sn': '--', 'goods_spec_desc': '净含量:2.5kg', 'period_type': 0, 'refund_state': 0, 'refund_state_desc': '--', 'relation_goods_id': '', 'relation_goods_type': 0, 'relation_goods_type_desc': '', 'resource_id': 'g_6736a6768694a_6EwELOsx27', 'resource_type': 21, 'ship_state': 0, 'ship_state_desc': '待发货', 'sku_id': 'SKU_ENT_17316348063VhT7qg6x0', 'sku_spec_code': 'ys-xm-5斤-sxth', 'spu_id': 'SPU_ENT_1731634806BHH8333E65uqn', 'spu_type': 'ENT', 'total_price': 5580, 'unit_price': 5580}], 'order_info': {'activity_type_bitmap': [], 'actual_fee': 5580, 'aftersale_show_state': 0, 'aftersale_show_state_time': '0000-00-00 00:00:00', 'app_id': 'app0vuxiwxw3082', 'channel_bus_id': '', 'channel_type': 0, 'check_state': 0, 'created_time': '2025-04-21 10:44:51', 'deduct_amount': 0, 'discount_amount': 0, 'distribute_type_bitmap': [], 'freight_actual_price': 0, 'freight_original_price': 0, 'goods_buy_num': 1, 'goods_name': '[绿色食品]山西黄小米 养胃油糯小米粥五谷杂粮月子米小黄米5斤', 'goods_original_total_price': 5580, 'goods_spu_sub_type': 'ENT', 'goods_spu_type': 1, 'modified_amount': 0, 'order_close_type': 0, 'order_id': 'E20250421104450a79tcxV2', 'order_state': 2, 'order_state_time': '2025-04-21 10:44:59', 'order_type': 1, 'pay_state': 1, 'pay_state_time': '2025-04-21 10:44:55', 'pay_type': 1, 'refund_fee': 0, 'refund_time': '0000-00-00 00:00:00', 'relation_order_appid': '', 'relation_order_id': '', 'relation_order_type': 0, 'settle_state': 0, 'settle_state_time': '0000-00-00 00:00:00', 'share_type': 0, 'share_user_id': '', 'ship_way_choose_type': 1, 'sub_order_type': 0, 'trade_id': 't_ae755d0bffb440968673197ce1b1f9f5', 'update_time': '2025-04-21 10:44:59', 'use_collection': 6, 'user_id': 'u_6805b1227dd56_5PQLDpyyIer', 'wx_app_type': 40}, 'payment_info': {'out_order_id': '3727581063850892544', 'third_order_id': ''}, 'price_info': {'actual_price': 5580, 'freight_modified_price': 0, 'freight_price': 0, 'origin_price': 5580, 'total_modified_amount': 0, 'total_price': 5580}, 'promoter_info': {'nick_name': '', 'user_id': ''}, 'ship_info': {'city': '深圳市', 'company': '', 'confirm_time': '0001-01-01 00:00:00', 'county': '福田区', 'detail': '****', 'express_id': '', 'invalid_time': '0001-01-01 00:00:00', 'phone': '139****3033', 'province': '广东省', 'receiver': '孙**', 'remark': '', 'ship_time': '0001-01-01 00:00:00', 'user_id': 'u_6805b1227dd56_5PQLDpyyIer'}}
2025-04-21 10:56:18,738 - root - WARNING - Skipping order transformation due to missing key fields: {'buyer_info': {'avatar_url': 'http://commonresource-1252524126.cdn.xiaoeknow.com/image/default.svg', 'comment': '', 'nickname': '', 'phone_number': '', 'union_id': ''}, 'good_list': [{'buy_num': 1, 'check_state': 0, 'discounts_info': {'discount_amount_total': 0, 'discount_count': 0, 'discount_detail': []}, 'expire_desc': '长期有效', 'expire_end': '--', 'expire_start': '2025-04-21 10:45:07', 'goods_desc': '', 'goods_image': 'https://wechatapppro-1252524126.cos.ap-shanghai.myqcloud.com/app0vuxiwxw3082_727a0224-418b-467b-a874-87b97eb6ed2f.png', 'goods_name': '[绿色食品]山西黄小米 养胃油糯小米粥五谷杂粮月子米小黄米5斤', 'goods_sn': '--', 'goods_spec_desc': '净含量:2.5kg', 'period_type': 0, 'refund_state': 0, 'refund_state_desc': '--', 'relation_goods_id': '', 'relation_goods_type': 0, 'relation_goods_type_desc': '', 'resource_id': 'g_6736a6768694a_6EwELOsx27', 'resource_type': 21, 'ship_state': 0, 'ship_state_desc': '待发货', 'sku_id': 'SKU_ENT_17316348063VhT7qg6x0', 'sku_spec_code': 'ys-xm-5斤-sxth', 'spu_id': 'SPU_ENT_1731634806BHH8333E65uqn', 'spu_type': 'ENT', 'total_price': 5580, 'unit_price': 5580}], 'order_info': {'activity_type_bitmap': [], 'actual_fee': 5580, 'aftersale_show_state': 0, 'aftersale_show_state_time': '0000-00-00 00:00:00', 'app_id': 'app0vuxiwxw3082', 'channel_bus_id': '', 'channel_type': 0, 'check_state': 0, 'created_time': '2025-04-21 10:45:07', 'deduct_amount': 0, 'discount_amount': 0, 'distribute_type_bitmap': [], 'freight_actual_price': 0, 'freight_original_price': 0, 'goods_buy_num': 1, 'goods_name': '[绿色食品]山西黄小米 养胃油糯小米粥五谷杂粮月子米小黄米5斤', 'goods_original_total_price': 5580, 'goods_spu_sub_type': 'ENT', 'goods_spu_type': 1, 'modified_amount': 0, 'order_close_type': 0, 'order_id': 'E20250421104507a04kfpV2', 'order_state': 2, 'order_state_time': '2025-04-21 10:45:17', 'order_type': 1, 'pay_state': 1, 'pay_state_time': '2025-04-21 10:45:13', 'pay_type': 1, 'refund_fee': 0, 'refund_time': '0000-00-00 00:00:00', 'relation_order_appid': '', 'relation_order_id': '', 'relation_order_type': 0, 'settle_state': 0, 'settle_state_time': '0000-00-00 00:00:00', 'share_type': 0, 'share_user_id': '', 'ship_way_choose_type': 1, 'sub_order_type': 0, 'trade_id': 't_46d4a3bbfb7143feaba9bbe998e798fd', 'update_time': '2025-04-21 10:45:17', 'use_collection': 6, 'user_id': 'u_6805b132dce97_ZQjkft5x2tj', 'wx_app_type': 40}, 'payment_info': {'out_order_id': '3727581067801928192', 'third_order_id': '4311102259202504215787920645'}, 'price_info': {'actual_price': 5580, 'freight_modified_price': 0, 'freight_price': 0, 'origin_price': 5580, 'total_modified_amount': 0, 'total_price': 5580}, 'promoter_info': {'nick_name': '', 'user_id': ''}, 'ship_info': {'city': '安庆市', 'company': '', 'confirm_time': '0001-01-01 00:00:00', 'county': '怀宁县', 'detail': '****', 'express_id': '', 'invalid_time': '0001-01-01 00:00:00', 'phone': '195****2124', 'province': '安徽省', 'receiver': '小*', 'remark': '', 'ship_time': '0001-01-01 00:00:00', 'user_id': 'u_6805b132dce97_ZQjkft5x2tj'}}
2025-04-21 10:56:18,741 - root - WARNING - Skipping order transformation due to missing key fields: {'buyer_info': {'avatar_url': 'http://commonresource-1252524126.cdn.xiaoeknow.com/image/default.svg', 'comment': '', 'nickname': '', 'phone_number': '', 'union_id': ''}, 'good_list': [{'buy_num': 1, 'check_state': 0, 'discounts_info': {'discount_amount_total': 0, 'discount_count': 0, 'discount_detail': []}, 'expire_desc': '长期有效', 'expire_end': '--', 'expire_start': '2025-04-21 10:45:12', 'goods_desc': '', 'goods_image': 'https://wechatapppro-1252524126.cos.ap-shanghai.myqcloud.com/app0vuxiwxw3082_727a0224-418b-467b-a874-87b97eb6ed2f.png', 'goods_name': '[绿色食品]山西黄小米 养胃油糯小米粥五谷杂粮月子米小黄米5斤', 'goods_sn': '--', 'goods_spec_desc': '净含量:2.5kg', 'period_type': 0, 'refund_state': 0, 'refund_state_desc': '--', 'relation_goods_id': '', 'relation_goods_type': 0, 'relation_goods_type_desc': '', 'resource_id': 'g_6736a6768694a_6EwELOsx27', 'resource_type': 21, 'ship_state': 0, 'ship_state_desc': '待发货', 'sku_id': 'SKU_ENT_17316348063VhT7qg6x0', 'sku_spec_code': 'ys-xm-5斤-sxth', 'spu_id': 'SPU_ENT_1731634806BHH8333E65uqn', 'spu_type': 'ENT', 'total_price': 5580, 'unit_price': 5580}], 'order_info': {'activity_type_bitmap': [], 'actual_fee': 5580, 'aftersale_show_state': 0, 'aftersale_show_state_time': '0000-00-00 00:00:00', 'app_id': 'app0vuxiwxw3082', 'channel_bus_id': '', 'channel_type': 0, 'check_state': 0, 'created_time': '2025-04-21 10:45:13', 'deduct_amount': 0, 'discount_amount': 0, 'distribute_type_bitmap': [], 'freight_actual_price': 0, 'freight_original_price': 0, 'goods_buy_num': 1, 'goods_name': '[绿色食品]山西黄小米 养胃油糯小米粥五谷杂粮月子米小黄米5斤', 'goods_original_total_price': 5580, 'goods_spu_sub_type': 'ENT', 'goods_spu_type': 1, 'modified_amount': 0, 'order_close_type': 0, 'order_id': 'E20250421104512a752deV2', 'order_state': 2, 'order_state_time': '2025-04-21 10:45:22', 'order_type': 1, 'pay_state': 1, 'pay_state_time': '2025-04-21 10:45:19', 'pay_type': 1, 'refund_fee': 0, 'refund_time': '0000-00-00 00:00:00', 'relation_order_appid': '', 'relation_order_id': '', 'relation_order_type': 0, 'settle_state': 0, 'settle_state_time': '0000-00-00 00:00:00', 'share_type': 0, 'share_user_id': '', 'ship_way_choose_type': 1, 'sub_order_type': 0, 'trade_id': 't_31f0ae00e37444e694398ff214a89821', 'update_time': '2025-04-21 10:45:22', 'use_collection': 6, 'user_id': 'u_67a0bd56d1cb3_4QO9VKCjhpV', 'wx_app_type': 40}, 'payment_info': {'out_order_id': '3727581067137916928', 'third_order_id': ''}, 'price_info': {'actual_price': 5580, 'freight_modified_price': 0, 'freight_price': 0, 'origin_price': 5580, 'total_modified_amount': 0, 'total_price': 5580}, 'promoter_info': {'nick_name': '', 'user_id': ''}, 'ship_info': {'city': '宁波市', 'company': '', 'confirm_time': '0001-01-01 00:00:00', 'county': '江北区', 'detail': '****', 'express_id': '', 'invalid_time': '0001-01-01 00:00:00', 'phone': '198****8913', 'province': '浙江省', 'receiver': '秋*', 'remark': '', 'ship_time': '0001-01-01 00:00:00', 'user_id': 'u_67a0bd56d1cb3_4QO9VKCjhpV'}}
2025-04-21 10:56:18,743 - root - WARNING - Skipping order transformation due to missing key fields: {'buyer_info': {'avatar_url': 'http://commonresource-1252524126.cdn.xiaoeknow.com/image/default.svg', 'comment': '', 'nickname': '', 'phone_number': '', 'union_id': ''}, 'good_list': [{'buy_num': 1, 'check_state': 0, 'discounts_info': {'discount_amount_total': 0, 'discount_count': 0, 'discount_detail': []}, 'expire_desc': '长期有效', 'expire_end': '--', 'expire_start': '2025-04-21 10:45:27', 'goods_desc': '', 'goods_image': 'https://wechatapppro-1252524126.cos.ap-shanghai.myqcloud.com/app0vuxiwxw3082_727a0224-418b-467b-a874-87b97eb6ed2f.png', 'goods_name': '[绿色食品]山西黄小米 养胃油糯小米粥五谷杂粮月子米小黄米5斤', 'goods_sn': '--', 'goods_spec_desc': '净含量:2.5kg', 'period_type': 0, 'refund_state': 0, 'refund_state_desc': '--', 'relation_goods_id': '', 'relation_goods_type': 0, 'relation_goods_type_desc': '', 'resource_id': 'g_6736a6768694a_6EwELOsx27', 'resource_type': 21, 'ship_state': 0, 'ship_state_desc': '待发货', 'sku_id': 'SKU_ENT_17316348063VhT7qg6x0', 'sku_spec_code': 'ys-xm-5斤-sxth', 'spu_id': 'SPU_ENT_1731634806BHH8333E65uqn', 'spu_type': 'ENT', 'total_price': 5580, 'unit_price': 5580}], 'order_info': {'activity_type_bitmap': [], 'actual_fee': 5580, 'aftersale_show_state': 0, 'aftersale_show_state_time': '0000-00-00 00:00:00', 'app_id': 'app0vuxiwxw3082', 'channel_bus_id': '', 'channel_type': 0, 'check_state': 0, 'created_time': '2025-04-21 10:45:27', 'deduct_amount': 0, 'discount_amount': 0, 'distribute_type_bitmap': [], 'freight_actual_price': 0, 'freight_original_price': 0, 'goods_buy_num': 1, 'goods_name': '[绿色食品]山西黄小米 养胃油糯小米粥五谷杂粮月子米小黄米5斤', 'goods_original_total_price': 5580, 'goods_spu_sub_type': 'ENT', 'goods_spu_type': 1, 'modified_amount': 0, 'order_close_type': 0, 'order_id': 'E20250421104527a750ndV2', 'order_state': 2, 'order_state_time': '2025-04-21 10:46:54', 'order_type': 1, 'pay_state': 1, 'pay_state_time': '2025-04-21 10:46:50', 'pay_type': 1, 'refund_fee': 0, 'refund_time': '0000-00-00 00:00:00', 'relation_order_appid': '', 'relation_order_id': '', 'relation_order_type': 0, 'settle_state': 0, 'settle_state_time': '0000-00-00 00:00:00', 'share_type': 0, 'share_user_id': '', 'ship_way_choose_type': 1, 'sub_order_type': 0, 'trade_id': 't_67cee1d576e84deba043e0c148544054', 'update_time': '2025-04-21 10:46:54', 'use_collection': 6, 'user_id': 'u_6805b146dce62_VsV3xtRC6XI', 'wx_app_type': 40}, 'payment_info': {'out_order_id': '3727581071006118400', 'third_order_id': '4321202259202504213660458339'}, 'price_info': {'actual_price': 5580, 'freight_modified_price': 0, 'freight_price': 0, 'origin_price': 5580, 'total_modified_amount': 0, 'total_price': 5580}, 'promoter_info': {'nick_name': '', 'user_id': ''}, 'ship_info': {'city': '重庆市', 'company': '', 'confirm_time': '0001-01-01 00:00:00', 'county': '渝北区', 'detail': '****', 'express_id': '', 'invalid_time': '0001-01-01 00:00:00', 'phone': '139****8432', 'province': '重庆市', 'receiver': '琳*', 'remark': '', 'ship_time': '0001-01-01 00:00:00', 'user_id': 'u_6805b146dce62_VsV3xtRC6XI'}}
2025-04-21 10:56:18,745 - root - WARNING - Skipping order transformation due to missing key fields: {'buyer_info': {'avatar_url': 'http://commonresource-1252524126.cdn.xiaoeknow.com/image/default.svg', 'comment': '', 'nickname': '', 'phone_number': '', 'union_id': ''}, 'good_list': [{'buy_num': 1, 'check_state': 0, 'discounts_info': {'discount_amount_total': 0, 'discount_count': 0, 'discount_detail': []}, 'expire_desc': '长期有效', 'expire_end': '--', 'expire_start': '2025-04-21 10:45:41', 'goods_desc': '', 'goods_image': 'https://wechatapppro-1252524126.cos.ap-shanghai.myqcloud.com/app0vuxiwxw3082_727a0224-418b-467b-a874-87b97eb6ed2f.png', 'goods_name': '[绿色食品]山西黄小米 养胃油糯小米粥五谷杂粮月子米小黄米5斤', 'goods_sn': '--', 'goods_spec_desc': '净含量:2.5kg', 'period_type': 0, 'refund_state': 0, 'refund_state_desc': '--', 'relation_goods_id': '', 'relation_goods_type': 0, 'relation_goods_type_desc': '', 'resource_id': 'g_6736a6768694a_6EwELOsx27', 'resource_type': 21, 'ship_state': 0, 'ship_state_desc': '待发货', 'sku_id': 'SKU_ENT_17316348063VhT7qg6x0', 'sku_spec_code': 'ys-xm-5斤-sxth', 'spu_id': 'SPU_ENT_1731634806BHH8333E65uqn', 'spu_type': 'ENT', 'total_price': 5580, 'unit_price': 5580}], 'order_info': {'activity_type_bitmap': [], 'actual_fee': 5580, 'aftersale_show_state': 0, 'aftersale_show_state_time': '0000-00-00 00:00:00', 'app_id': 'app0vuxiwxw3082', 'channel_bus_id': '', 'channel_type': 0, 'check_state': 0, 'created_time': '2025-04-21 10:45:41', 'deduct_amount': 0, 'discount_amount': 0, 'distribute_type_bitmap': [], 'freight_actual_price': 0, 'freight_original_price': 0, 'goods_buy_num': 1, 'goods_name': '[绿色食品]山西黄小米 养胃油糯小米粥五谷杂粮月子米小黄米5斤', 'goods_original_total_price': 5580, 'goods_spu_sub_type': 'ENT', 'goods_spu_type': 1, 'modified_amount': 0, 'order_close_type': 0, 'order_id': 'E20250421104541a9eimrV2', 'order_state': 2, 'order_state_time': '2025-04-21 10:45:51', 'order_type': 1, 'pay_state': 1, 'pay_state_time': '2025-04-21 10:45:48', 'pay_type': 1, 'refund_fee': 0, 'refund_time': '0000-00-00 00:00:00', 'relation_order_appid': '', 'relation_order_id': '', 'relation_order_type': 0, 'settle_state': 0, 'settle_state_time': '0000-00-00 00:00:00', 'share_type': 0, 'share_user_id': '', 'ship_way_choose_type': 1, 'sub_order_type': 0, 'trade_id': 't_14c57448aae24d519685d7b2f97515ed', 'update_time': '2025-04-21 10:45:51', 'use_collection': 6, 'user_id': 'u_67a5e0553bc50_wZAg0rLiyih', 'wx_app_type': 40}, 'payment_info': {'out_order_id': '3727581076972510208', 'third_order_id': '4310602477202504212901144195'}, 'price_info': {'actual_price': 5580, 'freight_modified_price': 0, 'freight_price': 0, 'origin_price': 5580, 'total_modified_amount': 0, 'total_price': 5580}, 'promoter_info': {'nick_name': '', 'user_id': ''}, 'ship_info': {'city': '大连市', 'company': '', 'confirm_time': '0001-01-01 00:00:00', 'county': '甘井子区', 'detail': '****', 'express_id': '', 'invalid_time': '0001-01-01 00:00:00', 'phone': '180****6517', 'province': '辽宁省', 'receiver': '慧*', 'remark': '', 'ship_time': '0001-01-01 00:00:00', 'user_id': 'u_67a5e0553bc50_wZAg0rLiyih'}}
2025-04-21 10:56:18,746 - root - WARNING - Skipping order transformation due to missing key fields: {'buyer_info': {'avatar_url': 'http://commonresource-1252524126.cdn.xiaoeknow.com/image/default.svg', 'comment': '', 'nickname': '', 'phone_number': '', 'union_id': ''}, 'good_list': [{'buy_num': 2, 'check_state': 0, 'discounts_info': {'discount_amount_total': 0, 'discount_count': 0, 'discount_detail': []}, 'expire_desc': '长期有效', 'expire_end': '--', 'expire_start': '2025-04-21 10:48:06', 'goods_desc': '', 'goods_image': 'https://wechatapppro-1252524126.cos.ap-shanghai.myqcloud.com/app0vuxiwxw3082_727a0224-418b-467b-a874-87b97eb6ed2f.png', 'goods_name': '[绿色食品]山西黄小米 养胃油糯小米粥五谷杂粮月子米小黄米5斤', 'goods_sn': '--', 'goods_spec_desc': '净含量:2.5kg', 'period_type': 0, 'refund_state': 0, 'refund_state_desc': '--', 'relation_goods_id': '', 'relation_goods_type': 0, 'relation_goods_type_desc': '', 'resource_id': 'g_6736a6768694a_6EwELOsx27', 'resource_type': 21, 'ship_state': 0, 'ship_state_desc': '待发货', 'sku_id': 'SKU_ENT_17316348063VhT7qg6x0', 'sku_spec_code': 'ys-xm-5斤-sxth', 'spu_id': 'SPU_ENT_1731634806BHH8333E65uqn', 'spu_type': 'ENT', 'total_price': 11160, 'unit_price': 5580}], 'order_info': {'activity_type_bitmap': [], 'actual_fee': 11160, 'aftersale_show_state': 0, 'aftersale_show_state_time': '0000-00-00 00:00:00', 'app_id': 'app0vuxiwxw3082', 'channel_bus_id': '', 'channel_type': 0, 'check_state': 0, 'created_time': '2025-04-21 10:48:06', 'deduct_amount': 0, 'discount_amount': 0, 'distribute_type_bitmap': [], 'freight_actual_price': 0, 'freight_original_price': 0, 'goods_buy_num': 2, 'goods_name': '[绿色食品]山西黄小米 养胃油糯小米粥五谷杂粮月子米小黄米5斤', 'goods_original_total_price': 11160, 'goods_spu_sub_type': 'ENT', 'goods_spu_type': 1, 'modified_amount': 0, 'order_close_type': 0, 'order_id': 'E20250421104806a04ve9V2', 'order_state': 2, 'order_state_time': '2025-04-21 10:48:17', 'order_type': 1, 'pay_state': 1, 'pay_state_time': '2025-04-21 10:48:14', 'pay_type': 1, 'refund_fee': 0, 'refund_time': '0000-00-00 00:00:00', 'relation_order_appid': '', 'relation_order_id': '', 'relation_order_type': 0, 'settle_state': 0, 'settle_state_time': '0000-00-00 00:00:00', 'share_type': 0, 'share_user_id': '', 'ship_way_choose_type': 1, 'sub_order_type': 0, 'trade_id': 't_31158c208eb04013993de716344d20d1', 'update_time': '2025-04-21 10:48:17', 'use_collection': 6, 'user_id': 'u_67538be7c4db2_WQTpVKYqL8y', 'wx_app_type': 40}, 'payment_info': {'out_order_id': '3727581102386852352', 'third_order_id': ''}, 'price_info': {'actual_price': 11160, 'freight_modified_price': 0, 'freight_price': 0, 'origin_price': 11160, 'total_modified_amount': 0, 'total_price': 11160}, 'promoter_info': {'nick_name': '', 'user_id': ''}, 'ship_info': {'city': '济宁市', 'company': '', 'confirm_time': '0001-01-01 00:00:00', 'county': '微山县', 'detail': '****', 'express_id': '', 'invalid_time': '0001-01-01 00:00:00', 'phone': '158****3419', 'province': '山东省', 'receiver': '张**', 'remark': '', 'ship_time': '0001-01-01 00:00:00', 'user_id': 'u_67538be7c4db2_WQTpVKYqL8y'}}
2025-04-21 10:56:18,748 - root - WARNING - Skipping order transformation due to missing key fields: {'buyer_info': {'avatar_url': 'http://commonresource-1252524126.cdn.xiaoeknow.com/image/default.svg', 'comment': '', 'nickname': '', 'phone_number': '', 'union_id': ''}, 'good_list': [{'buy_num': 1, 'check_state': 0, 'discounts_info': {'discount_amount_total': 0, 'discount_count': 0, 'discount_detail': []}, 'expire_desc': '长期有效', 'expire_end': '--', 'expire_start': '2025-04-21 10:48:58', 'goods_desc': '', 'goods_image': 'https://wechatapppro-1252524126.cos.ap-shanghai.myqcloud.com/app0vuxiwxw3082_727a0224-418b-467b-a874-87b97eb6ed2f.png', 'goods_name': '[绿色食品]山西黄小米 养胃油糯小米粥五谷杂粮月子米小黄米5斤', 'goods_sn': '--', 'goods_spec_desc': '净含量:2.5kg', 'period_type': 0, 'refund_state': 0, 'refund_state_desc': '--', 'relation_goods_id': '', 'relation_goods_type': 0, 'relation_goods_type_desc': '', 'resource_id': 'g_6736a6768694a_6EwELOsx27', 'resource_type': 21, 'ship_state': 0, 'ship_state_desc': '待发货', 'sku_id': 'SKU_ENT_17316348063VhT7qg6x0', 'sku_spec_code': 'ys-xm-5斤-sxth', 'spu_id': 'SPU_ENT_1731634806BHH8333E65uqn', 'spu_type': 'ENT', 'total_price': 5580, 'unit_price': 5580}], 'order_info': {'activity_type_bitmap': [], 'actual_fee': 5580, 'aftersale_show_state': 0, 'aftersale_show_state_time': '0000-00-00 00:00:00', 'app_id': 'app0vuxiwxw3082', 'channel_bus_id': '', 'channel_type': 0, 'check_state': 0, 'created_time': '2025-04-21 10:48:58', 'deduct_amount': 0, 'discount_amount': 0, 'distribute_type_bitmap': [], 'freight_actual_price': 0, 'freight_original_price': 0, 'goods_buy_num': 1, 'goods_name': '[绿色食品]山西黄小米 养胃油糯小米粥五谷杂粮月子米小黄米5斤', 'goods_original_total_price': 5580, 'goods_spu_sub_type': 'ENT', 'goods_spu_type': 1, 'modified_amount': 0, 'order_close_type': 0, 'order_id': 'E20250421104858a040p7V2', 'order_state': 2, 'order_state_time': '2025-04-21 10:49:08', 'order_type': 1, 'pay_state': 1, 'pay_state_time': '2025-04-21 10:49:04', 'pay_type': 1, 'refund_fee': 0, 'refund_time': '0000-00-00 00:00:00', 'relation_order_appid': '', 'relation_order_id': '', 'relation_order_type': 0, 'settle_state': 0, 'settle_state_time': '0000-00-00 00:00:00', 'share_type': 0, 'share_user_id': '', 'ship_way_choose_type': 1, 'sub_order_type': 0, 'trade_id': 't_ae3f92432dab4a8e8b5452c59b79821c', 'update_time': '2025-04-21 10:49:08', 'use_collection': 6, 'user_id': 'u_6805b21a0bc83_SDLygLBbVzg', 'wx_app_type': 40}, 'payment_info': {'out_order_id': '3727581126027254272', 'third_order_id': '4304302280202504215004074018'}, 'price_info': {'actual_price': 5580, 'freight_modified_price': 0, 'freight_price': 0, 'origin_price': 5580, 'total_modified_amount': 0, 'total_price': 5580}, 'promoter_info': {'nick_name': '', 'user_id': ''}, 'ship_info': {'city': '邵阳市', 'company': '', 'confirm_time': '0001-01-01 00:00:00', 'county': '新宁县', 'detail': '****', 'express_id': '', 'invalid_time': '0001-01-01 00:00:00', 'phone': '152****9830', 'province': '湖南省', 'receiver': '朱**', 'remark': '', 'ship_time': '0001-01-01 00:00:00', 'user_id': 'u_6805b21a0bc83_SDLygLBbVzg'}}
2025-04-21 10:56:18,751 - root - INFO - Fetched less orders than page size, assuming last page.
2025-04-21 10:56:18,751 - root - INFO - No new valid orders to upsert.
2025-04-21 10:56:18,751 - root - INFO - No new valid order items to upsert.
2025-04-21 10:56:18,751 - root - INFO - Xiaoe incremental order sync completed successfully.
2025-04-21 10:56:18,757 - root - INFO - Sync status updated for xiaoe/order/incremental: success
2025-04-21 10:56:18,757 - root - INFO - Database session closed for incremental sync.
2025-04-21 10:56:18,757 - root - INFO - Sync process finished for type: incremental
2025-04-21 11:05:13,756 - root - INFO - Logger initialized with level: INFO. Logging to console and file: D:\cursor开发工程\BI\logs\app.log
2025-04-21 11:05:13,757 - root - INFO - Starting sync process with type: incremental
2025-04-21 11:05:13,757 - root - INFO - Starting Xiaoe incremental order sync...
2025-04-21 11:05:13,765 - root - INFO - Retrieved last sync timestamp for xiaoe/order/incremental: 2025-04-21T02:56:17+00:00
2025-04-21 11:05:13,765 - root - INFO - XiaoeClient initialized.
2025-04-21 11:05:13,765 - root - INFO - Fetching page 1 of PAID orders (state=2, size=50) from 2025-04-21 02:56:18 to 2025-04-21 03:05:13
2025-04-21 11:05:13,765 - root - INFO - Fetching orders: page=1, size=50, start=2025-04-21 02:56:18, end=2025-04-21 03:05:13, state=2
2025-04-21 11:05:13,765 - root - INFO - Attempting to get new Xiaoe access token...
2025-04-21 11:05:14,333 - root - INFO - Successfully obtained Xiaoe access token. Expires around: 2025-04-21 13:05:14
2025-04-21 11:05:15,161 - root - INFO - Fetched 20 orders on page 1. Total fetched so far: 20
2025-04-21 11:05:15,166 - root - INFO - Fetched less orders than page size, assuming last page.
2025-04-21 11:05:15,166 - root - INFO - Upserting 20 transformed orders...
2025-04-21 11:05:15,166 - root - INFO - Starting upsert for 20 records into orders...
2025-04-21 11:05:15,166 - root - INFO - Processing 20 valid data items for orders.
2025-04-21 11:05:15,168 - root - INFO - UPSERT statement executed for orders. Approx affected rows: 20
2025-04-21 11:05:15,176 - root - INFO - Successfully upserted data into orders. Processed 20 items. Transaction committed.
2025-04-21 11:05:15,177 - root - INFO - Upserting 21 transformed order items...
2025-04-21 11:05:15,177 - root - INFO - Starting upsert for 21 records into order_items...
2025-04-21 11:05:15,177 - root - INFO - Processing 21 valid data items for order_items.
2025-04-21 11:05:15,179 - root - INFO - UPSERT statement executed for order_items. Approx affected rows: 21
2025-04-21 11:05:15,183 - root - INFO - Successfully upserted data into order_items. Processed 21 items. Transaction committed.
2025-04-21 11:05:15,183 - root - INFO - Xiaoe incremental order sync completed successfully.
2025-04-21 11:05:15,192 - root - INFO - Sync status updated for xiaoe/order/incremental: success
2025-04-21 11:05:15,192 - root - INFO - Database session closed for incremental sync.
2025-04-21 11:05:15,193 - root - INFO - Sync process finished for type: incremental
2025-04-21 11:06:28,449 - root - INFO - Logger initialized with level: INFO. Logging to console and file: D:\cursor开发工程\BI\logs\app.log
2025-04-21 11:06:28,449 - root - INFO - Starting sync process with type: status_update
2025-04-21 11:06:28,451 - root - INFO - Starting Xiaoe order status update sync...
2025-04-21 11:06:28,451 - root - INFO - Checking order status updates created from 2025-04-06 03:06:28 to 2025-04-21 03:06:28
2025-04-21 11:06:28,451 - root - INFO - XiaoeClient initialized.
2025-04-21 11:06:28,451 - root - INFO - Fetching page 1 of recent orders (size=50) for status update...
2025-04-21 11:06:28,451 - root - INFO - Fetching orders: page=1, size=50, start=2025-04-06 03:06:28, end=2025-04-21 03:06:28, state=None
2025-04-21 11:06:28,451 - root - INFO - Attempting to get new Xiaoe access token...
2025-04-21 11:06:28,963 - root - INFO - Successfully obtained Xiaoe access token. Expires around: 2025-04-21 13:06:28
2025-04-21 11:06:29,615 - root - INFO - Fetched 50 recent orders on page 1. Total fetched: 50
2025-04-21 11:06:30,118 - root - INFO - Fetching page 2 of recent orders (size=50) for status update...
2025-04-21 11:06:30,118 - root - INFO - Fetching orders: page=2, size=50, start=2025-04-06 03:06:28, end=2025-04-21 03:06:28, state=None
2025-04-21 11:06:30,751 - root - INFO - Fetched 50 recent orders on page 2. Total fetched: 100
2025-04-21 11:06:31,252 - root - INFO - Fetching page 3 of recent orders (size=50) for status update...
2025-04-21 11:06:31,252 - root - INFO - Fetching orders: page=3, size=50, start=2025-04-06 03:06:28, end=2025-04-21 03:06:28, state=None
2025-04-21 11:06:31,927 - root - INFO - Fetched 50 recent orders on page 3. Total fetched: 150
2025-04-21 11:06:32,429 - root - INFO - Fetching page 4 of recent orders (size=50) for status update...
2025-04-21 11:06:32,429 - root - INFO - Fetching orders: page=4, size=50, start=2025-04-06 03:06:28, end=2025-04-21 03:06:28, state=None
2025-04-21 11:06:33,092 - root - INFO - Fetched 50 recent orders on page 4. Total fetched: 200
2025-04-21 11:06:33,594 - root - INFO - Fetching page 5 of recent orders (size=50) for status update...
2025-04-21 11:06:33,594 - root - INFO - Fetching orders: page=5, size=50, start=2025-04-06 03:06:28, end=2025-04-21 03:06:28, state=None
2025-04-21 11:06:34,265 - root - INFO - Fetched 50 recent orders on page 5. Total fetched: 250
2025-04-21 11:06:34,767 - root - INFO - Fetching page 6 of recent orders (size=50) for status update...
2025-04-21 11:06:34,767 - root - INFO - Fetching orders: page=6, size=50, start=2025-04-06 03:06:28, end=2025-04-21 03:06:28, state=None
2025-04-21 11:06:35,405 - root - INFO - Fetched 50 recent orders on page 6. Total fetched: 300
2025-04-21 11:06:35,906 - root - INFO - Fetching page 7 of recent orders (size=50) for status update...
2025-04-21 11:06:35,906 - root - INFO - Fetching orders: page=7, size=50, start=2025-04-06 03:06:28, end=2025-04-21 03:06:28, state=None
2025-04-21 11:06:36,637 - root - INFO - Fetched 50 recent orders on page 7. Total fetched: 350
2025-04-21 11:06:37,139 - root - INFO - Fetching page 8 of recent orders (size=50) for status update...
2025-04-21 11:06:37,139 - root - INFO - Fetching orders: page=8, size=50, start=2025-04-06 03:06:28, end=2025-04-21 03:06:28, state=None
2025-04-21 11:06:37,788 - root - INFO - Fetched 50 recent orders on page 8. Total fetched: 400
2025-04-21 11:06:38,290 - root - INFO - Fetching page 9 of recent orders (size=50) for status update...
2025-04-21 11:06:38,290 - root - INFO - Fetching orders: page=9, size=50, start=2025-04-06 03:06:28, end=2025-04-21 03:06:28, state=None
2025-04-21 11:06:38,898 - root - INFO - Fetched 50 recent orders on page 9. Total fetched: 450
2025-04-21 11:06:39,399 - root - INFO - Fetching page 10 of recent orders (size=50) for status update...
2025-04-21 11:06:39,399 - root - INFO - Fetching orders: page=10, size=50, start=2025-04-06 03:06:28, end=2025-04-21 03:06:28, state=None
2025-04-21 11:06:40,032 - root - INFO - Fetched 50 recent orders on page 10. Total fetched: 500
2025-04-21 11:06:40,534 - root - INFO - Fetching page 11 of recent orders (size=50) for status update...
2025-04-21 11:06:40,535 - root - INFO - Fetching orders: page=11, size=50, start=2025-04-06 03:06:28, end=2025-04-21 03:06:28, state=None
2025-04-21 11:06:41,146 - root - INFO - Fetched 50 recent orders on page 11. Total fetched: 550
2025-04-21 11:06:41,648 - root - INFO - Fetching page 12 of recent orders (size=50) for status update...
2025-04-21 11:06:41,648 - root - INFO - Fetching orders: page=12, size=50, start=2025-04-06 03:06:28, end=2025-04-21 03:06:28, state=None
2025-04-21 11:06:42,250 - root - INFO - Fetched 50 recent orders on page 12. Total fetched: 600
2025-04-21 11:06:42,752 - root - INFO - Fetching page 13 of recent orders (size=50) for status update...
2025-04-21 11:06:42,752 - root - INFO - Fetching orders: page=13, size=50, start=2025-04-06 03:06:28, end=2025-04-21 03:06:28, state=None
2025-04-21 11:06:43,446 - root - INFO - Fetched 50 recent orders on page 13. Total fetched: 650
2025-04-21 11:06:43,947 - root - INFO - Fetching page 14 of recent orders (size=50) for status update...
2025-04-21 11:06:43,947 - root - INFO - Fetching orders: page=14, size=50, start=2025-04-06 03:06:28, end=2025-04-21 03:06:28, state=None
2025-04-21 11:06:44,636 - root - INFO - Fetched 50 recent orders on page 14. Total fetched: 700
2025-04-21 11:06:45,138 - root - INFO - Fetching page 15 of recent orders (size=50) for status update...
2025-04-21 11:06:45,138 - root - INFO - Fetching orders: page=15, size=50, start=2025-04-06 03:06:28, end=2025-04-21 03:06:28, state=None
2025-04-21 11:06:45,819 - root - INFO - Fetched 50 recent orders on page 15. Total fetched: 750
2025-04-21 11:06:46,321 - root - INFO - Fetching page 16 of recent orders (size=50) for status update...
2025-04-21 11:06:46,321 - root - INFO - Fetching orders: page=16, size=50, start=2025-04-06 03:06:28, end=2025-04-21 03:06:28, state=None
2025-04-21 11:06:46,996 - root - INFO - Fetched 50 recent orders on page 16. Total fetched: 800
2025-04-21 11:06:47,497 - root - INFO - Fetching page 17 of recent orders (size=50) for status update...
2025-04-21 11:06:47,497 - root - INFO - Fetching orders: page=17, size=50, start=2025-04-06 03:06:28, end=2025-04-21 03:06:28, state=None
2025-04-21 11:06:48,127 - root - INFO - Fetched 50 recent orders on page 17. Total fetched: 850
2025-04-21 11:06:48,628 - root - INFO - Fetching page 18 of recent orders (size=50) for status update...
2025-04-21 11:06:48,628 - root - INFO - Fetching orders: page=18, size=50, start=2025-04-06 03:06:28, end=2025-04-21 03:06:28, state=None
2025-04-21 11:06:49,284 - root - INFO - Fetched 50 recent orders on page 18. Total fetched: 900
2025-04-21 11:06:49,786 - root - INFO - Fetching page 19 of recent orders (size=50) for status update...
2025-04-21 11:06:49,786 - root - INFO - Fetching orders: page=19, size=50, start=2025-04-06 03:06:28, end=2025-04-21 03:06:28, state=None
2025-04-21 11:06:50,461 - root - INFO - Fetched 50 recent orders on page 19. Total fetched: 950
2025-04-21 11:06:50,963 - root - INFO - Fetching page 20 of recent orders (size=50) for status update...
2025-04-21 11:06:50,963 - root - INFO - Fetching orders: page=20, size=50, start=2025-04-06 03:06:28, end=2025-04-21 03:06:28, state=None
2025-04-21 11:06:51,625 - root - INFO - Fetched 50 recent orders on page 20. Total fetched: 1000
2025-04-21 11:06:52,126 - root - INFO - Fetching page 21 of recent orders (size=50) for status update...
2025-04-21 11:06:52,127 - root - INFO - Fetching orders: page=21, size=50, start=2025-04-06 03:06:28, end=2025-04-21 03:06:28, state=None
2025-04-21 11:06:52,764 - root - INFO - Fetched 50 recent orders on page 21. Total fetched: 1050
2025-04-21 11:06:53,265 - root - INFO - Fetching page 22 of recent orders (size=50) for status update...
2025-04-21 11:06:53,265 - root - INFO - Fetching orders: page=22, size=50, start=2025-04-06 03:06:28, end=2025-04-21 03:06:28, state=None
2025-04-21 11:06:53,893 - root - INFO - Fetched 50 recent orders on page 22. Total fetched: 1100
2025-04-21 11:06:54,395 - root - INFO - Fetching page 23 of recent orders (size=50) for status update...
2025-04-21 11:06:54,395 - root - INFO - Fetching orders: page=23, size=50, start=2025-04-06 03:06:28, end=2025-04-21 03:06:28, state=None
2025-04-21 11:06:55,064 - root - INFO - Fetched 50 recent orders on page 23. Total fetched: 1150
2025-04-21 11:06:55,565 - root - INFO - Fetching page 24 of recent orders (size=50) for status update...
2025-04-21 11:06:55,565 - root - INFO - Fetching orders: page=24, size=50, start=2025-04-06 03:06:28, end=2025-04-21 03:06:28, state=None
2025-04-21 11:06:56,170 - root - INFO - Fetched 50 recent orders on page 24. Total fetched: 1200
2025-04-21 11:06:56,672 - root - INFO - Fetching page 25 of recent orders (size=50) for status update...
2025-04-21 11:06:56,672 - root - INFO - Fetching orders: page=25, size=50, start=2025-04-06 03:06:28, end=2025-04-21 03:06:28, state=None
2025-04-21 11:06:57,374 - root - INFO - Fetched 50 recent orders on page 25. Total fetched: 1250
2025-04-21 11:06:57,875 - root - INFO - Fetching page 26 of recent orders (size=50) for status update...
2025-04-21 11:06:57,875 - root - INFO - Fetching orders: page=26, size=50, start=2025-04-06 03:06:28, end=2025-04-21 03:06:28, state=None
2025-04-21 11:06:58,569 - root - INFO - Fetched 50 recent orders on page 26. Total fetched: 1300
2025-04-21 11:06:59,070 - root - INFO - Fetching page 27 of recent orders (size=50) for status update...
2025-04-21 11:06:59,070 - root - INFO - Fetching orders: page=27, size=50, start=2025-04-06 03:06:28, end=2025-04-21 03:06:28, state=None
2025-04-21 11:06:59,736 - root - INFO - Fetched 50 recent orders on page 27. Total fetched: 1350
2025-04-21 11:07:00,237 - root - INFO - Fetching page 28 of recent orders (size=50) for status update...
2025-04-21 11:07:00,237 - root - INFO - Fetching orders: page=28, size=50, start=2025-04-06 03:06:28, end=2025-04-21 03:06:28, state=None
2025-04-21 11:07:00,849 - root - INFO - Fetched 50 recent orders on page 28. Total fetched: 1400
2025-04-21 11:07:01,351 - root - INFO - Fetching page 29 of recent orders (size=50) for status update...
2025-04-21 11:07:01,351 - root - INFO - Fetching orders: page=29, size=50, start=2025-04-06 03:06:28, end=2025-04-21 03:06:28, state=None
2025-04-21 11:07:02,013 - root - INFO - Fetched 50 recent orders on page 29. Total fetched: 1450
2025-04-21 11:07:02,515 - root - INFO - Fetching page 30 of recent orders (size=50) for status update...
2025-04-21 11:07:02,515 - root - INFO - Fetching orders: page=30, size=50, start=2025-04-06 03:06:28, end=2025-04-21 03:06:28, state=None
2025-04-21 11:07:03,162 - root - INFO - Fetched 50 recent orders on page 30. Total fetched: 1500
2025-04-21 11:07:03,663 - root - INFO - Fetching page 31 of recent orders (size=50) for status update...
2025-04-21 11:07:03,664 - root - INFO - Fetching orders: page=31, size=50, start=2025-04-06 03:06:28, end=2025-04-21 03:06:28, state=None
2025-04-21 11:07:04,358 - root - INFO - Fetched 50 recent orders on page 31. Total fetched: 1550
2025-04-21 11:07:04,859 - root - INFO - Fetching page 32 of recent orders (size=50) for status update...
2025-04-21 11:07:04,859 - root - INFO - Fetching orders: page=32, size=50, start=2025-04-06 03:06:28, end=2025-04-21 03:06:28, state=None
2025-04-21 11:07:05,487 - root - INFO - Fetched 50 recent orders on page 32. Total fetched: 1600
2025-04-21 11:07:05,989 - root - INFO - Fetching page 33 of recent orders (size=50) for status update...
2025-04-21 11:07:05,989 - root - INFO - Fetching orders: page=33, size=50, start=2025-04-06 03:06:28, end=2025-04-21 03:06:28, state=None
2025-04-21 11:07:06,615 - root - INFO - Fetched 50 recent orders on page 33. Total fetched: 1650
2025-04-21 11:07:07,116 - root - INFO - Fetching page 34 of recent orders (size=50) for status update...
2025-04-21 11:07:07,116 - root - INFO - Fetching orders: page=34, size=50, start=2025-04-06 03:06:28, end=2025-04-21 03:06:28, state=None
2025-04-21 11:07:07,784 - root - INFO - Fetched 50 recent orders on page 34. Total fetched: 1700
2025-04-21 11:07:08,285 - root - INFO - Fetching page 35 of recent orders (size=50) for status update...
2025-04-21 11:07:08,285 - root - INFO - Fetching orders: page=35, size=50, start=2025-04-06 03:06:28, end=2025-04-21 03:06:28, state=None
2025-04-21 11:07:08,929 - root - INFO - Fetched 50 recent orders on page 35. Total fetched: 1750
2025-04-21 11:07:09,430 - root - INFO - Fetching page 36 of recent orders (size=50) for status update...
2025-04-21 11:07:09,430 - root - INFO - Fetching orders: page=36, size=50, start=2025-04-06 03:06:28, end=2025-04-21 03:06:28, state=None
2025-04-21 11:07:10,070 - root - INFO - Fetched 50 recent orders on page 36. Total fetched: 1800
2025-04-21 11:07:10,571 - root - INFO - Fetching page 37 of recent orders (size=50) for status update...
2025-04-21 11:07:10,571 - root - INFO - Fetching orders: page=37, size=50, start=2025-04-06 03:06:28, end=2025-04-21 03:06:28, state=None
2025-04-21 11:07:11,217 - root - INFO - Fetched 50 recent orders on page 37. Total fetched: 1850
2025-04-21 11:07:11,719 - root - INFO - Fetching page 38 of recent orders (size=50) for status update...
2025-04-21 11:07:11,719 - root - INFO - Fetching orders: page=38, size=50, start=2025-04-06 03:06:28, end=2025-04-21 03:06:28, state=None
2025-04-21 11:07:12,370 - root - INFO - Fetched 50 recent orders on page 38. Total fetched: 1900
2025-04-21 11:07:12,871 - root - INFO - Fetching page 39 of recent orders (size=50) for status update...
2025-04-21 11:07:12,871 - root - INFO - Fetching orders: page=39, size=50, start=2025-04-06 03:06:28, end=2025-04-21 03:06:28, state=None
2025-04-21 11:07:13,552 - root - INFO - Fetched 50 recent orders on page 39. Total fetched: 1950
2025-04-21 11:07:14,054 - root - INFO - Fetching page 40 of recent orders (size=50) for status update...
2025-04-21 11:07:14,054 - root - INFO - Fetching orders: page=40, size=50, start=2025-04-06 03:06:28, end=2025-04-21 03:06:28, state=None
2025-04-21 11:07:14,745 - root - INFO - Fetched 50 recent orders on page 40. Total fetched: 2000
2025-04-21 11:07:15,247 - root - INFO - Fetching page 41 of recent orders (size=50) for status update...
2025-04-21 11:07:15,247 - root - INFO - Fetching orders: page=41, size=50, start=2025-04-06 03:06:28, end=2025-04-21 03:06:28, state=None
2025-04-21 11:07:15,902 - root - INFO - Fetched 50 recent orders on page 41. Total fetched: 2050
2025-04-21 11:07:16,404 - root - INFO - Fetching page 42 of recent orders (size=50) for status update...
2025-04-21 11:07:16,404 - root - INFO - Fetching orders: page=42, size=50, start=2025-04-06 03:06:28, end=2025-04-21 03:06:28, state=None
2025-04-21 11:07:17,076 - root - INFO - Fetched 50 recent orders on page 42. Total fetched: 2100
2025-04-21 11:07:17,577 - root - INFO - Fetching page 43 of recent orders (size=50) for status update...
2025-04-21 11:07:17,577 - root - INFO - Fetching orders: page=43, size=50, start=2025-04-06 03:06:28, end=2025-04-21 03:06:28, state=None
2025-04-21 11:07:18,244 - root - INFO - Fetched 50 recent orders on page 43. Total fetched: 2150
2025-04-21 11:07:18,745 - root - INFO - Fetching page 44 of recent orders (size=50) for status update...
2025-04-21 11:07:18,745 - root - INFO - Fetching orders: page=44, size=50, start=2025-04-06 03:06:28, end=2025-04-21 03:06:28, state=None
2025-04-21 11:07:19,465 - root - INFO - Fetched 50 recent orders on page 44. Total fetched: 2200
2025-04-21 11:07:19,966 - root - INFO - Fetching page 45 of recent orders (size=50) for status update...
2025-04-21 11:07:19,966 - root - INFO - Fetching orders: page=45, size=50, start=2025-04-06 03:06:28, end=2025-04-21 03:06:28, state=None
2025-04-21 11:07:20,645 - root - INFO - Fetched 49 recent orders on page 45. Total fetched: 2249
2025-04-21 11:07:20,647 - root - INFO - Fetched less orders than page size, assuming last page for status update.
2025-04-21 11:07:20,647 - root - INFO - Upserting 2249 orders for status update...
2025-04-21 11:07:20,647 - root - INFO - Starting upsert for 2249 records into orders...
2025-04-21 11:07:20,650 - root - INFO - Processing 2249 valid data items for orders.
2025-04-21 11:07:20,964 - root - INFO - UPSERT statement executed for orders. Approx affected rows: 2269
2025-04-21 11:07:20,973 - root - INFO - Successfully upserted data into orders. Processed 2249 items. Transaction committed.
2025-04-21 11:07:20,975 - root - INFO - Xiaoe order status update sync completed successfully.
2025-04-21 11:07:20,985 - root - INFO - Sync status updated for xiaoe/order/status_update: success
2025-04-21 11:07:20,985 - root - INFO - Database session closed for status update sync.
2025-04-21 11:07:20,986 - root - INFO - Sync process finished for type: status_update
